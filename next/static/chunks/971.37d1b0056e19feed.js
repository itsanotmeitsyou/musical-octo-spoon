(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[971,939,1274],{57118:function(e,n,t){"use strict";var r=t(95318),a=t(20862);n.Z=void 0;var i=a(t(67294)),s=(0,r(t(2108)).default)(i.createElement("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"}),"Fullscreen");n.Z=s},96977:function(e,n,t){"use strict";var r=t(95318),a=t(20862);n.Z=void 0;var i=a(t(67294)),s=(0,r(t(2108)).default)(i.createElement("path",{d:"M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"}),"FullscreenExit");n.Z=s},34044:function(e,n,t){"use strict";var r=t(95318),a=t(20862);n.Z=void 0;var i=a(t(67294)),s=(0,r(t(2108)).default)(i.createElement(i.Fragment,null,i.createElement("circle",{cx:"9",cy:"9",r:"4"}),i.createElement("path",{d:"M9 15c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4zm7.76-9.64l-1.68 1.69c.84 1.18.84 2.71 0 3.89l1.68 1.69c2.02-2.02 2.02-5.07 0-7.27zM20.07 2l-1.63 1.63c2.77 3.02 2.77 7.56 0 10.74L20.07 16c3.9-3.89 3.91-9.95 0-14z"})),"RecordVoiceOver");n.Z=s},43910:function(e,n,t){"use strict";var r=t(95318),a=t(20862);n.Z=void 0;var i=a(t(67294)),s=(0,r(t(2108)).default)(i.createElement("path",{d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"}),"Send");n.Z=s},9969:function(e,n,t){"use strict";var r=t(95318),a=t(20862);n.Z=void 0;var i=a(t(67294)),s=(0,r(t(2108)).default)(i.createElement("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"}),"Settings");n.Z=s},8884:function(e,n,t){"use strict";var r=t(95318),a=t(20862);n.Z=void 0;var i=a(t(67294)),s=(0,r(t(2108)).default)(i.createElement("path",{d:"M12.99 9.18c0-.06.01-.12.01-.18 0-2.21-1.79-4-4-4-.06 0-.12.01-.18.01l4.17 4.17zm-6.1-3.56L4.27 3 3 4.27l2.62 2.62C5.23 7.5 5 8.22 5 9c0 2.21 1.79 4 4 4 .78 0 1.5-.23 2.11-.62L19.73 21 21 19.73l-8.62-8.62-5.49-5.49zM9 15c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4zm7.76-9.64l-1.68 1.69c.84 1.18.84 2.71 0 3.89l1.68 1.69c2.02-2.02 2.02-5.07 0-7.27zM20.07 2l-1.63 1.63c2.77 3.02 2.77 7.56 0 10.74L20.07 16c3.9-3.89 3.91-9.95 0-14z"}),"VoiceOverOff");n.Z=s},51549:function(e,n,t){"use strict";t.d(n,{AQ:function(){return s},BH:function(){return v},Cp:function(){return l},Fk:function(){return p},Rc:function(){return u},Rd:function(){return _},VX:function(){return g},W2:function(){return i},X2:function(){return y},ed:function(){return f},hp:function(){return S},kf:function(){return d},lO:function(){return h},lp:function(){return x},nW:function(){return j},rz:function(){return C},sK:function(){return o},tY:function(){return c},uR:function(){return b},vO:function(){return w},w5:function(){return m}});var r=t(14924),a=t(46182),i=function(e){var n=e.inviteId;(0,a.Bu)("Invite Opened",{inviteId:n})},s=function(e){var n=e.inviteId;(0,a.Bu)("Invite Claimed",{inviteId:n})},o=function(){(0,a.Bu)("Signed Up for Beta")},c=function(){(0,a.Bu)("Visited home page")};var u=function(e){var n=e.canInviteToEdit;(0,a.Bu)("Opened share dialog",{"can invite to edit":n})},l=function(e){var n=e.editor;(0,a.Bu)("Invited collaborator",{"Can edit":n})},d=function(e){var n=e.spaceSlug,t=e.spaceId;(0,a.Bu)("Viewed space collaborator invite dialog",{spaceId:t,spaceSlug:n})},f=function(e){var n=e.spaceSlug,t=e.spaceId;(0,a.Bu)("Claimed space collaborator invite",{spaceId:t,spaceSlug:n})},p=function(e){var n=e.shareAtLocation;(0,a.Bu)("Copied share link to clipboard",(0,r.Z)({},"at current location",n))},m=function(){(0,a.Bu)("Chose to share at location")},h=function(e){var n=e.eventName,t=e.eventSlug,r=e.spaceSlug,i=e.spaceId;(0,a.Bu)("Opened Event",{eventSlug:t,eventName:n,spaceSlug:r,spaceId:i})},v=function(e){var n=e.eventSlug,t=e.eventName,r=e.optInAriumUpdates,i=e.eventReminder;(0,a.Bu)("Submitted Email",{eventSlug:n,eventName:t,optInAriumUpdates:r,eventReminder:i})},x=function(){(0,a.Bu)("Registered account")},g=function(e){var n=e.eventSlug,t=e.eventName,r=e.spaceSlug,i=e.spaceId;(0,a.Bu)("Clicked to join space",{eventSlug:n,eventName:t,spaceSlug:r,spaceId:i})},b="Opened Space Creation Page";function _(){(0,a.Bu)("Beta Signup Modal Opened")}function j(e){var n=e.byCurrentUser;(0,a.Bu)("Invite already used",{"by current user":n})}function y(){(0,a.Bu)("Landed on space selection page.")}function S(e){var n=e.selectedSpaceTemplate;(0,a.Bu)("Selected Space",{spaceId:n})}function w(e){var n=e.spaceSlug,t=e.spaceId;(0,a.Bu)("Previewed Space",{spaceId:t,spaceSlug:n})}function C(e){var n=e.selectedSpaceTemplate,t=e.spaceName;(0,a.Bu)("Space Created",{spaceId:n,newSpaceId:t})}},46182:function(e,n,t){"use strict";t.d(n,{Bu:function(){return d},IU:function(){return u},aN:function(){return f},hO:function(){return p},lR:function(){return m},rU:function(){return l}});var r=t(8891),a=t(67294),i=t(51549),s="true"===t(34155).env.NEXT_PUBLIC_ENABLE_MIXPANEL||!0,o=!1,c=s&&!o;function u(e){var n=e.userId,t=e.isAnonymous,i=e.isNewUser;(0,a.useEffect)((function(){c&&r.init("f133b13de19ae43071245d6ad1f15480")}),[]),(0,a.useEffect)((function(){t||!c||i||n&&r.identify(n)}),[n,t,i])}function l(e){c&&(r.identify(e),r.alias(e),(0,i.lp)())}window.addEventListener("CookieScriptReject",(function(){o=!0}));var d=function(e,n){if(c)try{r.track(e,n)}catch(t){console.error(t)}},f=function(e,n){(0,a.useEffect)((function(){d(e,n)}),[e,n])},p=function(e){if(c)try{r.register(e)}catch(n){console.error(n)}},m=function(e,n){if(c)try{r.track_links(e,n)}catch(t){console.error(t)}}},65340:function(e,n,t){"use strict";t.d(n,{R:function(){return f},v:function(){return d}});var r=t(85893),a=t(67294),i=t(51442),s=t(42422),o=t(39240),c=t(89445),u=t(75515),l=t(22318),d=function(e){var n=e.type,t=e.id;return(0,r.jsx)(u.zw,{height:"100vh",children:(0,r.jsxs)("div",{children:[(0,r.jsx)(l.Z,{variant:"h1",align:"center",children:"404"}),(0,r.jsxs)(l.Z,{align:"center",children:[n," ",t?t+" ":""," does not exist"]})]})})},f=function(e){var n=e.type,t=e.id;(0,a.useEffect)((function(){(0,i.e)({Text:o.xv})}),[]);var u=(0,a.useState)([0,0,0]),l=u[0],d=u[1];return(0,r.jsxs)(s.Xz,{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%"},dpr:window.devicePixelRatio,onMouseMove:function(e){d([(e.clientY/e.target.offsetHeight-.5)*-Math.PI/8,(e.clientX/e.target.offsetWidth-.5)*-Math.PI/8,0])},children:[(0,r.jsxs)("group",{"position-z":-180,rotation:l,children:[(0,r.jsx)("text",{text:"404",fontSize:64,anchorX:"center",anchorY:"bottom",children:(0,r.jsx)("meshPhongMaterial",{attach:"material",color:c.Cl})}),(0,r.jsx)("text",{text:"".concat(n," ").concat(t?t+" ":"","does not exist"),fontSize:12,anchorX:"center",anchorY:"top",children:(0,r.jsx)("meshPhongMaterial",{attach:"material",color:c.Cl})})]}),(0,r.jsx)("pointLight",{position:[-100,0,-160]}),(0,r.jsx)("pointLight",{position:[0,0,-170]}),(0,r.jsx)("pointLight",{position:[100,0,-160]})]})}},78523:function(e,n,t){"use strict";var r,a=t(85893),i=t(67294),s=t(32089),o=t(41749),c=t(32692),u=t(95477),l=t(53450),d=t(5566),f=t(73637),p=t(282),m=t(10041),h=t(39803),v=t(29674),x=t(31818),g=t(98291),b=t(76749),_=t.n(b),j=t(78295),y=t.n(j),S=t(86010),w=t(14788),C=t(51549),I=["Something went wrong.","Please try again."],k=function(e){var n=e.iconSrc,t=e.placeholder,r=e.onChange,i=e.autofocus,s=e.error;return(0,a.jsxs)(o.Z,{container:!0,spacing:2,children:[(0,a.jsx)(o.Z,{item:!0,xs:2,sm:1,children:(0,a.jsx)("img",{alt:"icon",src:n})}),(0,a.jsx)(o.Z,{item:!0,xs:10,children:(0,a.jsx)(h.Z,{error:null!==s,helperText:s,className:(0,S.default)(_().textField),required:!0,fullWidth:!0,autoFocus:i,placeholder:t,InputProps:{className:_().inputLabel},onChange:r})})]})};!function(e){e[e.pending=0]="pending",e[e.submitting=1]="submitting",e[e.success=2]="success",e[e.error=3]="error"}(r||(r={}));var Z=function(e){var n=e.name,t=e.email,s=(0,x.JL)({ensureSignedInAnonymously:!1}).authenticated,o=(0,i.useState)(r.pending),l=o[0],d=o[1];return(0,i.useEffect)((function(){s&&(0,v.Ob)().add({name:n,emailAddress:t,signUpTime:(0,w.Qk)()}).then((function(){return setTimeout((function(){return d(r.success)}),300)})).catch((function(e){(0,g.vU)("Error when sending beta sign up info to db",e),setTimeout((function(){return d(r.error)}),300)}))}),[s,t,n]),(0,a.jsxs)(a.Fragment,{children:[l===r.pending&&(0,a.jsx)(c.Z,{open:!l,children:(0,a.jsx)(u.Z,{color:"inherit"})}),l===r.success&&["Thank you!","We'll get back to you soon."].map((function(e,n){return(0,a.jsx)("h2",{children:e},n)})),l===r.error&&I.map((function(e,n){return(0,a.jsx)("h1",{children:e},n)}))]})},P=function(e){return s.Z_().min(1).isValidSync(e)?null:"Please enter your name"},T=function(e){return s.Z_().min(1).email().isValidSync(e)?null:"Invalid email"},N=function(){var e=(0,i.useState)(!1),n=e[0],t=e[1],r=(0,i.useState)(""),s=r[0],c=r[1],u=(0,i.useState)(null),d=u[0],f=u[1],p=(0,i.useState)(""),m=p[0],h=p[1],v=(0,i.useState)(null),x=v[0],g=v[1],b=(0,i.useCallback)((function(){var e=[P(s),T(m)],n=e[0],r=e[1];g(r),f(n),r||n||((0,C.sK)(),t(!0))}),[s,m]),_=(0,i.useCallback)((function(e){return c(e.target.value)}),[]),j=(0,i.useCallback)((function(e){return h(e.target.value)}),[]);return n?(0,a.jsx)(Z,{name:s,email:m}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:"Want your own space on Arium?"}),(0,a.jsx)("h1",{children:"Sign up for our Beta"}),(0,a.jsx)("br",{}),(0,a.jsx)(k,{error:d,autofocus:!0,iconSrc:"/images/icons/name-tag-icon.svg",placeholder:"Your Name",onChange:_}),(0,a.jsx)("br",{}),(0,a.jsx)(k,{error:x,iconSrc:"/images/icons/email-round-icon.svg",placeholder:"Your Email",onChange:j}),(0,a.jsx)("br",{}),(0,a.jsxs)(o.Z,{container:!0,spacing:4,children:[(0,a.jsx)(l.Z,{xsDown:!0,children:(0,a.jsx)(o.Z,{item:!0,sm:1})}),(0,a.jsx)(o.Z,{item:!0,xs:12,sm:10,children:(0,a.jsx)("div",{className:y().container,children:(0,a.jsx)("button",{onClick:b,className:y().primary,id:"enter",children:"Submit"})})})]})]})};n.Z=function(e){var n=e.onClose,t=e.show;return t?(0,a.jsx)(d.Z,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:_().modal,open:t,onClose:n,BackdropComponent:c.Z,BackdropProps:{timeout:500},children:(0,a.jsx)(f.Z,{in:t,children:(0,a.jsxs)("div",{className:_().modalPaper,children:[(0,a.jsx)(p.Z,{className:_().closeButton,onClick:n,color:"secondary",children:(0,a.jsx)(m.Two,{})}),(0,a.jsx)("div",{className:_().modalContent,children:(0,a.jsx)(N,{})})]})})}):null}},1173:function(e,n,t){"use strict";t.d(n,{Z:function(){return b},a:function(){return x}});var r=t(10253),a=t(85893),i=t(67294),s=t(11633),o=t(52741),c=t(79338),u=t(99477),l=t(72328),d=t(52751),f=t(75142),p=t(55709),m=t(89233),h=t(51442),v=t(69327),x=function(e){var n=e.audioContext,t=e.videoTrack,a=e.audioStream,s=e.selfMetadata$,o=e.videoPaused,c=(0,i.useState)(),u=c[0],h=c[1],x=(0,l.j7)(u),g=(0,l.j7)(o),b=function(e){var n=e.audioContext,t=e.audioStreamTrack,r=e.minDecibals,a=void 0===r?-100:r,s=e.maxDecibels,o=void 0===s?-5:s,c=(0,i.useState)(),u=c[0],l=c[1],d=(0,i.useState)(),f=d[0],p=d[1],h=(0,i.useRef)(new Uint8Array(0)),v=(0,i.useState)(new m.X(0))[0];return(0,i.useEffect)((function(){!function(){if(n){n.resume();var e=n.createAnalyser();e.fftSize=32,e.minDecibels=a,e.maxDecibels=o,e.smoothingTimeConstant=.9,h.current=new Uint8Array(e.frequencyBinCount),l(e)}}()}),[n,a,o]),(0,i.useEffect)((function(){!function(){if(n&&t){var e=new MediaStream([t]);try{var r=n.createMediaStreamSource(e);p(r)}catch(a){console.error(a)}}}()}),[n,t]),(0,i.useEffect)((function(){f&&u&&f.connect(u)}),[f,u]),(0,i.useEffect)((function(){var e,n=function(){if(u&&h.current&&f){u.getByteFrequencyData(h.current);for(var t=0,r=4;r<h.current.length/2;r+=2)t+=h.current[r];var a=t/((h.current.length/2-4)/2)/256;v.next(a),e=requestAnimationFrame(n)}};return n(),function(){e&&window.cancelAnimationFrame(e)}}),[u,h,f,v]),v}({audioContext:n,audioStreamTrack:a});(0,i.useEffect)((function(){if(t){var e=(0,v.Vq)({kind:"webcamVideo",track:t});return h(e),function(){setTimeout((function(){e.pause(),document.body.removeChild(e)}),2e3)}}}),[t]);var _=(0,i.useState)({imageTexture:null,videoTexture:null,toShow:null}),j=_[0],y=_[1];return(0,i.useEffect)((function(){var e=(0,d.Sv)(x),n=(0,d.zJ)(s),t=(0,f.aj)([e,n,g]).pipe((0,p.U)((function(e){var n=(0,r.Z)(e,3),t=n[0],a=n[1];return{toShow:n[2]?a:t||a,videoTexture:t,imageTexture:a}}))).subscribe(y);return function(){return t.unsubscribe()}}),[g,s,x]),{textures:j,volume$:b,videoElement:u,videoTrack:t}};var g=function(e){var n=e.object,t=e.avatarCameraPosition,r=(0,h.w)().camera;return(0,h.x)((function(){n.position.copy(r.position).add(t)})),null},b=(0,i.memo)((function(e){var n=e.metadata,t=e.preferVideoOrPhotoTexture,r=e.selfAvatar,l=e.avatarMeshes,d=e.setPositionFromCamera,f=r.textures,p=r.volume$,m=null===n||void 0===n?void 0:n[s.oK.bodyColor],h=(0,i.useMemo)((function(){if(m)return new u.Color(m)}),[m]),v=(0,i.useState)(),x=v[0],b=v[1];(0,i.useEffect)((function(){if(null===l||void 0===l?void 0:l.body){if(h){var e=l.body.map((function(e){return e.clone(!0)}));return e.forEach((function(e){var n=e.material.clone();n.color&&(n.color=h),e.material=n})),b(e),function(){e.forEach((function(e){var n;return null===(n=e.geometry)||void 0===n?void 0:n.dispose()}))}}b(l.body)}else b(void 0)}),[h,null===l||void 0===l?void 0:l.body]);var _=(0,i.useState)(null),j=_[0],y=_[1],S=function(e,n){return e?"photo"===e?n.imageTexture:n.videoTexture:n.toShow}(t,f);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("group",{ref:y,children:l&&(0,a.jsxs)(a.Fragment,{children:[null===x||void 0===x?void 0:x.map((function(e,n){return(0,a.jsx)("primitive",{object:e},n)})),(0,a.jsx)(c.Z,{cameraTexture:S,meshes:l.cameraSurfaces}),n&&n[s.oK.name]&&(0,a.jsx)("group",{position:l.namePosition,children:(0,a.jsx)(o.nt,{name:n[s.oK.name],visible:!0})}),l.audioPreview&&(0,a.jsx)(o.bD,{mesh:l.audioPreview,volume$:p})]})}),d&&j&&(null===l||void 0===l?void 0:l.cameraPosition)&&(0,a.jsx)(g,{object:j,avatarCameraPosition:l.cameraPosition})]})}))},14615:function(e,n,t){"use strict";var r=t(85893),a=t(67294),i=t(42422),s=t(1173),o=t(53359),c=t(36277),u=function(e){var n=e.gl;e.camera;n.setClearColor&&n.setClearColor("#ffffff",0)},l=(0,a.memo)((function(e){var n,t,l,d=e.peerMetadata,f=e.preferVideoOrPhotoTexture,p=(0,o.j)(c.u),m=(0,a.useContext)(c.u)||{},h=m.selfAvatar,v=m.avatarMeshes;return h?(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(i.Xz,{camera:{near:1,far:20,fov:45},onCreated:u,children:[(0,r.jsx)("group",{position:null===v||void 0===v?void 0:v.selfViewPosition,"rotation-x":null===v||void 0===v||null===(n=v.selfViewRotation)||void 0===n?void 0:n.x,"rotation-y":null===v||void 0===v||null===(t=v.selfViewRotation)||void 0===t?void 0:t.y,"rotation-z":null===v||void 0===v||null===(l=v.selfViewRotation)||void 0===l?void 0:l.z,children:(0,r.jsx)(p,{children:(0,r.jsx)(s.Z,{metadata:d,preferVideoOrPhotoTexture:f,selfAvatar:h,avatarMeshes:v})})}),(0,r.jsx)("ambientLight",{})]})}):null}));n.Z=l},69327:function(e,n,t){"use strict";t.d(n,{He:function(){return P},O0:function(){return M},Vq:function(){return T}});var r=t(47568),a=t(14924),i=t(26042),s=t(69396),o=t(10253),c=t(34051),u=t.n(c),l=t(67294),d=t(14788),f=t(3222),p=t(89233),m=t(75142),h=t(14370),v=t(44081),x=t(22807),g=t(66008),b=t(81030),_=t(96381),j=t(55709),y=t(12368),S=t(47746),w=t(11120),C=t(72328),I=t(10179),k=t(11227),Z=t.n(k),P=function(e){var n=e.stream,t=e.mute,r=document.createElement("video");return r.setAttribute("playsinline",!0),r.setAttribute("autoplay","true"),r.setAttribute("muted","true"),r.setAttribute("style","display:none"),t&&(r.volume=0),document.body.appendChild(r),r.srcObject=n,r},T=function(e){var n,t=e.track;if("video"===(e.kind.toLowerCase().includes("audio")?"audio":"video")){var r=document.createElement("video");r.setAttribute("playsinline",!0),r.setAttribute("autoplay","true"),r.setAttribute("muted","true"),r.setAttribute("style","display:none"),n=r}else{var a=document.createElement("audio");a.volume=0,n=a}return document.body.appendChild(n),n.srcObject=new MediaStream([t]),n},N=function(e){var n=e.sessionPaths,t=e.consumerId;d.F$.ref(n.clientConsuming({consumerId:t})).set(!0)},E=function(){var e=(0,r.Z)(u().mark((function e(n){var t,r,a,i,s,o,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.consumerTransport,r=n.consumerCreatedOnServerInfo,a=r.consumerId,i=r.rtpParameters,s=r.kind,o=r.producerId,e.next=4,t.consume({id:a,rtpParameters:i,kind:s,producerId:o});case 4:return c=e.sent,e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),M=function(e){var n=e.enteredSpace$,t=e.sessionPaths$,c=e.consumerTransport$,k=e.consumers$,P=(0,C.Qy)(),M=(0,l.useState)(new p.X({}))[0];return(0,l.useEffect)((function(){k.pipe((0,x.R)((function(e,n){var t=n.kind,r=n.producingSessionId,o=n.consumer,c=n.paused,u=n.mediaElement,l=(0,i.Z)({},e[r]||{});return o&&u?l[t]={paused:c,mediaElement:u,consumer:o}:delete l[t],(0,s.Z)((0,i.Z)({},e),(0,a.Z)({},r,l))}),{}),P()).subscribe(M)}),[M,k,P]),(0,l.useEffect)((function(){(0,m.aj)([c.pipe((0,I.YU)()),t.pipe((0,I.YU)()),n.pipe((0,g.h)((function(e){return e})),(0,b.g)(1e3))]).pipe((0,_.w)((function(e){var n=(0,o.Z)(e,2),t=n[0],a=n[1],i=function(e){return new f.y((function(n){var t=e.communicatonCollection().doc("consumers").collection("created").onSnapshot((function(e){e.docChanges().forEach((function(e){if("added"===e.type){var t=e.doc.data();n.next(t)}}))}));return function(){t()}}))}(a).pipe((0,j.U)((function(e){return{serverConsumer:e,change:"created"}}))),s=function(e){return new f.y((function(n){var t=e.userId,r=e.sessionId,a=d.h.collection("communication").doc(t).collection("session").doc(r).collection("consumers").onSnapshot((function(e){}));return function(){a()}}))}(a).pipe((0,j.U)((function(e){return{serverConsumer:e,change:"deleted"}})));return(0,h.T)(i,s).pipe((0,I.YU)(),(0,y.b)((function(e){var n=e.change,t=e.serverConsumer;return Z()("consumer:server:".concat(n))(t)})),(0,S.zg)(function(){var e=(0,r.Z)(u().mark((function e(n){var r,i,s,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.change,i=n.serverConsumer,"created"!==r){e.next=11;break}return e.next=6,E({consumerTransport:t,consumerCreatedOnServerInfo:i});case 6:s=e.sent,N({sessionPaths:a,consumerId:s.id}),o=T({track:s.track,kind:i.mediaKind}),e.next=12;break;case 11:o=null;case 12:return e.abrupt("return",{consumer:s,mediaElement:o,producingSessionId:i.producingSessionId,kind:i.mediaKind});case 13:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),(0,w.v)((function(e){var n=e.producingSessionId,t=e.kind;return"".concat(n,"-").concat(t)})),(0,S.zg)((function(e){return e.pipe((0,_.w)((function(e){var n=e.consumer,t=e.kind,r=e.producingSessionId,i=e.mediaElement;return n&&i?function(e){var n=e.consumerId,t=e.sessionPaths;return new f.y((function(e){var r=d.F$.ref(t.serverConsumerPaused({consumerId:n}));return r.on("value",(function(n){var t=n.val();"boolean"===typeof t&&e.next(t)})),function(){r.off("value")}}))}({consumerId:n.id,sessionPaths:a}).pipe((0,y.b)((function(e){return Z()("consumer:server:PauseChange")({paused:e,producingSessionId:r,kind:t})})),(0,j.U)((function(e){return e?(n.pause(),i.pause()):(n.resume(),i.play().catch((function(e){return setTimeout((function(){i.play()}),500)}))),{consumer:n,kind:t,producingSessionId:r,mediaElement:i,paused:e}}))):(0,v.D)([{consumer:null,mediaElement:null,kind:t,producingSessionId:r,paused:!0}])})))})))})),P()).subscribe(k)}),[c,k,n,t,P]),M}},27178:function(e,n,t){"use strict";t.d(n,{n_:function(){return u},p0:function(){return o}});var r=t(85893),a=t(58148),i=t.n(a),s=t(67294),o=function(e){var n=(0,s.useState)(!1),t=n[0],r=n[1];return(0,s.useEffect)((function(){var e=function(){var e=document.fullscreenElement;r(!!e)};return document.addEventListener("fullscreenchange",e),function(){document.removeEventListener("fullscreenchange",e)}}),[e]),{isFullScreen:t,toggleFullScreen:(0,s.useCallback)((function(){if(document.fullscreenElement)document.exitFullscreen().catch((function(e){return console.error(e)}));else{var n=e||document.documentElement;try{n.requestFullscreen()}catch(t){console.error(t)}}}),[e])}},c=function(e){var n=e.fullScreenElement,t=o(n),a=t.isFullScreen,s=t.toggleFullScreen;return(0,r.jsx)("button",{className:i().fullScreenButton,onClick:s,children:(0,r.jsx)("img",{src:a?"/images/icons/exit-fullscreen.svg":"/images/icons/enter-fullscreen.svg",alt:"enter fullscreen"})})},u=function(e){var n=e.fullScreenElement;return(0,r.jsx)("div",{className:i().fullscreenButtonContainer,children:(0,r.jsx)(c,{fullScreenElement:n})})}},65343:function(e,n,t){"use strict";t.d(n,{Z:function(){return xt}});var r=t(26042),a=t(69396),i=t(85893),s=t(67294),o=t(94410),c=t(47568),u=t(34051),l=t.n(u),d=t(46182),f=t(86528),p=t(72328),m=t(14924),h=t(10253),v=t(89233),x=t(44081),g=t(75142),b=t(14370),_=t(55709),j=t(16509),y=t(47746),S=t(12368),w=t(96381),C=t(22556),I=t(54250),k=t(41931),Z=t(27554),P=t(31762),T=t(26738),N=t(65562),E=t(66008),M=t(59971),D=t(10179),$=t(51438),A=t(14788),B=function(e){var n=e.spaceId,t=e.kind;return"producingPeers/".concat(n,"/").concat(t)},U=function(){function e(n){var t=n.userId,r=n.sessionId;(0,$.Z)(this,e),this.userId=t,this.sessionId=r}var n=e.prototype;return n.prefix=function(){return"userCommunication/".concat(this.userId,"/").concat(this.sessionId)},n.addPrefix=function(e){return"".concat(this.prefix(),"/").concat(e)},n.communicatonCollection=function(){return A.h.collection("users").doc(this.userId).collection("sessions").doc(this.sessionId).collection("messages")},n.router=function(){return this.addPrefix("router")},n.webRtcTransport=function(){return this.addPrefix("webrtcTransport")},n.clientWebRtcTransportConnected=function(e){var n=e.transportId;return this.addPrefix("clientWebrtcTransportsConnected/".concat(n))},n.serverWebRtcTransportConnected=function(e){var n=e.transportId;return this.addPrefix("serverWebrtcTransportsConnected/".concat(n))},n.clientConsuming=function(e){var n=e.consumerId;return this.addPrefix("clientConsuming/".concat(n))},n.serverConsumerPaused=function(e){var n=e.consumerId;return this.addPrefix("serverConsumerPaused/".concat(n))},n.serverProducing=function(e){var n=e.transportId,t=e.kind;return this.addPrefix("serverProducing/".concat(n,"/").concat(t))},n.clientProducerPaused=function(e){var n=e.producerId;return this.addPrefix("clientProducerPaused/".concat(n))},n.peersToConsume=function(e){var n=e.kind;return this.addPrefix("peersToConsume/".concat(n))},n.peerToConsume=function(e){var n=e.kind,t=e.peerId;return this.addPrefix("peersToConsume/".concat(n,"/").concat(t))},n.peersToConsumeDeltas=function(){return this.addPrefix("peersToConsumeDeltas")},n.allServerConsumers=function(){return this.addPrefix("serverConsumers")},n.serverConsumers=function(e){var n=e.producingSessionId,t=e.kind;return"".concat(this.allServerConsumers(),"/").concat(n,"/").concat(t)},e}(),L=t(11227),F=t.n(L),R=function(e){return F()("producer:".concat(e))},O=function(){var e=(0,c.Z)(l().mark((function e(n){var t,r,a,i,s,o,c,u,d;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.transportAndCanProduce,r=t.transport,a=t.canProduce,i=n.kind,s=n.track,o=n.codecOptions,c=n.codec,u=["screenAudio","webcamAudio"].includes(i)?"audio":"video",a(u)){e.next=5;break}return F()("producer:".concat(i))("cantProduce"),e.abrupt("return",void 0);case 5:return F()("producer:".concat(i))("startingToProduce"),e.next=8,r.produce({track:s,appData:{kind:i},stopTracks:!1,codecOptions:o,codec:c});case 8:return d=e.sent,F()("producer:".concat(i))("created"),e.abrupt("return",d);case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),z=function(e){var n=e.producingTransport$,t=e.track$,r=e.kind,a=e.enteredSpace$,i=e.sessionPaths$,o=e.spaceId$,u=e.userMediaPaused,f=(0,s.useState)(new v.X(void 0))[0];(0,s.useEffect)((function(){if(n){var e=a.pipe((0,S.b)((function(e){R(r)("should produce update ",e)})),(0,_.U)((function(e){return e?function(e){var n=e.producingTransport$,t=e.track$,r=e.kind,a=n.pipe((0,D.YU)(),(0,_.U)((function(e){R(r)("got transport");var n=t.pipe((0,D.YU)(),(0,j.q)(1),(0,y.zg)(function(){var n=(0,c.Z)(l().mark((function n(t){return l().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,O({transportAndCanProduce:e,kind:r,track:t});case 3:return n.t0=n.sent,n.t1=t,n.abrupt("return",{producer:n.t0,track:n.t1});case 8:return n.prev=8,n.t2=n.catch(0),R(r)("failed to produce"),n.abrupt("return",void 0);case 12:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}()),(0,S.b)((function(){R(r)("producer created")})),(0,D.YU)(),(0,w.w)((function(e){var n=e.producer,r=e.track;return t.pipe((0,_.U)((function(e){return n&&e&&e!==r&&n.replaceTrack({track:e}),{producer:n,track:e}})))})));return n})),(0,C.J)());return a}({producingTransport$:n,track$:t,kind:r}):(0,x.D)([void 0])})),(0,I.B)()).subscribe(f);return function(){return e.unsubscribe()}}}),[a,r,f,n,t]),(0,s.useEffect)((function(){var e=f.pipe((0,D.YU)(),(0,_.U)((function(e){return e.producer})),(0,k.x)(),(0,Z.G)()).subscribe({next:function(e){var n=(0,h.Z)(e,1)[0];null===n||void 0===n||n.close()}});return function(){e.unsubscribe()}}),[f]);var $=(0,s.useState)(new v.X(!0))[0],U=(0,p.dO)($),L=(0,p.j7)(u);(0,s.useEffect)((function(){var e=(0,g.aj)([L.pipe((0,k.x)()),f.pipe((0,D.YU)())]).pipe((0,S.b)((function(e){var n=(0,h.Z)(e,2),t=n[0],a=n[1],i=(a.track,a.producer);R(r)("paused update",{pause:t,producerExists:!!i})})),(0,w.w)(function(){var e=(0,c.Z)(l().mark((function e(n){var t,r,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,h.Z)(n,2),r=t[0],(a=t[1].producer)&&!r&&a.paused&&(R("resuming producer"),a.resume()),e.abrupt("return",r);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),(0,S.b)((function(e){(0,d.hO)((0,m.Z)({},"Sending ".concat(r),!!e))}))).subscribe($);return function(){return e.unsubscribe()}}),[r,f,$,L]);var F=(0,p.j7)(r);return(0,s.useEffect)((function(){var e=(0,g.aj)([F.pipe((0,k.x)()),i.pipe((0,D.YU)(),(0,k.x)()),o.pipe((0,D.YU)(),(0,k.x)())]).pipe((0,_.U)((function(e){var n=(0,h.Z)(e,3),t=n[0],r=n[1],a=function(e){var n=e.spaceId,t=e.kind,r=e.sessionId;return"".concat(B({spaceId:n,kind:t}),"/").concat(r)}({spaceId:n[2],kind:t,sessionId:r.sessionId});return{ref:A.vM.ref(a),userId:r.userId}})),(0,P._)(1,void 0,(function(e){var n=e.pipe((0,Z.G)(),(0,S.b)((function(e){(0,h.Z)(e,1)[0].ref.remove()})),(0,T.l)());return(0,b.T)(n,e)})));(0,g.aj)([$,e]).pipe((0,_.U)((function(e){var n=(0,h.Z)(e,2),t=n[0],r=n[1],a=r.ref,i=r.userId;return{paused:t,ref:a,userId:i,key:"".concat(t,"-").concat(a.key,"-").concat(i)}})),(0,N.g)("key")).subscribe({next:function(){var e=(0,c.Z)(l().mark((function e(n){var t,r,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.paused,r=n.ref,a=n.userId,e.next=3,r.update({userId:a,paused:t});case 3:r.onDisconnect().remove();case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()})}),[F,$,i,o]),(0,s.useEffect)((function(){var e=$.pipe((0,E.h)((function(e){return!e})),(0,M.P)()),n=(0,g.aj)([e,f.pipe((0,k.x)()),i]).pipe((0,E.h)((function(e){var n=(0,h.Z)(e,3),t=n[1],r=n[2];return!(!t||!r)&&!!t.producer})),(0,_.U)((function(e){var n=(0,h.Z)(e,3),t=n[0],r=n[1],a=n[2],i=r.producer.id,s=null===a||void 0===a?void 0:a.clientProducerPaused({producerId:i});return{paused:t,pathToUpdate:s,key:"".concat(t,"-").concat(s)}})),(0,N.g)("key")).subscribe({next:function(e){var n=e.paused,t=e.pathToUpdate;A.sM.ref(t).set({paused:n})}});return function(){return n.unsubscribe()}}),[$,f,i]),{paused:U}},W={qvga:{width:{ideal:320},height:{ideal:240}},vga:{width:{ideal:640},height:{ideal:480}},hd:{width:{ideal:1280},height:{ideal:720}}},V={hd:{sampleRate:44100,channelCount:2},sd:{}},X=function(e){return W[e]||{}},K=function(e){return V[e]||{}},Y=function(e){var n=e.initialized,t=e.getConstraints,r=e.track,a=e.deviceList,i=e.producingTransport$,o=e.kind,u=e.sessionPaths$,d=e.spaceId$,m=e.produce$,h=(0,s.useState)({stream:void 0,deviceId:void 0}),v=h[0],x=v.stream,g=v.deviceId,b=h[1],_=(0,s.useState)({getting:!1,failedGetting:!1}),j=_[0],y=_[1],S=j.failedGetting,w=j.getting,C=(0,s.useCallback)(function(){var e=(0,c.Z)(l().mark((function e(a){var i,s,o,c=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=c.length>1&&void 0!==c[1]&&c[1],n&&!w){e.next=3;break}return e.abrupt("return");case 3:if(!a||a!==g||i){e.next=5;break}return e.abrupt("return");case 5:return s=t(a),y({getting:!0,failedGetting:!1}),e.prev=8,e.next=11,navigator.mediaDevices.getUserMedia(s);case 11:o=e.sent,e.next=20;break;case 14:return e.prev=14,e.t0=e.catch(8),console.error(e.t0),y({failedGetting:!0,getting:!1}),(0,f.wU)({kind:r}),e.abrupt("return");case 20:(0,f.Xy)({kind:r}),b((function(e){var n=e.stream;n&&n.stop();var t="microphone"===r?o.getAudioTracks()[0]:o.getVideoTracks()[0],a=t.getSettings().deviceId;return{stream:t,deviceId:a}})),y({failedGetting:!1,getting:!1});case 23:case"end":return e.stop()}}),e,null,[[8,14]])})));return function(n){return e.apply(this,arguments)}}(),[g,t,w,n,r]),I=(0,s.useCallback)((0,c.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x&&(x.stop(),b((function(e){return{stream:void 0,deviceId:e.deviceId}})));case 1:case"end":return e.stop()}}),e)}))),[x]),k=(0,s.useCallback)((0,c.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",C(void 0,!0));case 1:case"end":return e.stop()}}),e)}))),[C]),Z=(0,s.useCallback)(function(){var e=(0,c.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:a.forEach((function(e){t===e.deviceId&&C(t)}));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[a,n,C]),P=!x&&!w,T=(0,p.j7)(x);return z({producingTransport$:i,track$:T,kind:o,enteredSpace$:m,sessionPaths$:u,spaceId$:d,userMediaPaused:P}),{sendingDeviceId:g,gettingStream:w,deviceList:a,failedGettingStream:S,pause:I,resume:k,paused:P,selectSendingDevice:Z,sendingStream:x,setStream:b,setStreamState:y,updateStreamFromDevice:C}};function G(e){return H.apply(this,arguments)}function H(){return(H=(0,c.Z)(l().mark((function e(n){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.readyState<3)){e.next=3;break}return e.next=3,new Promise((function(e){return n.addEventListener("canplay",e)}));case 3:if(!n.captureStream){e.next=7;break}return e.abrupt("return",n.captureStream());case 7:if(!n.mozCaptureStream){e.next=11;break}return e.abrupt("return",n.mozCaptureStream());case 11:throw new Error("video.captureStream() not supported");case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var q=function(e){var n=e.initialized,t=e.externalVideoElement,i=e.useExternalVideo,o=e.invisible,u=e.videoResolution,p=e.micQuality,m=e.producingTransport$,h=e.sessionPaths$,v=e.spaceId$,x=e.produce$,g=(0,s.useState)(!1),b=g[0],_=g[1],j=(0,s.useCallback)((function(){_(!0)}),[]),y=(0,s.useState)("vga"),S=y[0],w=y[1],C=function(e){var n=(0,s.useState)({audio:[],video:[]}),t=n[0],i=n[1],o=(0,s.useCallback)((0,c.Z)(l().mark((function e(){var n,t,r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.enumerateDevices();case 2:n=e.sent,t=[],r=[],n.forEach((function(e){"audioinput"===e.kind?t.push(e):"videoinput"===e.kind&&r.push(e)})),i({audio:t,video:r});case 7:case"end":return e.stop()}}),e)}))),[]);return(0,s.useEffect)((function(){e||o()}),[o,e]),(0,a.Z)((0,r.Z)({},t),{refreshAvailableDevices:o})}(t),I=C.audio,k=C.video,Z=C.refreshAvailableDevices,P=(0,s.useMemo)((function(){return function(e){return function(n){return{audio:(0,r.Z)({deviceId:n?{exact:n}:void 0},K(e)),video:!1}}}(p)}),[p]),T=Y({getConstraints:P,initialized:n,deviceList:I,track:"microphone",kind:"webcamAudio",produce$:x,producingTransport$:m,sessionPaths$:h,spaceId$:v}),N=(0,s.useMemo)((function(){return function(e){return function(n){return{audio:!1,video:(0,r.Z)({deviceId:n?{exact:n}:void 0},X(e))}}}(S)}),[S]),E=Y({getConstraints:N,initialized:n,deviceList:k,track:"webcam",kind:"webcamVideo",produce$:x,producingTransport$:m,sessionPaths$:h,spaceId$:v}),M=T.setStream,D=E.setStream,$=(0,s.useCallback)(function(){var e=(0,c.Z)(l().mark((function e(n){var t,r,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G(n);case 2:t=e.sent,r=t.getAudioTracks()[0].clone(),a=t.getVideoTracks()[0].clone(),D({stream:new MediaStream([a]).getTracks()[0],deviceId:void 0}),M({stream:new MediaStream([r]).getTracks()[0],deviceId:void 0});case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[D,M]),A=T.setStreamState,B=E.setStreamState,U=(0,s.useCallback)((0,c.Z)(l().mark((function e(){var n,t,a,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={audio:(0,r.Z)({},K(p)),video:(0,r.Z)({},X(S))},A({failedGetting:!1,getting:!0}),B({failedGetting:!1,getting:!0}),e.prev=4,e.next=7,navigator.mediaDevices.getUserMedia(n);case 7:t=e.sent,e.next=17;break;case 10:return e.prev=10,e.t0=e.catch(4),console.error(e.t0),A({failedGetting:!0,getting:!1}),B({failedGetting:!0,getting:!1}),(0,f.wU)({kind:"webcamAndMic"}),e.abrupt("return");case 17:(0,f.Xy)({kind:"webcamAndMic"}),a=t.getVideoTracks()[0],i=t.getAudioTracks()[0],M({stream:i,deviceId:i.getSettings().deviceId}),D({stream:a,deviceId:a.getSettings().deviceId}),A({getting:!1,failedGetting:!1}),B({getting:!1,failedGetting:!1});case 24:case"end":return e.stop()}}),e,null,[[4,10]])}))),[p,S,M,A,D,B]);(0,s.useEffect)((function(){n&&t&&$(t)}),[n,t,$]);var L=E.sendingStream,F=T.sendingStream,R=T.failedGettingStream,O=E.failedGettingStream,z=(0,s.useState)(!1),W=z[0],V=z[1];(0,s.useEffect)((function(){n&&!o&&(i||W||b&&(V(!0),U()))}),[b,W,n,o,U,i]);var H=(0,s.useCallback)((function(e){"qvga"===e?w("qvga"):"vga"===e?w("vga"):"hd"===e&&w("hd")}),[]);(0,s.useEffect)((function(){H(u)}),[H,u]);var q=(0,s.useCallback)((function(){setTimeout((function(){U()}),200)}),[U]);return function(e){var n=e.micCaptureFailed,t=e.webcamCaptureFailed,r=e.micStreamSet,a=e.webcamStreamSet;(0,s.useEffect)((function(){var e;e=r?"succeeded":n?"failed":"pending",(0,d.hO)({microphoneStatus:e})}),[r,n]),(0,s.useEffect)((function(){var e;e=a?"succeeded":t?"failed":"pending",(0,d.hO)({webcamStatus:e})}),[a,t])}({micCaptureFailed:R,webcamCaptureFailed:O,micStreamSet:!!F,webcamStreamSet:!!L}),{mic:T,webcam:E,switchResolution:H,refreshAvailableDevices:Z,rerequestMedia:q,grantAccessRequestForWebcamAndMic:j,grantedAccessRequestForWebcamAndMic:b}},Q=t(25784),J=t(68624),ee=t(19258),ne=t(14963),te=t(11633),re=t(70211),ae=function(e){var n=e.userId,t=e.sessionId,r=e.authenticated,a=(0,s.useState)(new v.X(void 0))[0];return(0,s.useEffect)((function(){if(r&&t&&n){var e=new U({sessionId:t,userId:n});a.next(e)}else void 0!==a.value&&a.next(void 0)}),[n,t,r,a]),a},ie=t(91200),se=t(75460),oe=function(e){var n=e.spaceSettings,t=e.peerSettingsOverride,r=(0,Q.G$)(n.peers,J.ZV),a=(0,s.useMemo)((function(){var e=function(e,n){return e?Math.min(e,n):e};return{maxAudioPeers:e((null===t||void 0===t?void 0:t.maxAudioPeers)||r.maxAudioPeers,20),maxVideoPeers:e((null===t||void 0===t?void 0:t.maxVideoPeers)||r.maxVideoPeers,20),maxPeerMediaDistance:(null===t||void 0===t?void 0:t.maxPeerMediaDistance)||r.maxPeerMediaDistance,maxTweenedPeers:(null===t||void 0===t?void 0:t.maxTweenedPeers)||r.maxTweenedPeers,maxVisiblePeers:(null===t||void 0===t?void 0:t.maxVisiblePeers)||r.maxVisiblePeers}}),[r,t]),i=(0,s.useMemo)((function(){return{webcamAudio:a.maxAudioPeers,webcamVideo:a.maxVideoPeers}}),[a]);return{peersSettings$:(0,p.j7)(a),maxPeers$:(0,p.j7)(i)}},ce=t(3222),ue=t(50960),le=function(e){return F()("transport:".concat(e))},de=function(e){var n=e.transportId,t=e.dtlsParameters,r=e.sessionPaths,a={dtlsParameters:t};A.sM.ref(r.clientWebRtcTransportConnected({transportId:n})).set(a)},fe=function(e){var n=e.transportId,t=e.sessionPaths;return new Promise((function(e,r){A.sM.ref(t.serverWebRtcTransportConnected({transportId:n})).on("value",e)}))},pe=function(e){var n=e.transportId,t={kind:e.kind,rtpParameters:e.rtpParameters};e.sessionPaths.communicatonCollection().doc("clientProducing-".concat(n)).set(t)},me=function(e){var n=e.transportId,t=e.sessionPaths,r=e.kind;return new Promise((function(e,a){var i=A.sM.ref(t.serverProducing({transportId:n,kind:r}));i.on("value",(function(n){var t=n.val();t&&(e(t),i.off("value"))}))}))},he=function(e){return function(e){var n=A.sM.ref(e.webRtcTransport());return new ce.y((function(e){return n.on("child_added",(function(n){var t=n.key,r=n.val();e.next({kind:t,transportInfo:r})})),function(){n.off("child_added")}}))}(e)},ve=function(e){return F()("device:".concat(e))},xe=function(e){var n=e.pipe((0,k.x)(),(0,w.w)((function(e){return e?function(e){var n=A.h.collection("routerRtpCapabilities").doc(e);return new ce.y((function(e){var t=n.onSnapshot((function(n){var t=n.data();t&&e.next(t)}));return function(){t()}}))}(e).pipe((0,S.b)((function(e){return ve("rtp capabilities from server:")(e)})),(0,y.zg)(function(){var e=(0,c.Z)(l().mark((function e(n){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t=new ue.Device({})}catch(r){console.error("failed creating media device with error: ".concat(null===r||void 0===r?void 0:r.toString(),". User agent: ").concat(navigator.userAgent))}if(!t){e.next=7;break}return n.headerExtensions&&(n.headerExtensions=n.headerExtensions.filter((function(e){return"urn:3gpp:video-orientation"!==e.uri}))),e.next=6,t.load({routerRtpCapabilities:n});case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),(0,S.b)((function(){return ve("loaded")({})}))):(0,x.D)([void 0])})));return n},ge=function(e){var n=e.sessionPaths;return e.mediasoupDevice$.pipe((0,w.w)((function(e){return e?n.pipe((0,D.YU)(),(0,w.w)((function(n){return he(n).pipe((0,_.U)((function(t){return{serverTransport:t,device:e,sessionPaths:n}})))})),(0,S.b)((function(e){le(e.serverTransport.kind)("created on server")})),(0,_.U)((function(e){var n=e.serverTransport,t=n.kind,i=n.transportInfo,s=e.device,o=e.sessionPaths,c=(0,a.Z)((0,r.Z)({},i),{iceCandidates:i.iceCandidates,iceServers:[]});return{transport:"consuming"===t?s.createRecvTransport(c):s.createSendTransport((0,r.Z)({},c)),kind:t,transportId:i.id,device:s,sessionPaths:o}})),(0,S.b)((function(e){var n=e.transport,t=e.transportId,r=e.sessionPaths,a=e.kind;(function(e){var n=e.transport,t=e.transportId,r=e.sessionPaths,a=e.kind;return new Promise(function(){var e=(0,c.Z)(l().mark((function e(i){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.on("connect",(function(e,n,s){var o=e.dtlsParameters;de({transportId:t,dtlsParameters:o,sessionPaths:r}),fe({transportId:t,sessionPaths:r}).then((function(){F()("transport:serverConnected")({transportId:t,kind:a}),n(),i(null)}))}));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())})({transport:n,transportId:t,sessionPaths:r,kind:a}).then((function(){le(a)("server connected")})),"producing"===a&&function(e){var n=e.transport,t=e.sessionPaths;n.on("produce",function(){var e=(0,c.Z)(l().mark((function e(r,a,i){var s,o,c,u;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.rtpParameters,o=r.appData,e.prev=1,c=o.kind,pe({transportId:n.id,kind:c,rtpParameters:s,sessionPaths:t}),e.next=6,me({sessionPaths:t,transportId:n.id,kind:c});case 6:u=e.sent,a({id:u.producerId}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),i(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(n,t,r){return e.apply(this,arguments)}}())}({transport:n,sessionPaths:r})}))):(0,x.D)([void 0])})))},be=t(5631),_e=function(){var e=(0,c.Z)(l().mark((function e(n){var t,r,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.spaceId,e.next=3,(0,A.wk)().httpsCallable("joinSpace")({spaceId:t});case 3:return r=e.sent,a=r.data.joinRequestId,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();var je=function(e){var n=e.initialized$,t=e.enteredSpace$,r=e.spaceId$,a=e.userId$,i=e.authenticated,o=(0,s.useState)(new v.X(!1))[0],c=(0,s.useState)(new v.X(void 0))[0],u=(0,s.useState)(new v.X(void 0))[0],l=(0,s.useState)(new v.X(void 0))[0],d=(0,p.Qy)();return(0,s.useEffect)((function(){if(i){var e=t.pipe((0,w.w)((function(e){return e?(0,g.aj)([r.pipe((0,k.x)()),a.pipe((0,k.x)())]):be.E}))).subscribe({next:function(e){var n=(0,h.Z)(e,2),t=n[0],r=n[1],a=A.h.collection("users").doc(r).collection("visits");try{a.add({spaceId:t,time:(0,A.Qk)()})}catch(i){console.error(i)}}});return function(){return e.unsubscribe()}}}),[t,r,a,i]),(0,s.useEffect)((function(){if(i){var e=n.pipe((0,w.w)((function(e){if(!e)return be.E;var n=r.pipe((0,D.YU)(),(0,M.P)());return(0,g.aj)([n.pipe((0,k.x)()),a.pipe((0,k.x)())]).pipe((0,w.w)((function(e){var n=(0,h.Z)(e,2),t=n[0];return n[1]?(0,x.D)(_e({spaceId:t})).pipe((0,D.YU)()):(0,x.D)([void 0])}))).pipe((0,k.x)(),d())}))).subscribe(c),t=c.pipe((0,Z.G)()).subscribe({next:function(e){var n,t=(0,h.Z)(e,1)[0];t&&(n=t,A.h.collection("unjoinRequests").add({sessionId:n}))}}),s=c.pipe((0,w.w)((function(e){return e?function(e){return new ce.y((function(n){var t=A.h.collection("joinRequests").doc(e).onSnapshot((function(e){n.next(e.data())}));return function(){t()}}))}(e):be.E})),d()).subscribe({next:function(e){var n=e.status,t=e.routerId;l.next(n),o.next("joined"===n),u.next(t)}});return function(){e.unsubscribe(),t.unsubscribe(),s.unsubscribe()}}}),[n,l,o,u,c,r,d,a,i]),{sessionId$:c,joined$:o,routerId$:u,joinStatus$:l}},ye=t(60315),Se=t(8077),we=function(e){var n=e.initialized,t=(0,s.useState)((function(){return/Firefox/i.test(navigator.userAgent)}))[0],r=(0,s.useState)(!1),a=r[0],i=r[1];return(0,s.useEffect)((function(){i(t)}),[t,n]),a},Ce=t(7637),Ie=t.n(Ce),ke=t(71505),Ze=function(){return(0,ke.ZP)()?"number"===typeof window.orientation?window.orientation:window.screen&&window.screen.orientation?window.screen.orientation.type:void 0:0},Pe={"landscape-primary":0,"landscape-secondary":180,"portrait-primary":90,"portrait-secondary":-90},Te=t(97257),Ne=function(e){var n=e.spaceId,t=e.spaceSlug,r=e.eventSlug,a=e.enteredSpace,i=e.userInfo,o=i.owner,c=i.editor,u=e.metadata;(0,s.useEffect)((function(){t&&n&&(0,f.iQ)({spaceSlug:t,spaceId:n})}),[t,n]),(0,s.useEffect)((function(){t&&a&&n&&(0,f.bg)({spaceSlug:t,spaceId:n})}),[a,t,n]),(0,s.useEffect)((function(){t&&(0,f.XA)()}),[t]),(0,s.useEffect)((function(){var e=!(!o&&!c),a=!e;(0,d.hO)({ownerOrEditor:e,guest:a,spaceSlug:t,spaceId:n,event:r})}),[o,c,t,n,r]);var l=(0,s.useMemo)((function(){return u?u[te.oK.name]:null}),[u]);(0,s.useEffect)((function(){(0,d.hO)({nameIsSet:!!l})}),[l])},Ee=t(51381),Me=t(62822),De=t(50998),$e=t(15575),Ae=t(22537),Be=t.n(Ae),Ue=t(41749),Le=t(26564),Fe=t(43485),Re=t(43825),Oe=t(13196),ze=t.n(Oe),We=t(89445),Ve=t(52795),Xe=t(64566),Ke=t(86010),Ye=t(53731),Ge=t(14310),He=[We.A2,We.Qq,We.Cl,We.AZ],qe=function(e){var n=e.userName$,t=e.userId$,i=e.sessionId$,o=e.spaceId$,c=e.serverTimeOffset$,u=(0,s.useState)(new v.X([]))[0];(0,s.useEffect)((function(){var e=o.pipe((0,w.w)((function(e){if(!e)return(0,x.D)([]);return function(e,n,t){var i=new ce.y((function(n){var t=A.h.collection("chatMessages").where("spaceId","==",e).orderBy("sentOn","desc").limit(150),i={},s=0,o=function(e){var n=i[e];if(n)return n;var t=He[s%He.length];return i[e]=t,s++,t},c=t.onSnapshot((function(e){var t=e.docs.map((function(e){var n=e.data();return(0,a.Z)((0,r.Z)({},n),{id:e.id,color:o(n.sessionId)})}));n.next(t.reverse())}));return function(){c()}})),s=(0,Le.F)(6e4).pipe((0,Fe.O)(0),(0,Re.M)(n),(0,_.U)((function(e){var n=(0,h.Z)(e,2)[1];return((new Date).getTime()+n)/1e3-t})));return(0,g.aj)([i,s]).pipe((0,_.U)((function(e){var n=(0,h.Z)(e,2),t=n[0],r=n[1];return t.filter((function(e){return!e.sentOn||e.sentOn.seconds>=r}))})))}(e,c,21600)}))).subscribe(u);return function(){e.unsubscribe()}}),[u,c,o]);var l=(0,s.useState)(new re.xQ)[0],d=(0,s.useCallback)((function(e){l.next(e)}),[l]);return(0,s.useEffect)((function(){var e=(0,x.D)(["guest-".concat(ze()({length:3}))]),s=(0,g.aj)([n,e]).pipe((0,_.U)((function(e){var n=(0,h.Z)(e,2),t=n[0],r=n[1];return t||r}))),c=(0,g.aj)([t.pipe((0,D.YU)()),s,o.pipe((0,D.YU)()),i.pipe((0,D.YU)())]),u=l.pipe((0,Re.M)(c),(0,_.U)((function(e){var n=(0,h.Z)(e,2),t=n[0],r=(0,h.Z)(n[1],4),a=r[0],i=r[1],s=r[2];return{userId:a,sessionId:r[3],spaceId:s,name:i,message:t}}))).subscribe({next:function(e){A.h.collection("chatMessages").add((0,a.Z)((0,r.Z)({},e),{sentOn:(0,A.Qk)()}))}});return function(){u.unsubscribe()}}),[n,l,i,o,t]),{sendChatMessage:d,chatMessages$:u}},Qe=function(e,n,t){return(0,i.jsxs)("a",{target:"blank",href:e,children:[" ",n," "]},t)},Je=function(e){var n=e.userName$,t=e.userId$,r=e.spaceId$,a=e.sessionId$,o=e.serverTimeOffset$,c=qe({userName$:n,userId$:t,spaceId$:r,sessionId$:a,serverTimeOffset$:o}),u=c.sendChatMessage,l=c.chatMessages$,d=(0,p.Hq)(l,[]),f=(0,s.useState)(""),m=f[0],h=f[1],v=(0,s.useRef)(null),x=(0,s.useCallback)((function(){v.current&&(v.current.scrollTop=v.current.scrollHeight)}),[]);(0,s.useEffect)((function(){var e=l.pipe((0,E.h)((function(e){return e.length>0}))).subscribe({next:function(){x()}});return function(){e.unsubscribe()}}),[l,x]);var g=(0,s.useCallback)((function(e){e.stopPropagation(),h(e.target.value)}),[]),b=(0,s.useCallback)((function(e){e.stopPropagation()}),[]),_=(0,s.useCallback)((function(e){e.preventDefault(),m.length>0&&(u(m),h(""))}),[m,u]),j=(0,s.useCallback)((function(){document.activeElement&&document.activeElement.blur&&document.activeElement.blur()}),[]),y=(0,s.useState)(!1),S=y[0],w=y[1],C=(0,s.useCallback)((function(e){e.preventDefault(),w((function(e){return!e}))}),[]);return(0,s.useEffect)((function(){S&&x()}),[S,x]),(0,i.jsx)(Ge.Z,{position:"relative",zIndex:1,children:(0,i.jsx)(Ue.Z,{container:!0,direction:"row",justify:"flex-end",alignItems:"flex-start",children:(0,i.jsxs)(Ue.Z,{item:!0,xs:11,md:4,lg:4,className:(0,Ke.default)(Be().chatContainer,S?null:Be().minimized),children:[(0,i.jsx)("div",{className:Be().chatBg}),(0,i.jsx)(Xe.Z,{className:(0,Ke.default)(Be().expandIcon,S?Be().expanded:null),onClick:C}),!S&&(0,i.jsxs)("label",{className:Be().status,onClick:C,children:["chat (",d.length," messages)"]}),S&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:Be().chatMessagesContainer,ref:v,children:(0,i.jsx)(Me.Z,{className:Be().chat,children:d.map((function(e){return(0,i.jsxs)(De.Z,{children:[(0,i.jsxs)("b",{style:{color:e.color},children:[e.name,":\xa0"]}),(0,i.jsx)(Ye.Z,{componentDecorator:Qe,children:e.message})]},e.id)}))})}),(0,i.jsx)(Me.Z,{style:{paddingTop:0,paddingBottom:0},children:(0,i.jsx)(De.Z,{children:(0,i.jsx)(Ve.Z,{onClickAway:j,children:(0,i.jsx)("form",{onSubmit:_,onKeyDown:b,className:Be().form,children:(0,i.jsx)($e.Z,{className:Be().input,placeholder:"Send a Message",inputProps:{"aria-label":"send a message"},value:m,onChange:g})})})})})]})]})})})},en=t(13065),nn=t(10682),tn=t(31555),rn=t(21608),an=t(81628),sn=t.n(an),on=t(25935),cn=t(29616),un=t.n(cn),ln=function(e){var n=e.welcomeHTML;return n=(0,Q.G$)(n,J.HC),(0,i.jsx)(i.Fragment,{children:(0,on.ZP)(n)})},dn=function(e){var n=e.spaceSlug,t=e.spaceMetadata;return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{className:(0,Ke.default)(un().welcomeScreenContainers,"p-2 p-md-4"),children:(0,i.jsxs)("div",{className:(0,Ke.default)(un().welcomeScreenContent,"my-md-4"),children:[(0,i.jsxs)("h1",{className:"eventTitle",children:["Welcome to ",(null===t||void 0===t?void 0:t.name)||n," in Arium"]}),(0,i.jsx)("div",{className:(0,Ke.default)(un().welcomeMessageContainer,"d-none d-md-block"),children:(0,i.jsx)(ln,{welcomeHTML:null===t||void 0===t?void 0:t.welcomeHTML})})]})})})},fn=t(60668),pn=t(1549),mn=t(31818),hn=t(78295),vn=t.n(hn),xn=function(e){var n=e.headingText,t=void 0===n?"Please allow Arium to access your camera and microphone":n,r=e.close,a=e.spaceSlug,o=e.spaceId,c=(0,s.useCallback)((function(e){e.preventDefault(),(0,f.lR)({spaceSlug:a,spaceId:o,grantAccess:!0}),r(!1)}),[r,a,o]),u=(0,s.useCallback)((function(e){e.preventDefault(),(0,f.lR)({spaceSlug:a,spaceId:o,grantAccess:!1}),r(!0)}),[r,a,o]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(rn.Z,{children:(0,i.jsxs)(tn.Z,{xs:12,className:"px-4 px-m-1",children:[(0,i.jsx)("h2",{className:(0,Ke.default)(sn().lightText,"d-none d-md-block"),children:t}),(0,i.jsx)("p",{className:(0,Ke.default)(sn().lightText,"text-center text-md-left"),children:"Arium is a social experience. Select \u2018Allow\u2019 when your browser asks for permission to use your microphone and camera so that other guests can see and hear you."})]})}),(0,i.jsxs)(rn.Z,{className:(0,Ke.default)("my-md-2"),children:[(0,i.jsx)(tn.Z,{xs:12,children:(0,i.jsx)("div",{className:(0,Ke.default)(vn().container,vn().bottomFixedOnSmall),children:(0,i.jsx)("button",{onClick:c,className:vn().primary,id:"initialize",children:"Join with webcam and microphone"})})}),(0,i.jsx)(tn.Z,{xs:12,className:"my-md-2",children:(0,i.jsx)("p",{className:(0,Ke.default)(sn().lightText,sn().skipLink),children:(0,i.jsx)("a",{href:"#",onClick:u,title:"Don't grant camera access.",children:"Skip for now"})})})]})]})},gn=t(55517),bn=t(22318),_n=t(70031),jn=t(29674),yn=t(81534),Sn=t(72841),wn=t.n(Sn),Cn=t(98268),In=t(75913),kn=t.n(In),Zn=t(98432),Pn=t.n(Zn),Tn=t(51549),Nn=function(){var e=(0,s.useMemo)((function(){return(0,mn.YW)({prefix:"Continue with"})}),[]),n=(0,s.useMemo)((function(){return(0,A.I8)()}),[]);return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(kn(),{uiConfig:e,firebaseAuth:n,className:Pn().firebaseAuth})})},En=function(e){var n=e.accept,t=e.disabled;e.spaceInvite;return(0,i.jsx)("div",{className:vn().container,style:{width:"400px",top:"10px",left:0,margin:"30px auto 20px auto"},children:(0,i.jsx)("button",{onClick:n,className:vn().primary,id:"enter",disabled:t,children:"Accept Invitation and Collaborate"})})},Mn=function(e){var n=e.inviteId,t=e.userId,r=e.spaceId,a=e.spaceSlug,o=e.spaceName,u=e.isAnonymous,d=e.onComplete,f=(0,_n.Y)({path:(0,jn.CG)({spaceId:r,inviteId:n}).path}),p=(0,yn.Gr)(null===f||void 0===f?void 0:f.fromUserId),m=(0,s.useState)(!0),h=m[0],v=m[1],x=(0,s.useCallback)((function(){v(!1),d()}),[d]),g=(0,s.useState)(!1),b=g[0],_=g[1],j=(0,s.useState)(void 0),y=j[0],S=j[1];(0,s.useEffect)((function(){(null===f||void 0===f?void 0:f.claimed)&&((null===f||void 0===f?void 0:f.claimedByUserId)!==t?S("Oops, it looks like this invite has already been claimed.  Please contact info@arium.xyz for further assistance."):d())}),[null===f||void 0===f?void 0:f.claimed,null===f||void 0===f?void 0:f.claimedByUserId,t,d]);var w=(0,s.useCallback)((0,c.Z)(l().mark((function e(){var t,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _(!0),e.prev=1,t={inviteId:n,spaceId:r},e.next=5,(0,A.wk)().httpsCallable("acceptSpaceInvitation")(t);case 5:(i=e.sent.data).success?((0,Tn.ed)({spaceId:r,spaceSlug:a}),x()):S(i.error),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:return e.prev=12,_(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])}))),[n,r,a,x]);return(0,s.useEffect)((function(){a&&(0,Tn.kf)({spaceSlug:a,spaceId:r})}),[a,r]),f&&p&&h?(0,i.jsx)(Cn.Z,{open:h,handleClose:x,size:"large",backdropDisabled:!0,children:(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:wn().centeredContents,children:[(0,i.jsx)(bn.Z,{variant:"h2",children:"Welcome to Arium"}),(0,i.jsxs)(bn.Z,{variant:"h3",children:["You've been invited to collaborate on and edit the space ",o,"!"]}),(0,i.jsx)(gn.Z,{}),y&&(0,i.jsx)("p",{style:{margin:"20px 0"},children:y}),!y&&(0,i.jsxs)(i.Fragment,{children:[u&&(0,i.jsx)(Nn,{}),!u&&(0,i.jsx)(En,{accept:w,disabled:b,spaceInvite:f})]})]})})}):null};var Dn=function(e){var n=e.spaceId,t=e.spaceSlug,r=e.enterSpace,a=e.mediaDevices,o=e.setKeyboardControlsDisabled,c=e.initialized,u=e.spaceMetadata,l=e.initialize,d=e.profileSetter,f=e.eventSlug,p=e.inviteId,m=e.isAnonymous,h=e.userId,v=(0,s.useState)(!1),x=v[0],g=v[1],b=(0,s.useState)(!1),_=b[0],j=b[1],y=(0,s.useCallback)((function(){g(!0)}),[g]),S=a.webcam.failedGettingStream,w=a.mic.failedGettingStream;(0,s.useEffect)((function(){S&&w&&g(!0)}),[S,w]);var C=(0,s.useCallback)((function(){j(!0)}),[j]);(0,s.useEffect)((function(){_&&x&&r()}),[_,x,r]);var I=function(e){var n=e.spaceName,t=e.spaceSlug;return n||t}({spaceName:null===u||void 0===u?void 0:u.name,spaceSlug:t}),k=(0,s.useState)(!1),Z=k[0],P=k[1],T=(0,mn.JL)({ensureSignedInAnonymously:!1}).user,N=(0,s.useCallback)((function(e){l(e),e&&y(),P(!0)}),[l,y]),E=(0,s.useCallback)((function(){P(!0)}),[]),M=!c&&!f&&!p,D=(0,s.useMemo)((function(){return M?"Please allow Arium to access your camera and microphone":function(e){return"Welcome to ".concat(e," in Arium")}(I)}),[M,I]);if(p&&!Z)return(0,i.jsx)(Mn,{inviteId:p,spaceId:n,spaceSlug:t,onComplete:E,spaceName:I,isAnonymous:m,userId:h});var $=(0,i.jsxs)(i.Fragment,{children:[!c&&(0,i.jsx)(xn,{close:N,headingText:D,spaceSlug:t,spaceId:n}),c&&!x&&(0,i.jsx)(fn.Z,{mediaDevices:a,handleContinue:y}),x&&T&&(0,i.jsx)(pn.Z,{hasWebcamStream:!!a.webcam.sendingStream,handleContinue:C,profileSetter:d,setKeyboardControlsDisabled:o,user:T})]});return(0,i.jsx)(nn.Z,{fluid:!0,className:(0,Ke.default)(sn().container,"vh-100 mx-0 px-0"),children:(0,i.jsxs)(tn.Z,{className:"vh-100 mx-0 px-0",children:[M&&(0,i.jsxs)(rn.Z,{className:"justify-content-center vh-100 mx-0 px-0",children:[(0,i.jsx)(tn.Z,{xs:12,md:6,className:(0,Ke.default)(sn().eventDescriptionContainer,"align-self-start align-self-md-center justify-self-start mr-auto"),children:(0,i.jsx)(dn,{spaceSlug:t,spaceMetadata:u})}),(0,i.jsx)(tn.Z,{xs:12,md:4,className:"align-self-md-center align-self-start mr-auto",style:{position:"relative"},children:$})]}),!M&&(0,i.jsx)(rn.Z,{className:"justify-content-center vh-100 mx-0 px-0",children:(0,i.jsx)(tn.Z,{xs:12,md:8,lg:6,xl:4,className:"align-self-md-center",style:{position:"relative"},children:$})})]})})},$n=t(87532),An=t.n($n),Bn=t(80151),Un=t(35005),Ln=function(e){var n=e.dismissWarning;return(0,i.jsx)(rn.Z,{className:"justify-content-md-center vh-100",children:(0,i.jsx)(tn.Z,{xs:"8",md:"6",className:"align-self-center",children:(0,i.jsxs)(Bn.Z,{className:An().intro,children:[(0,i.jsx)("h2",{className:"title",children:"Uh Oh! (Failed to Access Webcam Audio or Video)"}),(0,i.jsx)("p",{children:"Your browser is unable to access your camera or microphone. You may still enter Arium, but other guests will not be able to see or hear you. To fix this, please do the following: grant this site permission to use your microphone and camera, turn off any ad-blockers you use, and reload the page."}),(0,i.jsx)("div",{id:"enter-button-container",children:(0,i.jsx)(Un.Z,{variant:"primary",onClick:n,className:"enter-button",children:"Dismiss"})})]})})})},Fn=t(41664),Rn=t.n(Fn),On=t(23002),zn=t.n(On),Wn=t(53450),Vn=s.memo((function(){return(0,i.jsxs)("div",{className:zn().legalLinks,children:[(0,i.jsx)(Rn(),{href:"/privacy",children:"Privacy Policy"}),(0,i.jsx)(Rn(),{href:"/terms",children:"Terms of Service"}),(0,i.jsx)(Wn.Z,{mdUp:!0,children:(0,i.jsx)("br",{})}),"\xa92021 Arium Virtual Technologies Inc."]})})),Xn=function(e){var n=e.initialize,t=e.initialized,r=e.spaceId,a=e.enterSpace,o=e.userMedia,c=e.profileSetter,u=e.setKeyboardControlsDisabled,l=e.spaceMetadata,d=e.eventSlug,f=e.spaceSlug,p=e.inviteId,m=e.isAnonymous,h=e.userId,v=(0,s.useState)(!1),x=v[0],g=v[1],b=(0,s.useCallback)((function(){g(!0)}),[g]),_=o.webcam.failedGettingStream,j=o.mic.failedGettingStream,y=o.refreshAvailableDevices;return(0,s.useEffect)((function(){y()}),[y,o.mic.sendingDeviceId,o.webcam.sendingDeviceId]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:An().userInterface,children:(0,i.jsxs)("div",{className:An().onboarding,children:[(j||_)&&!x&&(0,i.jsx)(Ln,{dismissWarning:b}),(0,i.jsx)(Dn,{spaceId:r,inviteId:p,enterSpace:a,mediaDevices:o,setKeyboardControlsDisabled:u,profileSetter:c,initialize:n,initialized:t,spaceMetadata:l,eventSlug:d,spaceSlug:f,isAnonymous:m,userId:h})]})}),(0,i.jsx)("div",{className:An().legalLinksContainer,children:(0,i.jsx)(Vn,{})})]})},Kn=t(36277),Yn=t(82492),Gn=t.n(Yn),Hn=function(e){var n=e.spaceId,t=e.controlSettingsFromProps,r=(0,s.useState)(),a=r[0],i=r[1],o=(0,s.useState)(!1),c=o[0],u=o[1],l=(0,Q.sT)(a,J.E8);return(0,s.useEffect)((function(){if(n){var e=(0,jn.KX)(n).onSnapshot((function(e){e.exists&&i(e.data())}));return function(){return e()}}}),[n]),{setKeyboardControlsDisabled:u,controlsSettings:(0,s.useMemo)((function(){return Gn()({},l,{disableKeyboardControls:c},t)}),[t,l,c])}},qn=t(56527),Qn=t(18127),Jn=t(11163),et=t(1173),nt=t(23917),tt=t(52741),rt=t(20264),at=t(22807),it=function(e){var n=e.spaceId$,t=e.kind;return n.pipe((0,w.w)((function(e){if(e){var n=A.vM.ref(B({spaceId:e,kind:t}));return new ce.y((function(e){var t=function(n){var t=n.key,r=n.val().paused;e.next({peerId:t,paused:r})};return n.on("child_added",t),n.on("child_changed",t),n.on("child_removed",(function(n){var t=n.key,r=n.val().paused;e.next({peerId:t,paused:r})})),function(){n.off("child_added"),n.off("child_changed"),n.off("child_removed")}})).pipe((0,rt.e)(250),(0,E.h)((function(e){return e.length>0})),(0,at.R)((function(e,n){return n.forEach((function(n){n.paused?e.delete(n.peerId):e.add(n.peerId)})),e}),new Set))}return(0,x.D)([new Set])})))};var st=t(69327),ot=t(57027),ct={video:{cursor:"always"},audio:{sampleRate:44100,sampleSize:16,channelCount:2,echoCancellation:!0}};var ut=function(){var e=(0,c.Z)(l().mark((function e(){var n,t,r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,navigator.mediaDevices.getDisplayMedia(ct);case 4:n=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),console.error(e.t0),e.abrupt("return",void 0);case 11:if(n){e.next=13;break}return e.abrupt("return",void 0);case 13:return t=n.getVideoTracks()[0],r=n.getAudioTracks()[0],e.abrupt("return",{videoTrack:t,audioTrack:r,stream:n});case 16:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),lt=function(e){var n=e.producingTransport$,t=e.sessionPaths$,i=e.spaceId$,o=(0,s.useState)(),u=o[0],d=o[1],f=(0,s.useCallback)((0,c.Z)(l().mark((function e(){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ut();case 2:n=e.sent,d(n);case 4:case"end":return e.stop()}}),e)}))),[]);(0,s.useEffect)((function(){if(null===u||void 0===u?void 0:u.audioTrack){var e=(0,ot.R)(u.audioTrack,"ended").subscribe({next:function(){d((function(e){if(e)return(0,a.Z)((0,r.Z)({},e),{audioTrack:void 0})}))}});return function(){return e.unsubscribe()}}}),[null===u||void 0===u?void 0:u.audioTrack]),(0,s.useEffect)((function(){if(null===u||void 0===u?void 0:u.videoTrack){var e=(0,ot.R)(u.videoTrack,"ended").subscribe({next:function(){d((function(e){if(e)return(0,a.Z)((0,r.Z)({},e),{videoTrack:void 0})}))}});return function(){return e.unsubscribe()}}}),[null===u||void 0===u?void 0:u.videoTrack]);var m=(0,s.useState)((function(){return new v.X(!0)}))[0],h=(0,p.j7)(null===u||void 0===u?void 0:u.videoTrack),x=(0,p.j7)(null===u||void 0===u?void 0:u.audioTrack);z({producingTransport$:n,track$:h,enteredSpace$:m,kind:"screenVideo",sessionPaths$:t,spaceId$:i,userMediaPaused:!(null===u||void 0===u?void 0:u.videoTrack)}),z({producingTransport$:n,track$:x,enteredSpace$:m,kind:"screenAudio",sessionPaths$:t,spaceId$:i,userMediaPaused:!(null===u||void 0===u?void 0:u.audioTrack)});var g=function(e){var n=(0,s.useState)(),t=n[0],r=n[1];return(0,s.useEffect)((function(){if(e){if(t)return void(t.srcObject!==e&&(t.srcObject=e,t.play()));var n=(0,st.He)({stream:e,mute:!0});(0,c.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.play();case 2:r(n);case 3:case"end":return e.stop()}}),e)})))()}else if(t)return t.pause(),void(t.srcObject=null)}),[e,t]),t}(null===u||void 0===u?void 0:u.stream),b=(0,p.j7)(g);return{capture:f,sharing$:(0,p.j7)(!!(null===u||void 0===u?void 0:u.videoTrack)||!!(null===u||void 0===u?void 0:u.audioTrack)),videoElement$:b}},dt=t(69464),ft=function(e){var n=e.userId,t=e.attemptedToJoin,r=(0,dt.Z)(t?n:void 0);(0,s.useEffect)((function(){r&&window.location.reload()}),[r,t])},pt=t(89281),mt=t(19514),ht=t(5152),vt=t.n(ht)()((function(){return Promise.all([t.e(1193),t.e(5587)]).then(t.bind(t,75587))}),{loadableGenerated:{webpack:function(){return[75587]}}}),xt=function(e){var n=e.authState,t=e.spaceSlugFromPath,c=e.spaceId,u=e.externalVideo,l=e.initialX,d=e.initialY,f=e.initialZ,m=e.initialLookAtX,x=e.initialLookAtY,b=e.initialLookAtZ,j=e.render,y=void 0===j||j,w=e.controlsSettings,C=e.invisible,I=e.UserInterface,k=e.peerMetadata,P=e.videoResolution,T=void 0===P?"qvga":P,N=e.micQuality,M=void 0===N?"sd":N,$=e.autoEnter,B=e.muted,U=e.fullScreen,L=void 0===U||U,R=e.disableChat,O=void 0!==R&&R,z=e.disableUserMediaControls,W=void 0!==z&&z,V=e.autoInitialize,X=void 0!==V&&V,K=e.spaceMetadata,Y=e.documentation,G=void 0!==Y&&Y,H=e.hideUI,ce=e.eventSlug,ue=e.spaceSlug,de=e.canEdit,fe=e.playerLocation$,pe=e.updatePlayerLocation,me=e.inviteId,he=n.userId,ve=n.authenticated,be=n.user,_e=(0,p.j7)(n.authenticated),Ce=(0,p.j7)(c),ke=(0,s.useContext)(Ee.f),Me=!!(null===ke||void 0===ke?void 0:ke.editor)||!!(null===ke||void 0===ke?void 0:ke.isAdmin),De=!!(null===ke||void 0===ke?void 0:ke.owner),$e=!!(null===ke||void 0===ke?void 0:ke.editor);(0,s.useEffect)((function(){return document.body.className=Ie().spaceBody,function(){document.body.className=""}}),[]);var Ae=(0,s.useState)(),Be=Ae[0],Ue=Ae[1],Le=(0,s.useCallback)((function(e){Ue(e)}),[]),Fe=(0,s.useState)(X),Re=Fe[0],Oe=Fe[1],ze=(0,p.j7)(Re),We=(0,s.useState)((function(){return new v.X(!1)}))[0],Ve=(0,p.dO)(We);(0,s.useEffect)((function(){$&&(Oe(!0),We.next(!0))}),[$,Re,We]);var Xe=function(e){var n=e.authenticated,t=e.spaceId,r=(0,s.useState)(),a=r[0],i=r[1];return(0,s.useEffect)((function(){if(n&&t){var e=A.h.collection("spaces").doc(t).onSnapshot((function(e){i(e.data())}));return function(){e()}}}),[t,n]),a}({authenticated:ve,spaceId:c}),Ye=(0,s.useMemo)((function(){return!!(null===Xe||void 0===Xe?void 0:Xe.disableChat)||!!O}),[O,null===Xe||void 0===Xe?void 0:Xe.disableChat]),Ge=(0,s.useMemo)((function(){return!!(null===Xe||void 0===Xe?void 0:Xe.disableUserMediaControls)||!!W}),[W,null===Xe||void 0===Xe?void 0:Xe.disableUserMediaControls]),He=(0,s.useCallback)((function(){We.next(!0)}),[We]);!function(e){(0,s.useEffect)((function(){var n=setInterval((function(){void 0!==window.gtag&&qn.B({action:"active",category:"Space Events",label:e||"",value:1})}),3e4);return function(){clearInterval(n)}}),[e])}(c);var qe=(0,p.j7)(he),Qe=je({userId$:qe,spaceId$:Ce,initialized$:ze,enteredSpace$:We,authenticated:n.authenticated}),nn=Qe.sessionId$,tn=Qe.routerId$,rn=Qe.joinStatus$;ft({userId:n.userId,attemptedToJoin:Re});var an=(0,p.Hq)(rn,void 0),sn=(0,p.Hq)(nn,void 0);(0,ne.vI)({invisible:C,authenticated:ve,sessionId:sn,userId:he,spaceId:c});var on=(0,te.AQ)({userId$:qe,sessionId$:nn,spaceId$:Ce,intialMetadata:k}),cn=on.metadata,un=on.setMetadata,ln=(0,Qn.Gr)(be),dn=(0,p.j7)(null===ln||void 0===ln?void 0:ln.displayName),fn=(0,Qn.UK)({userProfile:ln,userId:null===be||void 0===be?void 0:be.uid,setPeerMetadata:un}),pn=Hn({spaceId:c,controlSettingsFromProps:w}),mn=pn.controlsSettings,hn=pn.setKeyboardControlsDisabled,vn=(0,Q.G$)(Xe,J.DC),xn=ae({sessionId:sn,userId:he,authenticated:ve}),gn=(0,ye.G)({initialized$:ze,muted:B}),bn=gn.listener$,_n=gn.audioContext$,jn=(0,p.Hq)(_n,void 0),yn=function(e){var n=e.routerId$,t=e.sessionPaths$,r=(0,s.useState)(new v.X(void 0))[0],a=(0,s.useState)(new v.X(void 0))[0],i=(0,s.useState)(new v.X(void 0))[0],o=(0,p.Qy)(),c=(0,s.useState)(new v.X(void 0))[0];return(0,s.useEffect)((function(){xe(n).pipe(o()).subscribe(c)}),[c,n,o]),(0,s.useEffect)((function(){(0,g.aj)([c.pipe((0,D.YU)()),t.pipe((0,D.YU)())]).pipe(o()).subscribe({next:function(e){var n=(0,h.Z)(e,2),t=n[0],r=n[1];!function(e,n){n.communicatonCollection().doc("clientRtpCapabilities").set(e)}(t.rtpCapabilities,r)}})}),[c,t,o]),(0,s.useEffect)((function(){ge({mediasoupDevice$:c,sessionPaths:t}).pipe(o(),(0,S.b)((function(e){e&&le(e.kind||"")("created")}))).subscribe(r)}),[t,r,o,c]),(0,s.useEffect)((function(){r.pipe(o(),(0,D.YU)(),(0,E.h)((function(e){return"consuming"===e.kind})),(0,_.U)((function(e){return e.transport}))).subscribe(i)}),[i,o,r]),(0,s.useEffect)((function(){r.pipe(o(),(0,D.YU)(),(0,E.h)((function(e){return"producing"===e.kind})),(0,_.U)((function(e){var n=e.transport,t=e.device;return{transport:n,canProduce:function(e){return t.canProduce(e)}}}))).subscribe(a)}),[a,o,r]),(0,s.useEffect)((function(){i.pipe((0,Z.G)(),o()).subscribe({next:function(e){var n=(0,h.Z)(e,1)[0];n&&(F()("transport:consumer:close")({}),n.close())}})}),[i,o]),(0,s.useEffect)((function(){a.pipe((0,Z.G)(),o()).subscribe({next:function(e){var n=(0,h.Z)(e,1)[0];n&&(F()("transport:producer:close")({}),n.transport.close())}})}),[a,o]),(0,s.useMemo)((function(){return{producer:a,consumer:i}}),[a,i])}({sessionPaths$:xn,routerId$:tn}),Sn=yn.producer,wn=yn.consumer,Cn=(0,p.j7)(Ve),In=q({initialized:Re,invisible:C,videoResolution:T,micQuality:M,useExternalVideo:!!u,externalVideoElement:Be,sessionPaths$:xn,producingTransport$:Sn,produce$:Cn,spaceId$:Ce}),kn=lt({producingTransport$:Sn,sessionPaths$:xn,spaceId$:Ce}),Zn=In.grantAccessRequestForWebcamAndMic,Pn=(0,s.useCallback)((function(e){e||Zn(),Oe(!0)}),[Zn]);(0,ee.ZP)({spaceId$:Ce,userId$:qe,sessionId$:nn,invisible:C,enteredSpace$:Cn,playerLocation$:fe});var Tn=(0,en.Z)(),Nn=(0,ne.ZP)({spaceId$:Ce,sessionId$:nn,serverTimeOffset$:Tn}),En=(0,ie.wP)({spaceId$:Ce,sessionId$:nn,activeSessions$:Nn}),Mn=(0,se.Z)({canManuallyBroadcast:de,activePresence$:Nn,sessionId$:nn,spaceId$:Ce,userId$:qe}),Dn=Mn.broadcasters$,$n=Mn.controls,An=oe({spaceSettings:vn}).peersSettings$;Ne({spaceId:c,spaceSlug:ue,eventSlug:ce,enteredSpace:Ve,userInfo:{user:be||void 0,authenticated:ve,owner:De,editor:$e},metadata:cn});var Bn=(0,ie.UT)({playerLocation$:fe,activeSessions$:Nn,peerPositions$:En,broadcastingPeers$:Dn,peersSettings$:An}),Un=Bn.distancesByPeer$,Ln=Bn.allVisiblePeers$,Fn=Bn.peersToSee$,Rn=Bn.peersToHear$,On=function(e){var n=e.spaceId$,t=(0,s.useState)((function(){return new v.X(new Set)}))[0],r=(0,s.useState)((function(){return new v.X(new Set)}))[0];return(0,s.useEffect)((function(){var e=[it({spaceId$:n,kind:"webcamVideo"}).subscribe(t),it({spaceId$:n,kind:"webcamAudio"}).subscribe(r)];return function(){return e.forEach((function(e){return e.unsubscribe()}))}}),[r,n,t]),{webcamVideo:t,webcamAudio:r}}({spaceId$:Ce}),zn=(0,s.useState)(new re.xQ)[0],Wn=we({initialized:Re});(0,Se.S)({authenticated$:_e,consumers$:zn,broadcasters$:Dn,distancesByPeer$:Un,enableSpatialAudio:Wn,peerPositions$:En,listener$:bn,spaceId$:Ce});var Vn=(0,st.O0)({consumerTransport$:wn,consumers$:zn,sessionPaths$:xn,enteredSpace$:Cn});!function(e){var n=e.sessionId$,t=e.userId$,r=(0,s.useState)((function(){return new v.X(Ze())}))[0],a=(0,p.Qy)();(0,s.useEffect)((function(){window.addEventListener("resize",(function(){r.next(Ze())}));var e=r.pipe((0,_.U)((function(e){if("undefined"!==typeof e)return"string"===typeof e?Pe[e]:e})));(0,g.aj)([e.pipe((0,D.YU)()),n.pipe((0,D.YU)()),t.pipe((0,D.YU)())]).pipe(a()).subscribe({next:function(e){var n=(0,h.Z)(e,3),t=n[0],r=n[1],a=n[2];A.Yo.ref("userDeviceOrientations/".concat(r)).set({userId:a,orientation:t})}})}),[r,n,a,t])}({sessionId$:nn,userId$:qe});var Yn=(0,s.useRef)(),Gn=(0,s.useCallback)((function(e){Yn.current=e}),[]),rt=(0,s.useState)(null),at=rt[0],ot=rt[1],ct=(0,Kn.c)(),ut=(0,nt.Z)({spaceId:c,documentationMode:G}),dt=(0,tt.y0)(ut),ht=(0,et.a)({audioContext:jn,audioStream:In.mic.sendingStream,selfMetadata$:fn.metaDataWithUpdates$,videoPaused:In.webcam.paused,videoTrack:In.webcam.sendingStream}),xt=(0,te.fG)({spaceId:c}),gt=(0,Jn.useRouter)(),bt=(0,a.Z)((0,r.Z)({},ct),{serverTimeOffset$:Tn,initialized$:ze,spaceSettings:Xe,router:gt,spaceSlugFromPath:t,spaceSlug:ue,activeSessions$:Nn,consumers$:Vn,interactable:Ve,listener$:bn,sessionPaths$:xn,spatialAudioEnabled:Wn,transports$:yn,spaceId:c,selfAvatar:ht,theme$:ut,avatarMeshes:dt,screenSharing:kn,canEdit:de,peersMetadata:xt,audioContext:jn}),_t=(0,mt.T)(),jt=_t.fullyLoaded,yt=_t.elementsLoadedProgress,St=_t.setElementLoadedProgress,wt=(0,s.useMemo)((function(){return["d1enbo"].includes(c.toLowerCase())}),[c]),Ct=c&&(0,i.jsx)(o.ZP,{spaceId:c,updatePlayerLocation:pe,playerLocation$:fe,sessionId:sn,visiblePeersSortedByDistance$:Ln,peersSettings$:An,peerLocations$:En,spaceId$:Ce,sessionId$:nn,render:y,initialX:l,initialY:d,initialZ:f,initialLookAtX:m,initialLookAtY:x,initialLookAtZ:b,controlsSettings:mn,userId:he,enteredSpace:Ve,joystickMoveRef:Yn,documentation:G,loadingComplete:jt,setLoadedProgress:St,peerConsumers:{peersToHear$:Rn,peersToSee$:Fn,producingPeers:On}});return(0,i.jsxs)(i.Fragment,{children:[jt&&Ve&&wt&&(0,i.jsx)(vt,{}),!jt&&Ve&&(0,i.jsx)(pt.K,{showProgress:!0,progress:yt,hint:"loading scene"}),(0,i.jsx)("div",{ref:ot,className:Ie().spaceWrapper,children:(0,i.jsxs)(Kn.u.Provider,{value:bt,children:[!Ct&&(0,i.jsx)(Te.u,{}),!Ye&&Ve&&ve&&!G&&(0,i.jsx)("div",{className:(0,Ke.default)(H&&Ie().opacityZero),children:(0,i.jsx)(Je,{userName$:dn,spaceId$:Ce,userId$:qe,sessionId$:nn,serverTimeOffset$:Tn})}),!Ve&&(0,i.jsx)(Xn,{spaceId:c,userMedia:In,initialize:Pn,initialized:Re,enterSpace:He,setKeyboardControlsDisabled:hn,spaceMetadata:K,profileSetter:fn,eventSlug:ce,spaceSlug:ue,inviteId:me,isAnonymous:n.isAnonymous,userId:n.userId}),I&&Ve&&!G&&jt&&(0,i.jsx)("div",{className:(0,Ke.default)(H&&Ie().opacityZero),children:(0,i.jsx)(I,{userMedia:In,audioContext:jn,setKeyboardControlsDisabled:hn,joystickMove:Gn,joinStatus:an,fullScreenElement:at,spaceId:c,user:be||void 0,profileSetter:fn,broadcasting:$n,disableUserMediaControls:Ge,canInviteToEdit:Me,spaceSlug:ue,playerLocation$:fe})}),L&&(0,i.jsx)("div",{className:Ie().space,children:(0,i.jsx)("div",{className:(Ie().sceneContainer,Ie().fullScreenContainer),children:Ct})}),!L&&Ct,u&&Re&&(0,i.jsx)("video",{crossOrigin:"anonymous",src:u,ref:Le,controls:!0,loop:!0,playsInline:!0,autoPlay:!0})]})})]})}},80749:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return et}});var r,a=t(47568),i=t(26042),s=t(69396),o=t(10253),c=t(34051),u=t.n(c),l=t(85893),d=t(66089),f=t.n(d),p=t(67294),m=t(45262),h=t(86010),v=t(58148),x=t.n(v),g=t(78523),b=t(14924),_=t(99534),j=t(10682),y=t(868),S=t(35735),w=(0,p.memo)((function(e){var n=e.resumeText,t=e.pauseText,r=e.offIcon,a=e.onIcon,i=e.onStatus,s=e.off,o=e.toggle,c=e.alertColorWhenOn,u=(0,p.useCallback)((function(e){(0,S.w)(e),o()}),[o]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(y.ZP,{title:s?n:t,placement:"top",children:(0,l.jsx)("button",{className:(0,h.default)(s?x().resumeButton:x().pauseButton,(0,b.Z)({},x().alertButtonOn,!s&&c)),onClick:u,children:s?r:a})}),!s&&i]})})),C=t(95394),I=t(22742),k=t(65031),Z=t(1161),P=t(8884),T=t(34044),N=t(9969),E=t(57118),M=t(96977),D=t(78551),$=t(31555),A=t(21608),B=t(51438),U=t(28668),L=t(91224),F=t(99498);!function(e){e.MouseDown="mousedown",e.MouseMove="mousemove",e.MouseUp="mouseup",e.TouchStart="touchstart",e.TouchMove="touchmove",e.TouchEnd="touchend"}(r||(r={}));var R=64,O=128,z=function(e){var n=e.rotation;return(0,l.jsx)("g",{transform:"rotate(".concat(n," ").concat(R," ").concat(R,") translate(").concat(56," 10)"),children:(0,l.jsx)("polygon",{points:"0,".concat(8," ").concat(8,",0 ").concat(16,",").concat(8),fill:"#FFFFF1"})})},W=p.memo((function(){return(0,l.jsxs)("svg",{width:O,height:O,viewBox:"0 0 ".concat(O," ").concat(O),fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,l.jsx)("circle",{opacity:"0.2",cx:R,cy:R,r:63,fill:"#FFFFF1",stroke:"white"}),(0,l.jsx)(z,{rotation:0}),(0,l.jsx)(z,{rotation:90}),(0,l.jsx)(z,{rotation:180}),(0,l.jsx)(z,{rotation:270})]})})),V=function(e){(0,U.Z)(t,e);var n=(0,L.Z)(t);function t(e){var r;return(0,B.Z)(this,t),(r=n.call(this,e)).state={dragging:!1},r._trackedTouchRef=p.createRef(),r._stickRef=p.createRef(),r._baseRef=p.createRef(),r._baseSize=e.size||100,r._throttleMoveCallback=function(){var e=0;return function(n){var t=(new Date).getTime(),a=r.props.throttle||0;if(!(t-e<a))return e=t,r.props.move?r.props.move(n):void 0}}(),r._boundMouseUp=function(e){r._mouseUp(e)},r._boundMouseMove=function(e){r._mouseMove(e)},r}var a=t.prototype;return a._updatePos=function(e){var n=this;window.requestAnimationFrame((function(){n.setState({coordinates:e})})),this._throttleMoveCallback({type:"move",x:e.relativeX,y:-e.relativeY,direction:e.direction})},a._mouseDown=function(e){if(!0!==this.props.disabled){if(this._parentRect=this._baseRef.current.getBoundingClientRect(),this.setState({dragging:!0}),e.type===r.MouseDown)window.addEventListener(r.MouseUp,this._boundMouseUp),window.addEventListener(r.MouseMove,this._boundMouseMove);else{var n=e;this._trackedTouchRef.current=n.changedTouches[0],window.addEventListener(r.TouchEnd,this._boundMouseUp),window.addEventListener(r.TouchMove,this._boundMouseMove)}this.props.start&&this.props.start({type:"start",x:null,y:null,direction:null})}},a._getDirection=function(e){return e>2.35619449||e<-2.35619449?"FORWARD":e<2.35619449&&e>.785398163?"RIGHT":e<-.785398163?"LEFT":"BACKWARD"},a._getWithinBounds=function(e){var n=this._baseSize/2;return e>n?n:e<-n?-1*n:e},a._mouseMove=function(e){if(this.state.dragging){var n=null,t=null;if(e.type===r.MouseMove)n=e.clientX,t=e.clientY;else{if(!this._trackedTouchRef.current)return;var a=e,i=(0,F.KY)(a.changedTouches,this._trackedTouchRef.current);if(!i)return;n=i.clientX,t=i.clientY}var s=this._getWithinBounds(n-this._parentRect.left-this._baseSize/2),o=this._getWithinBounds(t-this._parentRect.top-this._baseSize/2),c=Math.atan2(s,o);this._updatePos({relativeX:s,relativeY:o,direction:this._getDirection(c),axisX:n-this._parentRect.left,axisY:t-this._parentRect.top})}},a._mouseUp=function(e){if(this._trackedTouchRef.current&&"touchend"===e.type){var n=e;if(!(0,F.KY)(n.changedTouches,this._trackedTouchRef.current))return}this.setState({dragging:!1,coordinates:void 0}),window.removeEventListener("mouseup",this._boundMouseUp),window.removeEventListener("mousemove",this._boundMouseMove),this.props.stop&&this.props.stop({type:"stop",x:null,y:null,direction:null})},a._getBaseStyle=function(){var e="".concat(this._baseSize,"px");return{height:e,width:e,borderRadius:this._baseSize,display:"flex",justifyContent:"center",alignItems:"center",position:"relative",cursor:"move",zIndex:5e3}},a._getStickStyle=function(){var e=void 0!==this.props.stickColor?this.props.stickColor:"#3D59AB",n="".concat(R,"px"),t={background:e,cursor:"move",height:n,width:n,borderRadius:this._baseSize,flexShrink:0};return this.state.dragging&&void 0!==this.state.coordinates&&(t=Object.assign({},t,{position:"absolute",transform:"translate3d(".concat(this.state.coordinates.relativeX,"px, ").concat(this.state.coordinates.relativeY,"px, 0)")})),t},a.render=function(){var e=this._getBaseStyle(),n=this._getStickStyle();return(0,l.jsxs)("div",{className:this.props.disabled?"joystick-base-disabled":"",onMouseDown:this._mouseDown.bind(this),onTouchStart:this._mouseDown.bind(this),ref:this._baseRef,style:e,children:[(0,l.jsx)("div",{style:{position:"absolute"},children:(0,l.jsx)(W,{})}),(0,l.jsx)("div",{ref:this._stickRef,className:this.props.disabled?"joystick-disabled":"",style:n})]})},t}(p.Component),X=t(89445),K=function(e){var n=e.joystickMove,t=(0,p.useCallback)((function(){n({type:"stop",x:null,y:null,direction:null})}),[n]);return(0,l.jsx)(V,{baseColor:X.Fv,stickColor:X.Fv,move:n,stop:t,size:64})},Y=t(14615),G=t(72328),H=t(27178),q=t(43910),Q=function(e){var n=e.displayTimeout,t=void 0===n?3e4:n,r=(0,p.useState)(!0),a=r[0],i=r[1];return(0,p.useEffect)((function(){var e=setTimeout((function(){i(!1)}),t);return function(){clearTimeout(e)}}),[t]),a?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)($.Z,{className:"align-items-center",style:{height:"100%"},children:(0,l.jsxs)(A.Z,{className:(0,h.default)(x().instructions,"align-items-center mx-auto"),children:[(0,l.jsx)($.Z,{xs:4,children:(0,l.jsx)("img",{src:"/images/icons/small-keys-icon.svg",alt:"computer arrow keys"})}),(0,l.jsxs)($.Z,{xs:8,className:(0,h.default)(x().instructionsText),children:[(0,l.jsx)("strong",{children:"Move"}),(0,l.jsx)("br",{})," WASD keys"]})]})}),(0,l.jsx)($.Z,{className:"align-items-center",style:{height:"100%"},children:(0,l.jsxs)(A.Z,{className:(0,h.default)(x().instructions,"align-items-center mx-auto"),children:[(0,l.jsx)($.Z,{xs:4,children:(0,l.jsx)("img",{src:"/images/icons/click-and-drag-icon.svg",alt:"computer mouse icon"})}),(0,l.jsxs)($.Z,{xs:8,className:(0,h.default)(x().instructionsText),children:[(0,l.jsx)("strong",{children:"Look"}),(0,l.jsx)("br",{})," Click & Drag"]})]})})]}):null},J=function(e){var n=e.broadcasting,t=(e.canManuallyBroadcast,e.toggleBroadcasting);return(0,l.jsx)(w,{off:!n,resumeText:"Not Broadcasting, Click to Broadcast",pauseText:"Broadcasting",toggle:t,offIcon:(0,l.jsx)(P.Z,{className:x().icon}),onIcon:(0,l.jsx)(T.Z,{className:(0,h.default)(x().icon)}),alertColorWhenOn:!0,onStatus:(0,l.jsx)(y.ZP,{title:"When you are broadcasting, everyone in the space can hear you, regardless of how far they are from you.",children:(0,l.jsx)(l.Fragment,{})})},"broadcasting")},ee=(0,p.memo)((function(e){var n=e.userMedia,t=(0,_.Z)(e,["userMedia"]),r=n.paused,a=n.pause,o=n.resume,c=(0,p.useCallback)((function(){r?o():a()}),[r,a,o]);return(0,l.jsx)(w,(0,s.Z)((0,i.Z)({},t),{off:r,toggle:c}))})),ne=function(e){e.mediaDevices;var n=e.handleOpenSettings;return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(y.ZP,{title:"Device Settings",placement:"top",children:(0,l.jsx)("button",{className:x().settingsButton,onClick:n,children:(0,l.jsx)(N.Z,{})})})})},te=function(e){var n=e.children;return(0,l.jsx)("div",{className:"mx-md-1 my-md-1",children:n})},re=function(e){var n=e.fullScreenElement,t=(0,H.p0)(n),r=t.isFullScreen,a=t.toggleFullScreen;return(0,l.jsx)(y.ZP,{title:r?"Exit Fullscreen":"Enter Fullscreen",placement:"top",children:(0,l.jsxs)("button",{className:x().settingsButton,onClick:a,children:[r&&(0,l.jsx)(M.Z,{}),!r&&(0,l.jsx)(E.Z,{})]})})},ae=function(e){var n=e.open;return(0,l.jsx)(y.ZP,{title:"Share",placement:"top",children:(0,l.jsxs)("button",{className:x().shareButton,onClick:n,children:["share ",(0,l.jsx)(q.Z,{})]})})},ie=function(e){var n=e.captureScreenshot;return n?(0,l.jsx)(y.ZP,{title:"Capture Screenshot",placement:"top",children:(0,l.jsx)("button",{className:x().settingsButton,onClick:n,children:(0,l.jsx)(D.Z,{})})}):null},se=function(e){var n=e.broadcasting,t=e.userMedia,r=e.handleOpenSettings,a=e.fullScreenElement,s=e.openShareDialog,o=e.captureScreenshot;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(te,{children:(0,l.jsx)(ee,{resumeText:"Webcam Off",pauseText:"Webcam On",userMedia:t.webcam,offIcon:(0,l.jsx)(I.Z,{className:x().icon}),onIcon:(0,l.jsx)(C.Z,{className:x().icon})})},"webcam"),(0,l.jsx)(te,{children:(0,l.jsx)(ee,{resumeText:"Microphone Off",pauseText:"Microphone On",userMedia:t.mic,offIcon:(0,l.jsx)(Z.Z,{className:x().icon}),onIcon:(0,l.jsx)(k.Z,{className:x().icon})})},"mic"),n.canManuallyBroadcast&&(0,l.jsx)(te,{children:(0,l.jsx)(J,(0,i.Z)({},n))},"broadcast"),(0,l.jsx)(te,{children:(0,l.jsx)(ne,{mediaDevices:t,handleOpenSettings:r})},"settings"),(0,l.jsx)(te,{children:(0,l.jsx)(re,{fullScreenElement:a})},"fullScreen"),(0,l.jsx)(te,{children:(0,l.jsx)(ie,{captureScreenshot:o})},"captureScreenshot"),(0,l.jsx)(te,{children:(0,l.jsx)(ae,{open:s})},"share")]})},oe={},ce=(0,p.memo)((function(e){var n=e.joystickMove,t=e.openProfileModule,r=e.peerMetadata$,a=e.sidebarOpen,o=e.disableUserMediaControls,c=e.hide,u=(0,_.Z)(e,["joystickMove","openProfileModule","peerMetadata$","sidebarOpen","disableUserMediaControls","hide"]),d=(0,p.useMemo)((function(){return{joystick:{xs:6,lg:4},footerControls:{},instructions:{lg:4},selfView:{xs:6,lg:4}}}),[]),f=(0,G.Hq)(r,oe);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j.Z,{fluid:!0,className:(0,h.default)(x().bottomBar,x().bottomBarOffset,"p-0 m-0 fixed-bottom"),children:(0,l.jsxs)(A.Z,{className:(0,h.default)((0,b.Z)({},x().hidden,c)),children:[(0,l.jsx)($.Z,(0,s.Z)((0,i.Z)({},d.joystick),{className:(0,h.default)(x().joystickWrapper,x().footerControlsCol,"align-items-center"),children:(0,l.jsx)(A.Z,{className:(0,h.default)(x().joystickContainer,"justify-content-start align-self-center align-items-center"),children:!a&&(0,l.jsx)(K,{joystickMove:n})})})),(0,l.jsx)($.Z,(0,s.Z)((0,i.Z)({},d.instructions),{className:(0,h.default)("align-self-center d-none d-lg-block  align-items-center",x().footerControlsCol),children:(0,l.jsx)(A.Z,{className:"justify-content-center",children:(0,l.jsx)(Q,{})})})),(0,l.jsx)($.Z,(0,s.Z)((0,i.Z)({},d.selfView),{className:(0,h.default)(x().videoContainer,x().clickable,x().footerControlsCol,"justify-content-md-end align-items-end"),children:(0,l.jsx)(A.Z,{className:"justify-content-sm-end align-items-end",children:(0,l.jsx)("div",{className:(0,h.default)(x().mainControlsVideoContainer),children:(0,l.jsx)("div",{className:(0,h.default)(x().mainControlsVideoElement,x().mainControlsVideo),onClick:t,children:(0,l.jsx)(Y.Z,{peerMetadata:f})})})})}))]})}),(0,l.jsx)(j.Z,{fluid:!0,className:(0,h.default)(x().bottomBar,"p-0 m-0 fixed-bottom"),children:(0,l.jsx)(A.Z,{className:"d-flex justify-content-center",children:(0,l.jsx)($.Z,{xs:12,sm:8,className:(0,h.default)(x().clickable,"d-flex align-items-end justify-content-center py-3"),children:!o&&(0,l.jsx)(A.Z,{children:(0,l.jsx)(se,(0,i.Z)({},u))})})})})]})})),ue=t(5152),le=t.n(ue),de=t(8396),fe=t(60668),pe=t(87532),me=t.n(pe),he=function(e){var n=e.children;return(0,l.jsx)("div",{className:me().userInterface,children:(0,l.jsx)("div",{className:me().onboarding,children:(0,l.jsx)(j.Z,{fluid:!0,className:(0,h.default)(me().container,"vh-100 mx-0 px-0"),children:(0,l.jsx)($.Z,{className:"vh-100 mx-0 px-0",children:(0,l.jsx)(A.Z,{className:"justify-content-center vh-100 mx-0 px-0",children:(0,l.jsx)($.Z,{xs:12,md:8,lg:6,xl:4,className:"align-self-md-center",style:{position:"relative"},children:n})})})})})})},ve=t(1549),xe=t(41749),ge=t(282),be=t(22318),_e=t(55517),je=t(72841),ye=t.n(je),Se=t(11390),we=t(7397),Ce=t(17812),Ie=t(38799),ke=t(66081),Ze=t(80797),Pe=t(30553),Te=t(25120),Ne=t(51549),Ee=t(81534),Me=t(37250),De=t(98268),$e=function(e){var n=e.spaceSlug,t=e.shareAtLocation,r=e.playerLocation,a=window.location.hostname,i=window.location.protocol,s=t&&r?function(e){var n=[[m.M.x,(0,Te.W0)(e.position[0],1).toString()],[m.M.y,(0,Te.W0)(e.position[1]+3,1).toString()],[m.M.z,(0,Te.W0)(e.position[2],1).toString()],[m.M.lx,(0,Te.W0)(e.lookAt[0],2).toString()],[m.M.ly,(0,Te.W0)(e.lookAt[1],2).toString()],[m.M.lz,(0,Te.W0)(e.lookAt[2],2).toString()]];return"?".concat(n.map((function(e){return e.join("=")})).join("&"))}(r):"";return{url:"".concat(i,"//").concat(a,"/spaces/").concat(n).concat(s),text:"".concat(a,"/spaces/").concat(n).concat(s)}},Ae=function(e){var n=e.spaceSlug,t=e.playerLocation$,r=(0,p.useState)(!1),a=r[0],i=r[1],s=(0,o.Z)(p.useState(null),2),c=s[0],u=s[1],d=(0,p.useState)(!1),f=d[0],m=d[1],h=(0,G.Hq)(t,null),v=n?$e({spaceSlug:n,shareAtLocation:f,playerLocation:h}):void 0,x=(0,p.useCallback)((function(e){e.preventDefault(),e.target&&u(e.target),v&&navigator.clipboard.writeText(v.url),(0,Ne.Fk)({shareAtLocation:f}),i(!0)}),[f,v]),g=(0,p.useCallback)((function(){i(!1)}),[]),b=(0,p.useCallback)((function(e){m(e.target.checked),e.target.checked&&(0,Ne.w5)()}),[]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(xe.Z,{container:!0,className:ye().copyLinkHolder,children:[(0,l.jsx)(xe.Z,{item:!0,xs:9,children:(0,l.jsx)(Ie.Z,{id:"url-input",type:"text",value:null===v||void 0===v?void 0:v.text,style:{width:"100%"},startAdornment:(0,l.jsx)(we.Z,{position:"end",style:{marginLeft:0},children:(0,l.jsx)(Ce.Z,{"aria-label":"Copy Link to Clipboard",onClick:x,style:{cursor:"pointer",padding:"12px 8px 12px 0"},children:(0,l.jsx)(ke.Z,{})})}),inputProps:{readOnly:!0}})}),(0,l.jsx)(xe.Z,{item:!0,xs:3,children:(0,l.jsx)(ge.Z,{onClick:x,className:ye().copyButton,children:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Se.Aw,{})," Copy"]})})})]}),(0,l.jsx)(xe.Z,{item:!0,xs:12,children:h&&(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(Pe.Z,{control:(0,l.jsx)(Ze.Z,{checked:f,onChange:b,name:"shareAtLocation",color:"primary"}),label:"Share at current location"})})}),(0,l.jsx)(Me.Z,{open:a,anchorEl:c,handleClose:g})]})},Be=function(e){var n=e.spaceSlug,t=e.playerLocation$,r=e.open;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(be.Z,{variant:"h2",children:"Share this space"}),(0,l.jsx)(_e.Z,{}),r&&(0,l.jsx)(Ae,{spaceSlug:n,playerLocation$:t})]})},Ue=function(e){var n=e.spaceSlug,t=e.playerLocation$,r=e.open,a=(0,_.Z)(e,["spaceSlug","playerLocation$","open"]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(be.Z,{variant:"h3",className:ye().headerForList,children:"Invite Collaborators"}),r&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Ee.ZP,(0,s.Z)((0,i.Z)({},a),{spaceSlug:n})),(0,l.jsx)(_e.Z,{}),(0,l.jsx)(be.Z,{variant:"h3",className:ye().headerForList,style:{marginTop:20},children:"Share this Space"}),(0,l.jsx)("div",{className:ye().headerForList,children:(0,l.jsx)(Ae,{spaceSlug:n,playerLocation$:t})})]})]})},Le=function(e){var n=e.open,t=e.handleClose,r=e.canInviteToEdit,a=e.spaceSlug,i=e.playerLocation$,s=e.spaceId,o=e.userId,c=e.editorState;return(0,p.useEffect)((function(){n&&(0,Ne.Rc)({canInviteToEdit:r})}),[n,r]),(0,l.jsx)(De.Z,{open:n,handleClose:t,size:"small",children:(0,l.jsx)(l.Fragment,{children:r&&n&&o&&s?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(Ue,{spaceSlug:a,playerLocation$:i,spaceId:s,spaceRoles:null===c||void 0===c?void 0:c.spaceRoles,userId:o,open:n})}):(0,l.jsx)(Be,{spaceSlug:a,playerLocation$:i,open:n})})})},Fe=t(78295),Re=t.n(Fe),Oe=t(13196),ze=t.n(Oe),We=function(e){var n=e.open,t=e.handleClose,r=e.screenshotDataUri,a=e.spaceSlug,i=(0,p.useState)(),s=i[0],o=i[1];return(0,p.useEffect)((function(){var e="arium-screenshot-".concat(a,"-").concat(ze()({length:4}).toLowerCase(),".jpg");o(e)}),[a,r]),(0,l.jsx)(De.Z,{open:n,handleClose:t,size:"large",children:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:ye().modalBody,children:r&&(0,l.jsx)("img",{src:r,alt:"Screenshot",className:ye().screenshotImage})}),(0,l.jsx)("div",{className:Re().container,style:{width:"300px",top:"10px",left:0,margin:"10px 0"},children:(0,l.jsx)("a",{href:r,download:s,className:Re().primary,children:"Download"})})]})})},Ve=t(87683),Xe=t(54727),Ke=le()((function(){return Promise.all([t.e(9866),t.e(4980),t.e(1991),t.e(7639),t.e(2678),t.e(3641),t.e(5188)]).then(t.bind(t,45188))}),{loadableGenerated:{webpack:function(){return[45188]}}}),Ye=function(){var e=(0,p.useState)(!1),n=e[0],t=e[1],r=(0,p.useCallback)((function(){t(!0)}),[]);return{open:n,handleClose:(0,p.useCallback)((function(){t(!1)}),[]),handleOpen:r}},Ge=(0,p.memo)((function(e){var n,t=e.joystickMove,r=e.setKeyboardControlsDisabled,i=e.userMedia,s=e.user,o=e.broadcasting,c=e.disableUserMediaControls,d=e.profileSetter,f=e.fullScreenElement,m=e.spaceSlug,v=e.canInviteToEdit,b=e.playerLocation$,_=e.spaceId,j=i.refreshAvailableDevices,y=(0,p.useState)(!1),S=y[0],w=y[1];(0,p.useEffect)((function(){r(!!S)}),[S,r]);var C=(0,p.useContext)(de.rU),I=!!(null===C||void 0===C?void 0:C.contentsTreeOpen),k=Ye(),Z=k.open,P=k.handleOpen,T=k.handleClose,N=Ye(),E=N.open,M=N.handleOpen,D=N.handleClose,$=Ye(),A=$.open,B=$.handleOpen,U=$.handleClose,L=Ye(),F=L.open,R=L.handleOpen,O=L.handleClose,z=(0,p.useState)(),W=z[0],V=z[1],X=null===(n=(0,p.useContext)(Xe.Z))||void 0===n?void 0:n.three,K=(0,Ve.y)({three:X}).captureScreenshot,Y=(0,p.useCallback)((0,a.Z)(u().mark((function e(){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(K){e.next=2;break}return e.abrupt("return");case 2:return V(void 0),n=K(),V(n),R(),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)}))),[K,R]);return(0,l.jsxs)(l.Fragment,{children:[Z&&(0,l.jsx)(he,{children:(0,l.jsx)(fe.Z,{mediaDevices:i,handleContinue:T,buttonText:"Close"})}),E&&s&&(0,l.jsx)(he,{children:(0,l.jsx)(ve.Z,{handleContinue:D,hasWebcamStream:!1,setKeyboardControlsDisabled:r,user:s,profileSetter:d,buttonText:"Close"})}),(0,l.jsxs)("div",{className:(0,h.default)(x().root),children:[C&&(0,l.jsx)(Ke,{editorState:C}),(0,l.jsx)(ce,{joystickMove:t,openProfileModule:M,userMedia:i,peerMetadata$:e.profileSetter.metaDataWithUpdates$,hide:I||Z||E,sidebarOpen:!1,refreshAvailableDevices:j,broadcasting:o,disableUserMediaControls:c,handleOpenSettings:P,fullScreenElement:f,openShareDialog:B,captureScreenshot:Y}),(0,l.jsx)(g.Z,{onClose:function(e){w(!1)},show:S})]}),(0,l.jsx)(Le,{editorState:C,open:A,handleClose:U,canInviteToEdit:v,spaceSlug:m,playerLocation$:b,spaceId:_,userId:null===s||void 0===s?void 0:s.uid}),(0,l.jsx)(We,{open:F,handleClose:O,screenshotDataUri:W,spaceSlug:m})]})})),He=t(87462),qe=t(63366),Qe=t(94184),Je=t.n(Qe),en=t(47150),nn=t(51176),tn=t(76792),rn=t(41068),an=t(41485),sn=t(39602),on=t(66611),cn=t(48358),un=(0,sn.Z)("h4");un.displayName="DivStyledAsH4";var ln=(0,on.Z)("alert-heading",{Component:un}),dn=(0,on.Z)("alert-link",{Component:cn.Z}),fn={show:!0,transition:rn.Z,closeLabel:"Close alert"},pn=p.forwardRef((function(e,n){var t=(0,en.Ch)(e,{show:"onClose"}),r=t.bsPrefix,a=t.show,i=t.closeLabel,s=t.className,o=t.children,c=t.variant,u=t.onClose,l=t.dismissible,d=t.transition,f=(0,qe.Z)(t,["bsPrefix","show","closeLabel","className","children","variant","onClose","dismissible","transition"]),m=(0,tn.vE)(r,"alert"),h=(0,nn.Z)((function(e){u&&u(!1,e)})),v=!0===d?rn.Z:d,x=p.createElement("div",(0,He.Z)({role:"alert"},v?void 0:f,{ref:n,className:Je()(s,m,c&&m+"-"+c,l&&m+"-dismissible")}),l&&p.createElement(an.Z,{onClick:h,label:i}),o);return v?p.createElement(v,(0,He.Z)({unmountOnExit:!0},f,{ref:void 0,in:a}),x):a?x:null}));pn.displayName="Alert",pn.defaultProps=fn,pn.Link=dn,pn.Heading=ln;var mn=pn,hn=t(97257),vn=function(e){var n=e.children,t=(0,p.useState)(!0),r=t[0],a=t[1];return r?(0,l.jsx)(mn,{variant:"danger",onClose:function(){return a(!1)},dismissible:!0,className:me().alertModal,children:n}):null},xn=function(){return(0,l.jsx)(vn,{children:"Could not connect to space because it is full. You can still walk around the space, but won't be able to communicate with the others in the space."})},gn=function(){return(0,l.jsx)(vn,{children:"It looks like you were disconnected from the server. Attempting to reconnect..."})},bn=function(){return(0,l.jsx)(j.Z,{fluid:!0,className:me().loadingWrapper,children:(0,l.jsx)(A.Z,{className:"h-100",children:(0,l.jsx)($.Z,{xs:12,className:"my-auto",children:(0,l.jsx)("div",{className:"d-flex justify-content-center",children:(0,l.jsx)(hn.Z,{})})})})})},_n=function(){return(0,l.jsx)(vn,{children:"Looks like you have disconnected from the server. You can still walk around the space, but won't be able to communicate with the others in the space. You can try to reload the page to re-connect."})},jn=function(){return(0,l.jsx)(vn,{children:"Error connecting to the server. You can still walk around the space, but won't be able to communicate with the others in the space. You can try to reload the page to re-connect."})},yn=function(e){var n=e.joinStatus;return"full"===n?(0,l.jsx)(xn,{}):"disconnected"===n?(0,l.jsx)(_n,{}):"reconnecting"===n?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(gn,{}),(0,l.jsx)(bn,{})]}):"joined"===n?null:"error"===n?(0,l.jsx)(jn,{}):(0,l.jsx)(bn,{})},Sn=function(e){var n=e.joinStatus;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Ge,(0,i.Z)({},e)),(0,l.jsx)(yn,{joinStatus:n})]})},wn=t(30836),Cn=t(98977),In=t.n(Cn),kn=t(74835),Zn=t(35005),Pn=t(32089),Tn=t(32923),Nn=t(14788),En=function(){var e=(0,a.Z)(u().mark((function e(n,t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Nn.wk)().httpsCallable("validatePassword")({spaceId:n,password:t});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),Mn=function(e){var n=e.spaceId,t=e.setPasswordValidated,r=(0,p.useCallback)((function(){t(!0)}),[t]),i=(0,p.useMemo)((function(){return Pn.Ry({password:Pn.Z_().required().test("validatePassword","invalid password",function(){var e=(0,a.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!1);case 2:return e.abrupt("return",En(n,t));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())})}),[n]);return(0,l.jsxs)("div",{className:In().jumbotronPadding,children:[(0,l.jsx)("div",{className:"text-center",children:(0,l.jsx)("h3",{children:"Please enter the password to access this space"})}),(0,l.jsx)(A.Z,{className:"justify-content-md-center",children:(0,l.jsx)($.Z,{xs:12,md:6,lg:4,children:(0,l.jsx)(Tn.J9,{validationSchema:i,onSubmit:r,validateOnChange:!1,initialValues:{password:""},children:function(e){var n=e.handleSubmit,t=e.handleChange,r=e.isSubmitting,a=e.values,i=e.errors;return(0,l.jsxs)(kn.Z,{noValidate:!0,className:In().form,onSubmit:n,children:[(0,l.jsxs)(kn.Z.Group,{controlId:"password",children:[(0,l.jsx)(kn.Z.Control,{type:"password",name:"password",placeholder:"space password",value:a.password,onChange:t,isInvalid:!!i.password}),(0,l.jsx)(kn.Z.Control.Feedback,{type:"invalid",children:i.password})]}),(0,l.jsx)(kn.Z.Group,{children:(0,l.jsx)(Zn.Z,{type:"submit",variant:"primary",disabled:r,children:"Submit"})})]})}})})})]})},Dn=t(89576),$n=t(59289),An=t(54164),Bn=t.n(An),Un=t(51381),Ln=t(57195),Fn=t(88674),Rn=t(1274),On=function(e){var n=e.spaceId,t=(e.spaceSlug,e.authState),r=e.editorState,a=(0,p.useContext)(Un.f),i=!!(null===a||void 0===a?void 0:a.canEdit),s=t.authenticated,o=t.isAnonymous,c=t.user,u=(0,Fn.bG)(null===r||void 0===r?void 0:r.status$),d=(0,p.useCallback)((function(){i&&r&&r.setStatus(Ln.I.selectingElement)}),[i,r]);return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(Dn.Z,{className:(0,h.default)(Bn().topSpaceNavbar),variant:"dark",children:[(0,l.jsx)(Rn.eN,{className:"d-none d-lg-block"}),(0,l.jsx)(Rn.uI,{className:"d-lg-none"}),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Dn.Z.Toggle,{"aria-controls":"basic-navbar-nav"}),(0,l.jsx)(Dn.Z.Collapse,{id:"basic-navbar-nav",children:(0,l.jsxs)($n.Z,{className:"ml-auto",children:[!u&&(0,l.jsx)(l.Fragment,{children:i&&(0,l.jsx)($n.Z.Item,{onClick:d,children:(0,l.jsx)(Rn.K6,{children:(0,l.jsx)($n.Z.Link,{className:"mx-md-3",children:"Edit this Space"})})})}),s&&(0,l.jsx)(Rn.IC,{authenticated:s,isAnonymous:o,user:c,showLogin:!1,spaceId:n})]})})]})]})})},zn=function(e){var n=e.children,t=e.spaceId,r=e.spaceSlug,a=e.showHeader,i=e.authState,s=e.hideUI,o=e.editorState;e.playerLocation$;return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(j.Z,{fluid:!0,style:{width:"100%",height:"100%",padding:0},children:[a&&!s&&(0,l.jsx)(On,{spaceId:t,spaceSlug:r,authState:i,editorState:o}),(0,l.jsx)("div",{style:{position:"absolute",height:"100%",width:"100%",top:0},children:n})]})})},Wn=t(31818),Vn=t(89281),Xn=t(65340),Kn=t(55155),Yn=t(65343),Gn=t(46182),Hn=t(75981),qn=t(64706),Qn=t(19258),Jn=le()((function(){return t.e(6408).then(t.bind(t,16408))}),{loadableGenerated:{webpack:function(){return[16408]}}}),et=function(e){var n=e.spaceId,t=e.spaceSlug,r=e.requirePassword,c=e.spaceMetadata,d=(0,m.U)(),h=(0,Wn.JL)({ensureSignedInAnonymously:!0}),v=(0,Un.n)((0,s.Z)((0,i.Z)({},h),{spaceId:n})),x=(0,p.useState)(null),g=x[0],b={setThree:x[1],three:g};(0,Gn.IU)(h);var _=(0,p.useState)(!1),j=_[0],y=_[1],S=r&&!j,w=(0,o.Z)((0,Kn._K)("h",!1),1)[0],C=(0,p.useState)(!0),I=C[0],k=C[1],Z=(0,p.useState)(),P=Z[0],T=Z[1],N=!c.doesNotExist||!I;(0,p.useEffect)((function(){var e=d.targetSlug;if(e){if(!h.authenticated)return;(0,a.Z)(u().mark((function n(){var t,r,a;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,qn.e6)(e);case 2:t=n.sent,r=t.exists,a=t.id,r?(k(!0),T(a)):(k(!1),T(void 0));case 6:case"end":return n.stop()}}),n)})))()}else T(n)}),[n,d.targetSlug,h.authenticated]);var E=!!(null===v||void 0===v?void 0:v.canEdit),M=(0,de.Xv)(P,E),D=(0,Hn.J)({spaceId:n}),$=(0,o.Z)((0,G.Kz)(Qn.Kt),2),A=$[0],B=$[1];if(!N)return(0,l.jsx)(Xn.R,{type:"space",id:n});var U=h;if(!P||!h.authenticated)return(0,l.jsx)(Vn.K,{hint:"Loading space..."});var L=d.targetSlug||t,F=D?Jn:Yn.Z;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(f(),{id:wn.Z.__hash,children:wn.Z}),(0,l.jsx)(Xe.Z.Provider,{value:b,children:(0,l.jsx)(Un.f.Provider,{value:v,children:(0,l.jsx)(de.rU.Provider,{value:M,children:(0,l.jsx)(zn,{spaceId:P,spaceSlug:L,showHeader:!d.documentation,authState:U,editorState:M,hideUI:w,playerLocation$:A,children:(0,l.jsxs)(l.Fragment,{children:[S&&(0,l.jsx)(Mn,{spaceId:P,setPasswordValidated:y}),N&&!S&&(0,l.jsx)(F,(0,s.Z)((0,i.Z)({authState:U,spaceSlugFromPath:t,spaceId:P},d),{UserInterface:Sn,pushState:void 0,autoInitialize:r&&j,spaceMetadata:c,hideUI:w,canEdit:E,spaceSlug:L,playerLocation$:A,updatePlayerLocation:B,className:d&&null!=d.className&&d.className||""}))]})})})})})]})}},45262:function(e,n,t){"use strict";t.d(n,{M:function(){return o},U:function(){return c}});var r=t(14924),a=t(67294),i=t(79937),s=t(11633),o={x:"x",y:"y",z:"z",lx:"lx",ly:"ly",lz:"lz",portalTo:"portalTo",bodyColor:"body-color",avatarScale:"avatar-scale",videoResolution:"video-res",micQuality:"mic-quality",profilePhoto:"profile-photo",eventSlug:"event",invite:"invite"},c=function(){var e=(0,i.aM)(),n=(0,i.Wd)("video",e),t=(0,i.Wd)(o.videoResolution,e),c=(0,i.Wd)(o.micQuality,e),u=(0,i.Kb)(o.x,e),l=(0,i.Kb)(o.y,e),d=(0,i.Kb)(o.z,e),f=(0,i.Kb)(o.lx,e),p=(0,i.Kb)(o.ly,e),m=(0,i.Kb)(o.lz,e),h=(0,i.Wd)("dontRender",e),v=(0,i.Kb)("moveSpeed",e),x=(0,i.Kb)("dragSpeed",e),g=(0,i.Kb)("turnSpeed",e),b=(0,i.Kb)("gravity",e),_=(0,i.Kb)("jumpSpeed",e),j=(0,i.ax)("disableCollisions",e),y=(0,i.ax)("testTransport",e),S=(0,i.ax)("invisible",e),w=(0,i.ax)("documentation",e),C=(0,i.Wd)(o.eventSlug,e),I={maxVisiblePeers:(0,i.Kb)("maxVisiblePeers",e),maxVideoPeers:(0,i.Kb)("maxVideoPeers",e),maxAudioPeers:(0,i.Kb)("maxAudioPeers",e),maxTweenedPeers:(0,i.Kb)("maxTweenedPeers",e),maxPeerMediaDistance:(0,i.Kb)("maxPeerMediaDistance",e)},k=(0,i.ax)("disableGroundDetection",e),Z=(0,i.Wd)("name",e),P=(0,i.Wd)(o.bodyColor,e),T=(0,i.Wd)(o.profilePhoto,e),N=(0,i.Wd)(o.avatarScale,e),E=(0,i.Wd)(o.invite,e),M="true"===(0,i.Wd)("auto-enter",e),D=(0,i.Wd)(o.portalTo,e),$={movementSpeed:v,dragSpeed:x,turnSpeed:g,disableCollisions:j,disableGroundDetection:k,gravity:b,jumpSpeed:_},A=(0,a.useMemo)((function(){var e;return e={},(0,r.Z)(e,s.oK.name,Z),(0,r.Z)(e,s.oK.bodyColor,P),(0,r.Z)(e,s.oK.avatarScale,N),(0,r.Z)(e,s.oK.photo,T),e}),[Z,P,N,T]);return{externalVideo:n,initialX:u,initialY:l,initialZ:d,initialLookAtX:f,initialLookAtY:p,initialLookAtZ:m,render:(0,a.useMemo)((function(){return"true"!==h}),[h]),controlsSettings:$,peerSettingsOverride:I,peerMetadata:A,testTransport:y,invisible:S,bodyColor:P,autoEnter:M,documentation:w,targetSlug:D,videoResolution:t,micQuality:c,inviteId:E,eventSlug:C}}},81534:function(e,n,t){"use strict";t.d(n,{Gr:function(){return B}});var r=t(47568),a=t(26042),i=t(69396),s=t(10253),o=t(34051),c=t.n(o),u=t(85893),l=t(50998),d=t(81860),f=t(95757),p=t(17812),m=t(67294),h=t(96353),v=t(67265),x=t(72841),g=t.n(x),b=t(32089),_=t(32923),j=t(98291),y=t(29674),S=t(14788),w=t(7397),C=t(38799),I=t(62822),k=t(5434),Z=t(37250),P=t(41749),T=t(6562),N=t(66081),E=t(868),M=t(45262),D=t(51549),$=b.Ry({email:b.Z_().email("Enter a valid email").required("Email is required")}),A=function(e){var n=e.spaceId,t=e.userId,r=(0,m.useState)(!1),s=r[0],o=r[1],c=(0,_.TA)({initialValues:{email:"",role:"editor"},validationSchema:$,onSubmit:function(e){o(!0),function(e){var n=e.vals,t=e.spaceId,r=e.userId,s=(0,i.Z)((0,a.Z)({},n),{fromUserId:r,createdTime:(0,S.Qk)(),pending:!0,claimed:!1});return new Promise((function(e,n){return(0,y.$b)(t).add(s).then((function(){(0,D.Cp)({editor:!0}),setTimeout(e,300)})).catch((function(e){(0,j.vU)("Error when sending beta sign up info to db",e),setTimeout((function(){return n(e)}),300)}))}))}({vals:e,spaceId:n,userId:t}).then((function(){o(!1),c.resetForm()})).catch((function(e){console.error(e),o(!1)}))}}),l=(0,m.useCallback)((function(e){e.stopPropagation()}),[]);return(0,u.jsx)(u.Fragment,{children:(0,u.jsx)("form",{onSubmit:c.handleSubmit,onKeyDown:l,className:g().listForm,children:(0,u.jsxs)(P.Z,{container:!0,children:[(0,u.jsx)(P.Z,{item:!0,xs:8,style:{paddingRight:"10px"},children:(0,u.jsx)(T.Z,{children:(0,u.jsx)(C.Z,{id:"email",type:"email",value:c.values.email,placeholder:"Email",onChange:c.handleChange,error:c.touched.email&&Boolean(c.errors.email),style:{lineHeight:"40px"},disabled:s,endAdornment:(0,u.jsx)(w.Z,{position:"end",style:{marginRight:"10px"},children:(0,u.jsx)("span",{children:"can edit"})})})})}),(0,u.jsx)(P.Z,{item:!0,xs:4,children:(0,u.jsx)("div",{className:g().formButtonContainer,children:(0,u.jsx)("button",{className:g().formButton,id:"enter",disabled:c.isSubmitting,type:"submit",children:"Send Invite"})})})]})})})},B=function(e){var n=(0,m.useState)(),t=n[0],r=n[1];return(0,m.useEffect)((function(){if(e){var n=(0,y.xA)(e).onSnapshot((function(e){r(e.data())}));return function(){n()}}}),[e]),t},U=function(){var e=(0,r.Z)(c().mark((function e(n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,S.wk)().httpsCallable("updateSpaceRoles")(n);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),L=function(e){var n=e.email,t=e.inviteUrl,r=(0,m.useState)(!1),a=r[0],i=r[1],o=(0,s.Z)(m.useState(null),2),c=o[0],x=o[1],b=(0,m.useCallback)((function(e){e.target&&x(e.target),e.preventDefault(),navigator.clipboard.writeText(t),i(!0)}),[t]),_=(0,m.useCallback)((function(){i(!1)}),[]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(l.Z,{children:[(0,u.jsx)(h.Z,{children:(0,u.jsx)(v.Z,{alt:n})}),(0,u.jsx)(f.Z,{primary:"".concat(n," (pending)")}),(0,u.jsxs)(d.Z,{children:[(0,u.jsx)("a",{href:t,onClick:b,className:g().formLink,children:"copy link"}),(0,u.jsx)(p.Z,{edge:"end","aria-label":"Copy to Clipboard",color:"primary",onClick:b,children:(0,u.jsx)(N.Z,{})})]})]}),(0,u.jsx)(Z.Z,{open:a,anchorEl:c,handleClose:_})]})},F=function(e){var n=e.id,t=e.editor,a=e.owner,i=e.isSelf,s=e.spaceId,o=(0,m.useState)(!1),x=o[0],b=o[1],_=B(n),j=(0,m.useCallback)(function(){var e=(0,r.Z)(c().mark((function e(t){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.prev=1,r={toChangeUserId:n,spaceId:s,editor:{remove:!t,add:t}},e.next=5,U(r);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error(e.t0);case 10:return e.prev=10,b(!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[1,7,10,13]])})));return function(n){return e.apply(this,arguments)}}(),[n,s]),y="".concat((null===_||void 0===_?void 0:_.displayName)||"").concat(i?" (self)":""),S=!a&&!i;return(0,u.jsxs)(l.Z,{children:[(0,u.jsx)(h.Z,{children:(0,u.jsx)(v.Z,{alt:y,src:(null===_||void 0===_?void 0:_.photoURL)||void 0})}),(0,u.jsx)(f.Z,{primary:y}),(0,u.jsxs)(d.Z,{children:[(t||a)&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("span",{className:g().listButtonText,children:a?"owner":"can edit"}),(0,u.jsx)(E.ZP,{title:"Disable space editing for ".concat(null===_||void 0===_?void 0:_.displayName),children:(0,u.jsx)(p.Z,{edge:"end","aria-label":"Disable Space Editing",color:"primary",disabled:x||!S,onClick:function(){return j(!1)},children:(0,u.jsx)(k.cqP,{})})})]}),!t&&!a&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("span",{className:g().listButtonText,children:"can view"}),(0,u.jsx)(E.ZP,{title:"Enable space editing for ".concat(null===_||void 0===_?void 0:_.displayName),children:(0,u.jsx)(p.Z,{edge:"end","aria-label":"Enable Space Editing",disabled:x||!S,onClick:function(){return j(!0)},children:(0,u.jsx)(k.$36,{})})})]})]})]})},R=function(e){var n=e.spaceSlug,t=e.inviteId,r=window.location.hostname,a=window.location.protocol;return"".concat(a,"//").concat(r,"/spaces/").concat(n,"?").concat(M.M.invite,"=").concat(t)};n.ZP=function(e){var n=e.spaceId,t=e.userId,r=e.spaceRoles,o=e.spaceSlug,c=function(e){var n=e.spaceId,t=e.pendingOnly,r=e.spaceSlug,s=(0,m.useState)([]),o=s[0],c=s[1];return(0,m.useEffect)((function(){var e=(t?(0,y.$b)(n).where("pending","==",!0):(0,y.$b)(n)).onSnapshot((function(e){var n=e.docs.map((function(e){return(0,i.Z)((0,a.Z)({},e.data()),{id:e.id,url:R({spaceSlug:r,inviteId:e.id})})}));c(n)}));return function(){return e()}}),[n,t,r]),o}({spaceId:n,pendingOnly:!0,spaceSlug:o}),l=(0,m.useState)(),d=l[0],f=l[1];return(0,m.useEffect)((function(){if(r&&r.profiles){var e=Object.entries(r.profiles).map((function(e){var o,c,u=(0,s.Z)(e,2),l=u[0],d=u[1];return(0,i.Z)((0,a.Z)({id:l},d),{owner:(null===(o=r.owners)||void 0===o?void 0:o.includes(l))||!1,editor:(null===(c=r.editors)||void 0===c?void 0:c.includes(l))||!1,spaceId:n,isSelf:l===t})})),o=e.sort((function(e,n){return e.isSelf?1:n.isSelf?-1:e.owner&&!n.owner?1:n.owner&&!e.owner?-1:(e.displayName||"").localeCompare(n.displayName||"")}));f(o)}}),[r,n,t]),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(A,{spaceId:n,userId:t}),(0,u.jsxs)(I.Z,{dense:!0,children:[c.map((function(e){return(0,u.jsx)(L,{email:e.email,inviteUrl:e.url},e.id)})),null===d||void 0===d?void 0:d.map((function(e){return(0,u.jsx)(F,(0,a.Z)({},e),e.id)}))]})]})}},37250:function(e,n,t){"use strict";var r=t(85893),a=t(52387),i=t(22318);n.Z=function(e){var n=e.open,t=e.handleClose,s=e.anchorEl;return(0,r.jsx)(a.ZP,{id:"copied popover",open:n,anchorEl:s,onClose:t,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},style:{padding:"15px !important"},children:(0,r.jsx)(i.Z,{children:"Link copied to clipboard."})})}},98268:function(e,n,t){"use strict";var r=t(14924),a=t(85893),i=t(13457),s=t(72841),o=t.n(s),c=t(26072),u=t(73637),l=t(91869),d=t(86010),f=t(17812),p=t(5566),m=t(32692);n.Z=function(e){var n,t=e.open,s=e.handleClose,h=e.children,v=e.size,x=e.backdropDisabled,g=void 0!==x&&x;return(0,a.jsx)(i.Z,{theme:l.Wb,children:(0,a.jsx)(p.Z,{closeAfterTransition:!0,BackdropProps:{className:(0,d.default)((0,r.Z)({},o().backdrop,!g)),timeout:500},BackdropComponent:g?void 0:m.Z,open:t,onClose:s,className:(0,d.default)(o().modal),children:(0,a.jsx)(u.Z,{in:t,timeout:500,children:(0,a.jsxs)("div",{className:(0,d.default)((n={},(0,r.Z)(n,o().modalPaperSmaller,"small"===v),(0,r.Z)(n,o().modalPaperLarge,"large"===v),n)),children:[(0,a.jsx)(f.Z,{className:o().closeButton,onClick:s,children:(0,a.jsx)(c.P7,{})}),h]})})})})}},81122:function(e,n,t){"use strict";t.d(n,{F:function(){return A},Z:function(){return U}});var r=t(85893),a=t(26042),i=t(69396),s=t(10253),o=t(67294),c=t(60050),u=t(81472),l=t(65449),d=t(72328),f=function(e){return[1,3,5].map((function(n){return parseInt(e.substr(n,2),16)}))},p=f("#f29f05"),m=f("#fffff1"),h=p.map((function(e,n){return e-m[n]})),v=(0,u.animated)("feTurbulence"),x=(0,u.animated)("feDisplacementMap"),g={xChannelSelector:"R",yChannelSelector:"G",in:"SourceGraphic",in2:"TURB",result:"DISP"},b={type:"fractalNoise",numOctaves:1,result:"TURB"},_={height:"100%",width:"100%",position:"absolute",overflow:"visible"},j={fill:"none",r:"46%"},y=function(e){return 1+Math.min(8,8*e*2)},S=function(e){return e=Math.sqrt(Math.min(1,1.5*Math.max(e-.1,0))),"#"+[0,1,2].map((function(n){return Math.floor(m[n]+h[n]*e).toString(16).padStart(2,"0")})).join("")},w=function(e){return Math.min(.6+e,1)},C=function(e){var n=e.volume$,t=(0,d.Hq)(n,0),r=(0,o.useRef)(1.5*(t||.2));r.current=Math.max(r.current,t);var a,i=function(e,n){return(Math.sin((e/n-.5)*Math.PI)+1)/2}((a=t,Math.max(a-.001,0)/.999),r.current),f=(0,c.D)(i),p=i>f,m=(0,c.D)(p),h=(0,s.Z)((0,u.useSpring)((function(){return{x:i}})),2),v=h[0].x,x=h[1];return(0,o.useEffect)((function(){if(p)x({x:i,config:l.config.wobbly});else{if(!m)return;x({x:0,config:l.config.molasses})}}),[i,p,m,x]),v},I=function(e){var n=C(e),t=function(){var e=(0,o.useRef)(0),n=(0,o.useRef)();return(0,o.useEffect)((function(){var t=function(){e.current+=1,n.current=requestAnimationFrame(t)};return n.current=requestAnimationFrame(t),function(){return cancelAnimationFrame(n.current)}}),[]),e.current}();return(0,r.jsx)(r.Fragment,{children:[1,2].map((function(e){return(0,r.jsxs)("g",{children:[(0,r.jsxs)("filter",{id:"wave".concat(e),children:[(0,r.jsx)(v,(0,i.Z)((0,a.Z)({},b),{seed:e,baseFrequency:null===n||void 0===n?void 0:n.interpolate((function(n){return.03*e*n}))})),(0,r.jsx)(x,(0,i.Z)((0,a.Z)({},g),{scale:null===n||void 0===n?void 0:n.interpolate((function(n){return e*n*10}))}))]}),(0,r.jsx)(u.animated.circle,(0,i.Z)((0,a.Z)({},j),{filter:"url(#wave".concat(e,")"),transform:null===n||void 0===n?void 0:n.interpolate((function(){return"rotate(".concat(t*(4-e)*.3,")")})),stroke:null===n||void 0===n?void 0:n.interpolate(S),strokeWidth:null===n||void 0===n?void 0:n.interpolate(y),opacity:null===n||void 0===n?void 0:n.interpolate(w)}))]},e)}))})},k=function(e){return(0,r.jsx)("svg",{style:_,children:(0,r.jsx)("svg",{x:"50%",y:"50%",style:_,children:(0,r.jsx)(I,(0,a.Z)({},e))})})},Z=t(58148),P=t.n(Z),T=(0,o.memo)((function(e){var n=e.videoTrack,t=(0,o.useState)(!0),a=t[0],i=t[1],s=(0,o.useCallback)((function(){i(!0)}),[]),c=(0,o.useCallback)((function(){i(!1)}),[]),u=(0,o.useState)(null),l=u[0],d=u[1],f=(0,o.useState)(!1),p=f[0],m=f[1];return(0,o.useEffect)((function(){m(!0)}),[n]),(0,o.useEffect)((function(){p&&n&&l&&(a?(l.srcObject=new MediaStream([n]),m(!1)):l.pause())}),[n,p,l,a]),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("video",{className:P().clipCircle,ref:d,autoPlay:!0,playsInline:!0,onPlaying:c,onPause:s})})})),N=t(81628),E=t.n(N),M=t(86010),D=t(21608),$=t(36277),A=function(e){var n=e.children,t=e.showLogo,a=void 0===t||t;return(0,r.jsx)(D.Z,{className:"justify-content-center py-5",children:(0,r.jsxs)("div",{className:(0,M.default)(E().videoContainer),children:[(0,r.jsx)("div",{className:(0,M.default)(E().videoElement,E().logo),children:a&&(0,r.jsx)("img",{src:"/images/arium-logo-light.png",alt:"the letter A"})}),(0,r.jsx)("div",{className:(0,M.default)(E().videoElement)}),(0,r.jsx)("div",{className:(0,M.default)(E().videoElement,E().video),children:n})]})})},B=function(e){var n=e.selfAvatar;return(0,r.jsxs)(A,{children:[(0,r.jsx)(k,{volume$:n.volume$}),(0,r.jsx)(T,{videoTrack:n.videoTrack||void 0})]})},U=function(){var e=((0,o.useContext)($.u)||{}).selfAvatar;return e?(0,r.jsx)(B,{selfAvatar:e}):null}},97257:function(e,n,t){"use strict";t.d(n,{u:function(){return o}});var r=t(85893),a=(t(67294),t(87158)),i=t.n(a),s=function(){return(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:[(0,r.jsx)("path",{opacity:".25",d:"M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4"}),(0,r.jsx)("path",{d:"M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z",children:(0,r.jsx)("animateTransform",{attributeName:"transform",type:"rotate",from:"0 16 16",to:"360 16 16",dur:"0.8s",repeatCount:"indefinite"})})]})},o=function(){return(0,r.jsx)("div",{className:i().loadingWrapper,children:(0,r.jsx)("div",{className:"d-flex justify-content-center",children:(0,r.jsx)(s,{})})})};n.Z=s},1549:function(e,n,t){"use strict";t.d(n,{Z:function(){return G}});var r=t(85893),a=t(21608),i=t(31555),s=t(67294),o=t(81628),c=t.n(o),u=t(78295),l=t.n(u),d=t(86010),f=t(58148),p=t.n(f),m=t(72328),h=function(e){var n=e.setKeyboardControlsDisabled,t=e.name$,a=e.setName,i=e.disabled,o=e.nameFieldRef,c=(0,s.useRef)(null),u=(0,s.useState)(!1),l=u[0],f=u[1],h=(0,s.useCallback)((function(e){a(e.target.value)}),[a]),v=(0,s.useCallback)((function(){var e,n;null===(e=o.current)||void 0===e||e.blur(),null===(n=c.current)||void 0===n||n.focus(),f(!1)}),[o]);(0,s.useEffect)((function(){if(l)return setTimeout((function(){document.addEventListener("click",v)}),100),function(){document.removeEventListener("click",v)}}),[l,v]),(0,s.useEffect)((function(){n(l)}),[l,n]);var x=(0,s.useCallback)((function(){f(!1)}),[]),g=(0,s.useCallback)((function(){f(!0)}),[]),b=(0,s.useCallback)((function(e){"Enter"!==e.key&&"Tab"!==e.key||(e.preventDefault(),v())}),[v]),_=(0,s.useCallback)((function(e){e.stopPropagation()}),[]),j=(0,s.useMemo)((function(){return l?{color:"white",opacity:1}:{color:"white"}}),[l]),y=(0,m.Hq)(t,"");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{value:y||"",onClick:_,onFocus:g,onBlur:x,onKeyPress:b,onChange:h,className:(0,d.default)(p().sidebarDisplaynameInput,p().fullWidth),style:j,placeholder:"Your Name...",ref:o,disabled:i}),(0,r.jsx)("input",{type:"text",ref:c,style:{height:"0",width:"0",opacity:0,position:"absolute"}})]})},v=t(81122),x=t(47568),g=t(14924),b=t(26042),_=t(69396),j=t(34051),y=t.n(j),S=t(41120),w=t(35117),C=t(5566),I=t(73637),k=t(32692),Z=t(32512),P=t(80366),T=t(282),N=t(41749),E=t(31300),M=t.n(E),D=function(e){return new Promise((function(n,t){var r=new Image;r.addEventListener("load",(function(){return n(r)})),r.addEventListener("error",(function(e){return t(e)})),r.setAttribute("crossOrigin","anonymous"),r.src=e}))};function $(e,n,t){return A.apply(this,arguments)}function A(){return A=(0,x.Z)(y().mark((function e(n,t,r){var a,i,s,o,c,u,l,d,f,p,m,h=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h.length>3&&void 0!==h[3]?h[3]:0,e.next=3,D(t);case 3:return a=e.sent,i=n.getContext("2d"),n.width=320,n.height=320,s=r.x,o=r.y,c=r.width,u=r.height,l=0,d=0,f=320,p=320,i.drawImage(a,s,o,c,u,l,d,f,p),m=n.toDataURL("image/png"),e.abrupt("return",m);case 18:case"end":return e.stop()}}),e)}))),A.apply(this,arguments)}var B=t(83913),U=t(59122),L=t(22318),F=(0,S.Z)((function(e){return(0,w.Z)({modal:{display:"flex",alignItems:"center",justifyContent:"center"},modalPaper:{maxHeight:"90%",maxWidth:"90%",position:"fixed",zIndex:999,color:"black",backgroundColor:"white",boxShadow:e.shadows[5],padding:e.spacing(2),outline:"none"},fullWidth:(0,g.Z)({width:"90%"},e.breakpoints.down("xs"),{width:"100%",height:"100%"}),partialWidth:(0,g.Z)({width:"70%"},e.breakpoints.down("xs"),{width:"100%",height:"100%"}),closeButton:{position:"absolute",top:e.spacing(2),right:e.spacing(2),float:"right",pointerEvents:"stroke",padding:0,minWidth:0},innerWrapper:{},cropContainer:{position:"relative",width:"100%",height:450},cropButton:{flexShrink:0,marginLeft:16},controls:(0,g.Z)({padding:16,display:"flex",flexDirection:"column",alignItems:"stretch"},e.breakpoints.up("sm"),{flexDirection:"row",alignItems:"center"}),sliderContainer:(0,g.Z)({display:"flex",flex:"1",alignItems:"center",width:"100%"},e.breakpoints.up("sm"),{width:"30%"}),sliderLabel:(0,g.Z)({},e.breakpoints.down("xs"),{minWidth:65}),slider:(0,g.Z)({padding:"22px 0px",marginLeft:16},e.breakpoints.up("sm"),{flexDirection:"row",alignItems:"center",margin:"0 16px"}),captureButton:(0,g.Z)({width:"100%",marginTop:e.spacing(2)},e.breakpoints.up("sm"),{width:"30%"})})})),R=function(e){var n=e.show,t=e.handleClose,a=e.handleImageSelected,i=F(),o=(0,s.useState)(null),c=o[0],u=o[1],l=(0,s.useMemo)((function(){return new FileReader}),[]),f=(0,s.useState)({x:0,y:0}),p=f[0],m=f[1],h=(0,s.useState)(1),v=h[0],g=h[1],j=(0,s.useState)(null),S=j[0],w=j[1],E=(0,s.useRef)(null),D=(0,s.useCallback)((function(e,n){w(n)}),[]),A=(0,s.useCallback)((0,x.Z)(y().mark((function e(){var n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c&&S&&E.current){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,$(E.current,c,S,0);case 5:n=e.sent,a(n),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])}))),[c,S,a]);(0,s.useEffect)((function(){var e=function(){u(l.result)};return l.addEventListener("load",e),function(){l.removeEventListener("load",e)}}),[l]);var R=(0,s.useCallback)((function(e){var n=e[0];l.readAsDataURL(n)}),[l]),O=(0,Z.uI)({accept:"image/jpeg, image/png",onDrop:R}),z=O.getRootProps,W=O.getInputProps;return(0,r.jsx)(C.Z,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:i.modal,open:n,onClose:t,BackdropComponent:k.Z,BackdropProps:{timeout:500},children:(0,r.jsx)(I.Z,{in:n,children:(0,r.jsx)("div",{className:(0,d.default)(i.modalPaper,c?i.fullWidth:i.partialWidth),children:(0,r.jsxs)("div",{className:i.innerWrapper,children:[(0,r.jsx)(T.Z,{className:i.closeButton,onClick:t,children:(0,r.jsx)(P.Z,{})}),(0,r.jsxs)(N.Z,{container:!0,style:{height:"100%",width:"90%"},children:[!c&&(0,r.jsxs)(N.Z,(0,_.Z)((0,b.Z)({item:!0,style:{height:"340px"},xs:12},z({className:(0,d.default)(M().dragAndDrop)})),{children:[(0,r.jsx)("input",(0,b.Z)({},W())),(0,r.jsx)("p",{children:"Upload a profile image"})]})),c&&(0,r.jsx)(N.Z,{item:!0,xs:12,children:c&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:i.cropContainer,children:(0,r.jsx)(B.Z,{image:c,crop:p,rotation:0,zoom:v,aspect:1,onCropChange:m,onCropComplete:D,onZoomChange:g})}),(0,r.jsxs)("div",{className:i.controls,children:[(0,r.jsxs)("div",{className:i.sliderContainer,children:[(0,r.jsx)(L.Z,{variant:"overline",classes:{root:i.sliderLabel},children:"Zoom"}),(0,r.jsx)(U.Z,{value:v,min:1,max:10,step:.1,"aria-labelledby":"Zoom",classes:{root:i.slider},onChange:function(e,n){return g(n)}})]}),(0,r.jsx)("div",{className:i.captureButton,children:(0,r.jsx)(V,{onClick:A,text:"Set Profile Image",primary:!0})})]}),(0,r.jsx)("canvas",{ref:E,width:320,height:320,style:{display:"none"}})]})})]})]})})})})},O=t(14615),z=t(79937),W=t(18127),V=function(e){var n=e.onClick,t=e.text,a=e.primary,i=(0,s.useCallback)((function(e){e.preventDefault(),n()}),[n]);return(0,r.jsx)("div",{className:(0,d.default)(l().container,a?null:l().secondaryContainer),children:(0,r.jsx)("button",{onClick:i,className:a?l().primary:l().secondary,id:t,title:t,"data-testid":"captureProfile",children:t})})},X=function(e){var n=e.handleChange;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(a.Z,{className:"mt-5 mt-md-1 py-2 ",children:[(0,r.jsx)(i.Z,{xs:12,className:"align-self-end py-2 px-4 justify-content-center",children:(0,r.jsx)(V,{onClick:n,text:"change avatar image",primary:!1})}),(0,r.jsx)(i.Z,{xs:12,className:"align-self-end px-4 py-1 justify-content-center",children:(0,r.jsx)("i",{children:"This image will appear on your avatar when your camera is off or when you are far away from other users."})})]})})},K={},Y=function(e){var n=e.hasVideoStream,t=e.handleProfilePhotoUrlUpdated,a=e.peerMetadata$,i=e.userId,o=(0,W.Dk)({handleProfilePhotoUrlUpdated:t,userId:i}),c=o.captureState,u=o.handleChangeProfileImage,l=o.handlePhotoUploaded,d=o.handleCloseUploadPhotoDialog,f=(0,m.Hq)(a,K),p=(0,z.aM)(),h=(0,z.ax)("profile-photo",p),x=(0,s.useMemo)((function(){return h||!n}),[n,h]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(v.F,{showLogo:!1,children:(0,r.jsx)(O.Z,{peerMetadata:f,preferVideoOrPhotoTexture:x?"photo":"video"})}),x&&(0,r.jsx)(X,{handleChange:u}),c.capture&&(0,r.jsx)(R,{show:!0,handleClose:d,handleImageSelected:l})]})},G=function(e){var n=e.handleContinue,t=e.hasWebcamStream,o=e.setKeyboardControlsDisabled,u=e.user,f=e.profileSetter,p=e.buttonText,m=void 0===p?"Let's Go!":p,v=(0,s.useRef)(null),x=f.updatingProfile;return(0,s.useEffect)((function(){var e=f.savedPhotoUrl$.subscribe({next:function(){var e;return null===(e=v.current)||void 0===e?void 0:e.focus()}});return function(){e.unsubscribe()}}),[f.savedPhotoUrl$]),(0,s.useEffect)((function(){if(n){var e=f.saved$.subscribe({next:function(){return n()}});return function(){return e.unsubscribe()}}}),[f.saved$,n]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Y,{hasVideoStream:t,handleProfilePhotoUrlUpdated:f.setNewProfileImage,peerMetadata$:f.metaDataWithUpdates$,userId:u.uid}),(0,r.jsxs)(a.Z,{className:(0,d.default)(c().selectContainer,c().borderTop,"mt-5 mt-md-1 py-2 mx-2 px-0"),children:[(0,r.jsx)(i.Z,{xs:2,md:1,className:"py-2 m-0 align-self-center",children:(0,r.jsx)("img",{src:"/images/icons/nametag-icon.svg",alt:"nametag icon"})}),(0,r.jsx)(i.Z,{xs:10,md:11,className:"align-self-end px-4 py-2 justify-content-center",children:(0,r.jsx)(h,{name$:f.name$,setKeyboardControlsDisabled:o,setName:f.setName,nameFieldRef:v})})]}),(0,r.jsx)(a.Z,{className:"my-5 justify-content-center",children:(0,r.jsx)(i.Z,{xs:12,className:"align-self-end px-4 justify-content-center",children:(0,r.jsx)("div",{className:(0,d.default)(l().container,l().bottomFixedOnSmall,x?l().disabled:""),children:(0,r.jsx)("button",{onClick:f.handleContinueClicked,className:l().primary,id:"enter",disabled:x,children:m})})})})]})}},18127:function(e,n,t){"use strict";t.d(n,{Dk:function(){return k},UK:function(){return N},Gr:function(){return T}});var r=t(47568),a=t(14924),i=t(26042),s=t(69396),o=t(10253),c=t(34051),u=t.n(c),l=t(67294),d=t(14788),f=t(13196),p=t.n(f),m=function(e,n){return"/profileImages/".concat(e,"/").concat(n)},h=function(){var e=(0,r.Z)(u().mark((function e(n){var t,r,a,i,s,o,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.userId,r=n.photoDataUri,a=n.extension,i=p()({length:3}),s="".concat(i,".").concat(a),o=m(t,s),e.next=6,(0,d.tO)().ref(o).putString(r,"data_url");case 6:return c="https://assets.vlts.pw".concat(o),e.abrupt("return",{fileName:s,path:o,url:c});case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),v=t(11633),x=t(72328),g=t(43485),b=t(55709),_=t(43825),j=t(24759),y=t(39846),S=t(70211),w=t(89233),C=t(75142),I=t(29674),k=function(e){var n=e.handleProfilePhotoUrlUpdated,t=e.userId,a=(0,l.useState)({capture:!1,newImage:void 0}),o=a[0],c=a[1],d=(0,l.useCallback)(function(){var e=(0,r.Z)(u().mark((function e(r){var a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=7;break}return e.next=3,h({userId:t,photoDataUri:r.dataUri,extension:r.extension});case 3:a=e.sent,n(a.url),e.next=8;break;case 7:n(null);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[t,n]),f=(0,l.useCallback)((function(){c({capture:!0,newImage:void 0}),d(void 0)}),[d]),p=(0,l.useCallback)((function(){c((function(e){return(0,s.Z)((0,i.Z)({},e),{capture:!1})}))}),[]);return{captureState:o,handleChangeProfileImage:f,handlePhotoUploaded:(0,l.useCallback)((function(e){d({dataUri:e,extension:"png"}),p()}),[p,d]),handleCloseUploadPhotoDialog:p}},Z=function(){var e=(0,r.Z)(u().mark((function e(n,t){var a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,I.xA)(n),e.next=3,d.h.runTransaction(function(){var e=(0,r.Z)(u().mark((function e(n){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.get(a);case 2:e.sent.exists?n.update(a,t):n.set(a,t);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),P=function(){var e=(0,r.Z)(u().mark((function e(n){var t,r,a,s,o,c,l,d,f;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.newProfileImage,r=n.userId,a=n.userProfile,s=n.setPeerMetadata,o=n.userName,c={},l=null,!t){e.next=13;break}if("string"===typeof t){e.next=11;break}return e.next=7,h({userId:r,photoDataUri:t.dataUri,extension:t.extension});case 7:d=e.sent,l=d.url,e.next=12;break;case 11:l=t;case 12:c.photoURL=l;case 13:return o&&o!==(null===a||void 0===a?void 0:a.displayName)&&(c.displayName=o),Object.entries(c).length>0&&(f={},l&&(f[v.oK.photo]=l),o&&(f[v.oK.name]=o),Z(r,c),s((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.Z)({},e,f)}))),e.abrupt("return",{name:o,photoUrl:l});case 16:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),T=function(e){var n=(0,l.useState)(),t=n[0],r=n[1],a=null===e||void 0===e?void 0:e.uid;return(0,l.useEffect)((function(){a&&(0,I.xA)(a).onSnapshot((function(e){if(e.exists){var n=e.data();r(n)}}))}),[a]),t},N=function(e){var n=e.userId,t=e.userProfile,i=e.setPeerMetadata,s=(0,l.useState)(new y.t)[0],c=(0,l.useState)(new y.t)[0],d=null===t||void 0===t?void 0:t.displayName;(0,l.useEffect)((function(){s.next(d)}),[s,d]);var f=null===t||void 0===t?void 0:t.photoURL,p=(0,x.j7)(f||null);(0,l.useEffect)((function(){c.next(f)}),[c,f]);var m=(0,l.useCallback)((function(e){s.next(e)}),[s]),h=(0,l.useCallback)((function(e){c.next(e)}),[c]),I=(0,l.useState)(new S.xQ)[0],k=(0,l.useState)(new S.xQ)[0];(0,l.useEffect)((function(){return function(){k.complete()}}),[k]);var Z=(0,l.useState)(new w.X({}))[0];(0,l.useEffect)((function(){var e=(0,C.aj)([s.pipe((0,g.O)(null)),c.pipe((0,g.O)(null))]).pipe((0,b.U)((function(e){var n,t=(0,o.Z)(e,2),r=t[0],i=t[1];return n={},(0,a.Z)(n,v.oK.name,r),(0,a.Z)(n,v.oK.photo,i),n}))).subscribe(Z);return function(){return e.unsubscribe()}}),[s,c,Z]);var T=(0,l.useState)(!1),N=T[0],E=T[1];(0,l.useEffect)((function(){if(n){var e=(0,C.aj)([s,c]),a=I.pipe((0,_.M)(e),(0,j.z)(function(){var e=(0,r.Z)(u().mark((function e(r){var a,s,c,l;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,o.Z)(r,2),s=(0,o.Z)(a[1],2),c=s[0],l=s[1],E(!0),e.next=4,P({newProfileImage:l,setPeerMetadata:i,userId:n,userProfile:t,userName:c});case 4:E(!1);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())).subscribe(k);return function(){return a.unsubscribe()}}}),[s,c,I,k,i,n,t]);var M=(0,l.useCallback)((function(e){e.preventDefault(),I.next()}),[I]);return{setNewProfileImage:h,savedPhotoUrl$:p,metaDataWithUpdates$:Z,name$:s,setName:m,handleContinueClicked:M,updatingProfile:N,saved$:k}}},60668:function(e,n,t){"use strict";t.d(n,{Z:function(){return y}});var r=t(85893),a=t(67294),i=t(74835),s=(0,a.memo)((function(e){var n=e.title,t=e.currentDeviceId,s=e.inputSelect,o=e.refreshAvailableDevices,c=e.devices,u=e.disabled,l=(e.icon,(0,a.useState)(t||"")),d=l[0],f=l[1];(0,a.useEffect)((function(){f(t||"")}),[t]);var p=(0,a.useCallback)((function(e){s(e.target.value),f(e.target.value)}),[s]);return(0,r.jsxs)(i.Z.Group,{className:"m-0",children:[(0,r.jsx)(i.Z.Label,{srOnly:!0,children:n}),(0,r.jsx)(i.Z.Control,{as:"select",disabled:u,value:d,onChange:p,onClick:o,children:null===c||void 0===c?void 0:c.map((function(e){return(0,r.jsx)("option",{value:e.deviceId,children:e.label},e.deviceId)}))})]})})),o=t(31555),c=t(21608),u=t(81628),l=t.n(u),d=t(86010),f=t(81122),p=t(95394),m=t(22742),h=t(65031),v=t(1161),x=t(14924),g=t(78295),b=t.n(g),_=function(e){var n=e.buttonText,t=e.handleClick,a=e.bottomFixedOnSmall,i=e.disabled,s=e.submitButton;return(0,r.jsx)("div",{className:(0,d.default)(b().container,(0,x.Z)({},b().bottomFixedOnSmall,a)),children:(0,r.jsx)("button",{onClick:t,className:b().primary,id:"enter",disabled:i,type:s?"submit":void 0,children:n})})},j=function(e){var n=e.mediaDevice,t=e.enabledIcon,i=e.disabledIcon,c=e.dropdownTitle,u=e.refreshAvailableDevices,l=n.gettingStream,d=n.paused,f=n.pause,p=n.resume,m=n.failedGettingStream,h=(0,a.useCallback)((function(){if(d){p();try{u()}catch(e){console.error(e)}}else f()}),[f,d,u,p]),v=(0,a.useCallback)((function(e){e.preventDefault(),h()}),[h]),x=!m,g=d?i:t;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{xs:2,md:1,className:"p-2 m-0 align-self-center",children:(0,r.jsxs)(r.Fragment,{children:[!x&&(0,r.jsx)(r.Fragment,{children:g}),x&&(0,r.jsx)("a",{href:"#",onClick:v,children:g})]})}),(0,r.jsx)(o.Z,{xs:10,md:11,className:"px-2 py-2 justify-content-center",children:n.deviceList&&!m&&(0,r.jsx)(s,{title:c,devices:n.deviceList,refreshAvailableDevices:u,inputSelect:n.selectSendingDevice,currentDeviceId:n.sendingDeviceId,disabled:!n.sendingStream||l})})]})},y=function(e){var n=e.mediaDevices,t=e.handleContinue,i=e.buttonText,s=void 0===i?"Continue":i,o=(0,a.useCallback)((function(e){e.preventDefault(),t()}),[t]),u=n.refreshAvailableDevices;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.Z,{}),(0,r.jsx)(c.Z,{className:(0,d.default)(l().selectContainer,"my-1 py-2 px-0 mx-2 d-none d-md-flex"),children:(0,r.jsx)(j,{mediaDevice:n.webcam,enabledIcon:(0,r.jsx)(p.Z,{}),disabledIcon:(0,r.jsx)(m.Z,{}),dropdownTitle:"Choose Webcam",refreshAvailableDevices:u})}),(0,r.jsx)(c.Z,{className:(0,d.default)(l().selectContainer,"my-1 py-2 px-0 mx-2 d-none d-md-flex"),children:(0,r.jsx)(j,{mediaDevice:n.mic,enabledIcon:(0,r.jsx)(h.Z,{}),disabledIcon:(0,r.jsx)(v.Z,{}),dropdownTitle:"Choose Microphone",refreshAvailableDevices:u})}),(0,r.jsx)(c.Z,{className:"my-5 py-3 justify-content-center",children:(0,r.jsx)(_,{buttonText:s,handleClick:o,bottomFixedOnSmall:!0})})]})}},35735:function(e,n,t){"use strict";t.d(n,{w:function(){return r}});t(67294);var r=function(e){e.preventDefault(),document.activeElement&&document.activeElement.blur&&document.activeElement.blur()}},30836:function(e,n){"use strict";var t=new String("html{position:relative;min-height:100%}html,body{height:100%;font-family:$primary-font}#__next{width:100%;height:100%}body{font-size:16px;font-weight:400;line-height:25px;color:$arium-black;font-family:$primary-font;background-color:$arium-black!important}h1,h2,h3{font-family:$primary-font;color:$arium-black}h1{font-weight:bold;font-size:48px}h2{font-weight:600;font-size:40px}a{font-family:$primary-font;text-decoration:underline;color:$arium-red;font-size:16px}");t.__hash="573980dae63c221f",n.Z=t},14788:function(e,n,t){"use strict";t.d(n,{F$:function(){return d},I8:function(){return h},Qk:function(){return b},XB:function(){return x},Y1:function(){return _},Yo:function(){return l},_p:function(){return m},aj:function(){return p},h:function(){return o},sM:function(){return c},tO:function(){return j},u9:function(){return g},vM:function(){return u},wk:function(){return v}});var r=t(26042),a=t(15503),i=(t(16690),t(82257),t(14642),t(50626),t(5201),t(34155)),s=a.Z.apps.length?a.Z.app():a.Z.initializeApp((0,r.Z)({},{apiKey:"AIzaSyAAt0MULwXlRJiMq4V2_LE7mUIre1Na94M",authDomain:"volta-events-294715.firebaseapp.com",projectId:"volta-events-294715",storageBucket:"volta-events-294715.appspot.com",messagingSenderId:"309430825062",appId:"1:309430825062:web:4c42eaec39b1b719c17da7"})),o=a.Z.firestore(),c=s.database("https://arium-communication.firebaseio.com"),u=s.database("https://arium-producing-peers.firebaseio.com/"),l=s.database("https://arium-peers.firebaseio.com/"),d=s.database("https://arium-consumers.firebaseio.com/"),f=s.database("https://arium-created-consumers.firebaseio.com/"),p=s.database("https://arium-boids-test.firebaseio.com/"),m=s.database("https://maxxi-michela-de-mattei.firebaseio.com/");i.env.NEXT_PUBLIC_DB_EMULATOR_PORT&&(c.useEmulator("localhost",+i.env.NEXT_PUBLIC_DB_EMULATOR_PORT),u.useEmulator("localhost",+i.env.NEXT_PUBLIC_DB_EMULATOR_PORT),l.useEmulator("localhost",+i.env.NEXT_PUBLIC_DB_EMULATOR_PORT),d.useEmulator("localhost",+i.env.NEXT_PUBLIC_DB_EMULATOR_PORT),f.useEmulator("localhost",+i.env.NEXT_PUBLIC_DB_EMULATOR_PORT));var h=a.Z.auth,v=a.Z.functions;i.env.NEXT_PUBLIC_FUNCTIONS_PORT&&v().useEmulator("localhost",+i.env.NEXT_PUBLIC_FUNCTIONS_PORT);var x=function(){return h().signInAnonymously()},g=function(){return a.Z.database.ServerValue.TIMESTAMP},b=function(){return a.Z.firestore.FieldValue.serverTimestamp()},_=function(){return a.Z.firestore.FieldValue.delete()},j=function(){return a.Z.storage()};i.env.NEXT_PUBLIC_STORE_EMULATOR_PORT&&(console.log("using emulator for store",i.env.NEXT_PUBLIC_STORE_EMULATOR_PORT),o.useEmulator("localhost",+i.env.NEXT_PUBLIC_STORE_EMULATOR_PORT));a.Z.firestore.FieldValue.increment},31818:function(e,n,t){"use strict";t.d(n,{Im:function(){return m},JL:function(){return d},YW:function(){return p},gz:function(){return f}});var r=t(47568),a=t(26042),i=t(69396),s=t(34051),o=t.n(s),c=t(67294),u=t(14788),l=t(46182),d=function(e){var n=e.ensureSignedInAnonymously,t=e.forceRefreshToken,s=void 0!==t&&t,l=(0,c.useState)({authenticated:!1,isAnonymous:!0,emailVerified:!1,pending:!0,isNewUser:!1,isAdmin:!1,ensureSignedInAnonymously:n,claims:void 0}),d=l[0],f=l[1],p=(0,c.useCallback)(function(){var e=(0,r.Z)(o().mark((function e(n,t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getIdToken(!0);case 2:return e.next=4,n.getIdTokenResult();case 4:r=e.sent.claims,f((function(e){return(0,i.Z)((0,a.Z)({},e),{isAdmin:!!r.admin,claims:r})}));case 6:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),[]),m=(0,c.useCallback)((0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d.user){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,p(d.user,!0);case 4:case"end":return e.stop()}}),e)}))),[d.user,p]);return(0,c.useEffect)((function(){(0,u.I8)().onAuthStateChanged(function(){var e=(0,r.Z)(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}r=t.metadata.creationTime===t.metadata.lastSignInTime,f((function(e){return(0,i.Z)((0,a.Z)({},e),{authenticated:!0,userId:t.uid,user:t,isAnonymous:t.isAnonymous,emailVerified:t.emailVerified,isNewUser:r,panding:!1})})),t.isAnonymous?f((function(e){return(0,i.Z)((0,a.Z)({},e),{claims:null,claimsLoaded:!0})})):p(t,s),e.next=8;break;case 4:if(f((function(e){return(0,i.Z)((0,a.Z)({},e),{authenticated:!1,userId:void 0,isAnonymouse:!1,pending:!1})})),!n){e.next=8;break}return e.next=8,(0,u.XB)();case 8:f((function(e){return(0,i.Z)((0,a.Z)({},e),{pending:!1})}));case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())}),[n,s,p]),(0,i.Z)((0,a.Z)({},d),{refreshClaims:m})},f=function(){return{signInFlow:"popup",signInOptions:[{provider:u.I8.EmailAuthProvider.PROVIDER_ID,requireDisplayName:!0},u.I8.GoogleAuthProvider.PROVIDER_ID,u.I8.TwitterAuthProvider.PROVIDER_ID],tosUrl:"https://www.arium.xyz/terms",privacyPolicyUrl:"https://arium.xyz/privacy",callbacks:{signInSuccessWithAuthResult:function(e){var n=e.user;return e.additionalUserInfo.isNewUser&&((0,l.rU)(n.uid),n.sendEmailVerification()),!0}}}},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{prefix:"Sign up with"},n=e.prefix,t=void 0===n?"Sign up with":n,r={signInFlow:"popup",signInOptions:[{provider:u.I8.GoogleAuthProvider.PROVIDER_ID,fullLabel:"".concat(t," Google")},{provider:u.I8.TwitterAuthProvider.PROVIDER_ID,fullLabel:"".concat(t," Twitter")},{provider:u.I8.EmailAuthProvider.PROVIDER_ID,requireDisplayName:!0,fullLabel:"Sign up with Email"}],tosUrl:"https://www.arium.xyz/terms",privacyPolicyUrl:"https://arium.xyz/privacy",callbacks:{signInSuccessWithAuthResult:function(e,n){var t=e.user;return e.additionalUserInfo.isNewUser&&((0,l.rU)(t.uid),t.providerId===u.I8.EmailAuthProvider.PROVIDER_ID&&t.sendEmailVerification()),!0}}};return r},m=function(){return(0,c.useMemo)((function(){return f()}),[])}},69464:function(e,n,t){"use strict";var r=t(10179),a=t(67294),i=t(41931),s=t(59971),o=t(70051),c=t(72328);n.Z=function(e){var n=(0,c.j7)(e||void 0),t=(0,c.Qy)(),u=(0,a.useState)(0),l=u[0],d=u[1],f=(0,a.useMemo)((function(){return l>=2}),[l]);return(0,a.useEffect)((function(){var e=n.pipe((0,i.x)(),(0,r.YU)(),(0,s.P)()),a=n.pipe((0,i.x)(),t(),(0,o.u)(e)).subscribe({next:function(){d((function(e){return e+1}))}});return function(){a.unsubscribe()}}),[t,n]),f}},14963:function(e,n,t){"use strict";t.d(n,{vI:function(){return I}});var r=t(10253),a=t(46182),i=t(67294),s=t(44081),o=t(69604),c=t(14370),u=t(89233),l=t(75142),d=t(59971),f=t(5602),p=t(66008),m=t(11120),h=t(47746),v=t(96381),x=t(41931),g=t(55709),b=t(22807),_=t(31762),j=t(12368),y=t(27554),S=t(14788),w=t(30557),C=function(e){return S.sM.ref("".concat("userSessions","/").concat(e))},I=function(e){var n=e.invisible,t=e.authenticated,r=e.userId,a=e.sessionId,s=e.spaceId;(0,i.useEffect)((function(){if(!n&&r&&a&&t&&s){var e=C(a).onDisconnect();return e.set({active:!1,userId:r,spaceId:s,lastChanged:(0,S.u9)()}),function(){e.cancel()}}}),[n,a,r,s,t]),(0,i.useEffect)((function(){if(t&&!n&&a){var e=C(a),r=setInterval((function(){e.update({active:!0,lastChanged:(0,S.u9)()})}),3e4);return function(){window.clearInterval(r)}}}),[t,n,a]),(0,i.useEffect)((function(){if(!n&&a&&r){var e=C(a),t=function(n){var t=n.val();e.update({active:!0===t,userId:r,lastChanged:(0,S.u9)()})};return S.sM.ref(".info/connected").on("value",t),function(){S.sM.ref(".info/connected").off("value",t)}}}),[a,r,n]),(0,i.useEffect)((function(){n||r&&s&&a&&C(a).update({spaceId:s,userId:r,active:!0,lastChanged:(0,S.u9)()})}),[n,a,s,r])},k=function(e,n){var t=e.spaceId,r=e.sessionId,a=e.serverTimeOffset$;return(0,w.Uz)(t,a).pipe((0,p.h)((function(e){return e.sessionId!==r})),(0,m.v)((function(e){return e.sessionId})),(0,h.zg)((function(e){var t=e.key;return e.pipe((0,v.w)((function(e){return function(e,n){var t=e.active,r=e.lastChanged,a=n.maxActiveDifference,i=n.activeTimeout,u=n.inactiveTimeout;if(!function(e){var n=e.maxDifference;return e.lastChanged>=e.currentTime-n}({lastChanged:r,maxDifference:a,currentTime:(new Date).getTime()}))return(0,s.D)([!1]);var l,p=(0,s.D)([!0]);return l=t?(0,o.H)(i).pipe((0,d.P)(),(0,f.h)(!1)):(0,o.H)(u).pipe((0,d.P)(),(0,f.h)(!1)),(0,c.T)(p,l)}({active:e.active,lastChanged:e.lastChanged},n)})),(0,x.x)(),(0,g.U)((function(e){return{active:e,sessionId:t}})))})),(0,b.R)((function(e,n){var t=n.active,r=n.sessionId;if(t&&!e.has(r)){var a=new Set(e);return a.add(r),a}if(!t&&e.has(r)){var i=new Set(e);return i.delete(r),i}return e}),new Set),(0,x.x)())};n.ZP=function(e){var n=e.spaceId$,t=e.sessionId$,o=e.serverTimeOffset$,d=(0,i.useState)((function(){return new u.X(new Set)}))[0];return(0,i.useEffect)((function(){var e=(0,l.aj)([n,t]).pipe((0,v.w)((function(e){var n=(0,r.Z)(e,2),t=n[0],a=n[1];return t?k({spaceId:t,sessionId:a,serverTimeOffset$:o},{maxActiveDifference:12e4,activeTimeout:6e4,inactiveTimeout:4e3}):(0,s.D)([new Set])}))).subscribe(d);return function(){e.unsubscribe()}}),[n,d,t,o]),function(e){(0,i.useEffect)((function(){var n=e.pipe((0,g.U)((function(e){return e.size})),(0,x.x)(),(0,_._)(1,void 0,(function(e){var n=e.pipe((0,j.b)((function(e){return(0,a.hO)({peers:e})}))),t=e.pipe((0,y.G)(),(0,p.h)((function(e){var n=(0,r.Z)(e,2),t=n[0];return n[1]>t})));return(0,c.T)(n,t)}))).subscribe();return function(){return n.unsubscribe()}}),[e])}(d),d}},13065:function(e,n,t){"use strict";t.d(n,{Q:function(){return u}});var r=t(14788),a=t(67294),i=t(3222),s=t(89233),o=t(72328),c=function(){return new i.y((function(e){var n=r.sM.ref(".info/serverTimeOffset");return n.on("value",(function(n){var t=n.val();e.next(t)})),function(){n.off("value")}}))},u=function(){var e=c(),n=(0,o.Hq)(e,0);return(0,a.useCallback)((function(){return(new Date).getTime()+n}),[n])};n.Z=function(){var e=(0,a.useState)(new s.X(0))[0];return(0,a.useEffect)((function(){var n=c().subscribe(e);return function(){n.unsubscribe()}}),[e]),e}},79937:function(e,n,t){"use strict";t.d(n,{Kb:function(){return s},Wd:function(){return i},aM:function(){return a},ax:function(){return o},pm:function(){return r}});var r=function(){return new URLSearchParams(window.location.search)};function a(){return r()}function i(e,n){return n.get(e)||void 0}function s(e,n){var t=n.get(e);if(t)return+t}function o(e,n){var t=n.get(e);return!!t&&Boolean(t)}},87683:function(e,n,t){"use strict";t.d(n,{X:function(){return u},y:function(){return c}});var r=t(47568),a=t(34051),i=t.n(a),s=t(67294),o=t(14788),c=function(e){var n=e.three,t=null===n||void 0===n?void 0:n.camera,r=null===n||void 0===n?void 0:n.gl,a=null===n||void 0===n?void 0:n.scene;return{captureScreenshot:(0,s.useCallback)((function(){if(!t||!r||!a)throw new Error("missing camera, gl or scene");return r.render(a,t),r.domElement.toDataURL("image/jpeg")}),[t,r,a])}},u=function(e){var n=e.userId,t=e.spaceId,a=e.handlePathUpdated,u=e.generateFileName,l=e.three,d=c({three:l}).captureScreenshot,f=(0,s.useMemo)((function(){return(0,o.tO)()}),[]),p=(0,s.useState)(!1),m=p[0],h=p[1],v=(0,s.useState)(null),x=v[0],g=v[1],b=(0,s.useCallback)((0,r.Z)(i().mark((function e(){var r,s,o,c,l,p;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&t){e.next=2;break}return e.abrupt("return");case 2:if(r=d(),s=u()||{},o=s.filePath,c=s.fileName,l=s.fileLocation,c&&o&&l&&r){e.next=6;break}return e.abrupt("return");case 6:p=f.ref(o).putString(r,"data_url"),h(!0),g(null),p.on("state_changed",(function(e){}),(function(){h(!1)}),(function(){setTimeout((function(){h(!1),g(l),a&&a(l)}),500)}));case 10:case"end":return e.stop()}}),e)}))),[d,u,a,t,f,n]);return{captureAndSave:b,uploading:m,storedFile:x}}},29674:function(e,n,t){"use strict";t.d(n,{$b:function(){return x},An:function(){return p},CG:function(){return g},EW:function(){return a},Ih:function(){return f},KX:function(){return d},Ob:function(){return h},Oi:function(){return m},TW:function(){return o},Zp:function(){return v},cn:function(){return u},fS:function(){return i},hx:function(){return l},pg:function(){return b},rx:function(){return s},xA:function(){return c}});var r=t(14788),a=function(e){return r.h.collection("spaces").doc(e)},i=function(e){return a(e).collection("settings")},s=function(e){return i(e).doc("environment")},o=function(e){return i(e).doc("meta")},c=function(e){return r.h.collection("userProfiles").doc(e)},u=function(e){return i(e).doc("security")},l=function(e){return i(e).doc("defaultPositionalAudioConfig")},d=function(e){return i(e).doc("physics")},f=function(e){return i(e).doc("camera")},p=function(e){return i(e).doc("effects")},m=function(e){return i(e).doc("theme")},h=function(){return r.h.collection("betaSignUps")},v=function(){return r.h.collection("eventRegistrations")},x=function(e){return r.h.collection("spaces").doc(e).collection("spaceInvites")},g=function(e){var n=e.spaceId,t=e.inviteId;return x(n).doc(t)},b=function(e){if(e)return r.h.collection("spaces").doc(e).collection("elementsTree")}},1274:function(e,n,t){"use strict";t.d(n,{IC:function(){return D},eN:function(){return T},uI:function(){return P},K6:function(){return U},$e:function(){return $},ao:function(){return M},ZP:function(){return L},hY:function(){return E}});var r=t(47568),a=t(10253),i=t(34051),s=t.n(i),o=t(85893),c=t(89576),u=t(86010),l=t(54164),d=t.n(l),f=t(31818),p=function(e){var n=e.imageUrl,t=e.alt,r=e.width,a=e.className;return(0,o.jsx)("img",{style:{clipPath:"circle(closest-side)",width:r},alt:t,src:n,className:a})},m=t(67294),h=t(35735),v=t(78523),x=t(14788),g=t(59289),b=t(53097),_=t(43489),j=t(75147),y=t(51549),S=t(38396),w=t(85639),C=t(17812),I=t(89039),k=t(43340),Z=t(11163),P=function(e){var n=e.className,t=void 0===n?null:n;return(0,o.jsx)(c.Z.Brand,{className:(0,u.default)(d().text,t),href:"/",children:(0,o.jsx)("img",{src:"/images/arium-logo-light.png",alt:"Arium",width:"75",height:"75",className:"d-inline-block align-top"})})},T=function(e){var n=e.className;return(0,o.jsx)(c.Z.Brand,{className:(0,u.default)(d().text,n),href:"/",children:(0,o.jsx)("img",{src:"/images/arium-logo-full.svg",alt:"Arium",height:"50",className:"d-inline-block align-top"})})},N=function(){return(0,o.jsx)(g.Z.Link,{className:(0,u.default)(d().text,"mx-3"),href:"/account",children:"Sign Up"})},E=function(){var e=(0,r.Z)(s().mark((function e(n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,(0,x.I8)().signOut();case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),M=function(e){var n=e.user;return(0,o.jsx)(g.Z.Item,{className:"align-self-center",children:n.photoURL&&(0,o.jsx)(p,{imageUrl:n.photoURL,alt:n.displayName||n.email||"",width:25,className:(0,u.default)(d().photo,"mx-md-3")})})},D=function(e){var n=e.authenticated,t=e.isAnonymous,r=e.user,a=(e.showLogin,e.spaceId),i=(e.classNameOverride,(0,Z.useRouter)()),s=(0,m.useCallback)((function(){i.push("/my-spaces")}),[i]),c=(0,m.useState)(null),l=c[0],f=c[1],p=(0,m.useCallback)((function(e){f(e.currentTarget)}),[]);return!n||t?(0,o.jsx)(A,{spaceId:a}):(0,o.jsxs)(o.Fragment,{children:[r&&(0,o.jsx)(M,{user:r}),(0,o.jsxs)(g.Z.Item,{className:(0,u.default)("align-self-center",d().dropDownArrowHolder),children:[(0,o.jsxs)(C.Z,{"aria-label":"delete",onClick:p,className:d().dropDownArrow,size:"medium",children:[!l&&(0,o.jsx)(I.Z,{}),l&&(0,o.jsx)(k.Z,{})]}),(0,o.jsxs)(S.Z,{id:"simple-menu",anchorEl:l,keepMounted:!0,open:Boolean(l),onClose:function(){f(null)},style:{top:40,background:"none",borderRadius:0},children:[(0,o.jsx)(w.Z,{onClick:s,children:"your spaces"}),(0,o.jsx)(w.Z,{onClick:E,children:"logout"})]})]})]})},$=function(e){var n=e.spaceId,t=(0,f.JL)({ensureSignedInAnonymously:!1}),r=t.authenticated,a=t.isAnonymous,i=t.user;return(0,o.jsxs)(c.Z,{className:d().topNavbar,variant:"dark",children:[(0,o.jsx)(T,{}),(0,o.jsx)(c.Z.Toggle,{"aria-controls":"basic-navbar-nav"}),(0,o.jsx)(c.Z.Collapse,{id:"basic-navbar-nav",children:(0,o.jsx)(g.Z,{className:"ml-auto",children:(0,o.jsx)(D,{authenticated:r,isAnonymous:a,user:i,spaceId:n})})})]})},A=function(e){var n=e.spaceId,t=(0,m.useState)(!1),a=t[0],i=t[1],c=(0,m.useCallback)((function(e){(0,h.w)(e),i(!0),(0,y.Rd)()}),[]),u=(0,m.useState)(!1),l=u[0],d=u[1];return(0,m.useEffect)((function(){n?(0,r.Z)(s().mark((function e(){var t,r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.h.collection("spaces").doc(n).get();case 2:(t=e.sent).exists||d(!0),r=t.data(),a=!0===r.promoteArium,d(a);case 7:case"end":return e.stop()}}),e)})))():d(!1)}),[n]),l?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(g.Z.Item,{children:(0,o.jsx)(g.Z.Link,{href:"/",className:"mx-3",onClick:c,children:(0,o.jsx)("span",{className:"mx-1",style:{textTransform:"none"},children:"Want your own space?"})})}),(0,o.jsx)(v.Z,{onClose:function(e){i(!1)},show:a})]}):null},B=[["p","Position info"],["t","Edit mode"],["ctrl + i","Performance"]],U=function(e){var n=e.children;return(0,o.jsx)(b.Z,{placement:"bottom",overlay:(0,o.jsx)(_.Z,{id:"tooltip-shortcuts",className:d().tooltipShortcuts,children:(0,o.jsxs)(j.Z,{size:"sm",borderless:!0,className:"text-left mb-0",children:[(0,o.jsx)("thead",{children:(0,o.jsx)("tr",{children:(0,o.jsx)("th",{colSpan:2,children:"Shortcuts"})})}),(0,o.jsx)("tbody",{children:B.map((function(e){var n=(0,a.Z)(e,2),t=n[0],r=n[1];return(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:(0,o.jsx)("strong",{children:t})}),(0,o.jsx)("td",{children:r})]},t)}))})]})}),children:n})},L=function(){return(0,o.jsxs)(c.Z,{className:d().topNavbar,variant:"dark",children:[(0,o.jsx)(P,{}),(0,o.jsx)(c.Z.Toggle,{"aria-controls":"basic-navbar-nav"}),(0,o.jsx)(c.Z.Collapse,{id:"basic-navbar-nav",children:(0,o.jsxs)(g.Z,{className:"ml-auto",children:[(0,o.jsx)(g.Z.Link,{className:(0,u.default)(d().text,"mx-md-3"),href:"/",children:"About"}),(0,o.jsx)(g.Z.Link,{className:(0,u.default)(d().text,"mx-md-3"),href:"/pricing",children:"Pricing"}),(0,o.jsx)(N,{})]})})]})}},11390:function(e,n,t){"use strict";t.d(n,{Aw:function(){return d},Dv:function(){return p},PK:function(){return u},S$:function(){return m},d6:function(){return h},eW:function(){return l},zw:function(){return f}});var r=t(85893),a=t(55517),i=t(41749),s=t(63457),o=(t(33242),t(67294),t(76486)),c=t.n(o),u=function(){return(0,r.jsx)("div",{className:c().grow})},l=function(e){var n=e.mobileOnly,t=e.desktopOnly,i=p();return n&&!i||t&&i?null:(0,r.jsx)(a.Z,{className:i?c().mobileDivider:c().desktopDivider})},d=function(e){var n=e.color;return(0,r.jsx)("div",{className:c().theArrow,children:(0,r.jsxs)("svg",{width:"37",height:"22",viewBox:"-2 -2 39 24",fill:"none",children:[(0,r.jsx)("path",{d:"M36.606 15.8921H26.0393C23.7624 15.8921 21.0537 12.1607 18.186 8.21014C15.5556 4.5865 12.8356 0.839428 10.944 0.839428H0.377381C0.168991 0.839428 0 0.670913 0 0.46311C0 0.255307 0.168991 0.086792 0.377381 0.086792H10.944C13.221 0.086792 15.9297 3.81828 18.7974 7.7688C21.4278 11.3925 24.1478 15.1395 26.0393 15.1395H36.606C36.8144 15.1395 36.9833 15.308 36.9833 15.5158C36.9833 15.7237 36.8144 15.8921 36.606 15.8921Z",fill:n||"#303030"}),(0,r.jsx)("path",{d:"M30.5678 21.9133C30.4713 21.9133 30.3746 21.8765 30.301 21.803C30.1536 21.6561 30.1536 21.4178 30.301 21.2709L36.0722 15.5159L30.301 9.76091C30.1536 9.61392 30.1536 9.37563 30.301 9.22872C30.4482 9.0818 30.6873 9.0818 30.8346 9.22872L36.8727 15.2498C37.0201 15.3967 37.0201 15.635 36.8727 15.7819L30.8346 21.803C30.761 21.8765 30.6643 21.9133 30.5678 21.9133Z",fill:n||"#303030"})]})})},f=function(e){var n=e.children;return(0,r.jsx)(i.Z,{className:c().atLeastFullSize,container:!0,justify:"center",alignItems:"center",children:(0,r.jsx)(i.Z,{item:!0,xs:12,style:{textAlign:"center"},children:n})})},p=function(){return(0,s.Z)("(max-width:767px)")},m=function(e){var n=e.children;return(0,r.jsx)("div",{className:c().sectionContainer,children:(0,r.jsx)("div",{children:n})})},h=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"png",t="https://assets.vlts.pw/public/marketing-site-assets/".concat(e),r="".concat(t,"/1x.").concat(n),a="\n".concat(t,"/1x.").concat(n," 1x,\n").concat(t,"/2x.").concat(n," 2x\n");return{imgSrc:r,imgSrcSet:a}}},22537:function(e){e.exports={chatContainer:"chat_chatContainer__6TTy0",minimized:"chat_minimized__bFSnC",chatBg:"chat_chatBg__df1CD",chatMessagesContainer:"chat_chatMessagesContainer__NDPrp",chat:"chat_chat__GWWsJ",form:"chat_form__ochOs",input:"chat_input__7fFM_",expandIcon:"chat_expandIcon__cMiFL",status:"chat_status__sYn3B",expanded:"chat_expanded__M0hh5"}},31300:function(e){e.exports={transformToolbar:"styles_transformToolbar__2_Dk0",fullSize:"styles_fullSize__88beZ",grow:"styles_grow__2HYWz",card:"styles_card__07QXj",info:"styles_info__FL5Rb",btnWarning:"styles_btnWarning__WR4V1",btnOrange:"styles_btnOrange__EPrrK",root:"styles_root__LlIRc",tinyEditorContainer:"styles_tinyEditorContainer__V5TIa",iconBtnWithShadow:"styles_iconBtnWithShadow__0GLyS",iconBtnWithBorder:"styles_iconBtnWithBorder__HR59D",drawer:"styles_drawer__din5e",drawerPaper:"styles_drawerPaper__JoRG8",drawerHeader:"styles_drawerHeader__chluX",content:"styles_content__UFoXp",contentShift:"styles_contentShift__2IrJ_",exitBtn:"styles_exitBtn__IgnDl",toolbar:"styles_toolbar__UZBBV",btnAdd:"styles_btnAdd__qXvQR",btnDisabled:"styles_btnDisabled__pfj9z",toolbarBtn:"styles_toolbarBtn__D5HD1",leftToolbar:"styles_leftToolbar__5bOvv",messageDisplay:"styles_messageDisplay__hip6n",topToolbar:"styles_topToolbar__UsQD0"}},72841:function(e){e.exports={modal:"dialog_modal__dzRVJ",closeButton:"dialog_closeButton__Mrpp1",modalPaper:"dialog_modalPaper__4nlNA",modalPaperLarge:"dialog_modalPaperLarge__xJsxp",modalPaperSmaller:"dialog_modalPaperSmaller__uBabL",copyLinkHolder:"dialog_copyLinkHolder__nMIpA",centeredContents:"dialog_centeredContents__TmACx",screenshotImage:"dialog_screenshotImage__VJJJG",copyButton:"dialog_copyButton__OWdJk",listForm:"dialog_listForm__b47l3",formButtonContainer:"dialog_formButtonContainer__XWnQh",formButton:"dialog_formButton__pvwDt",listButtonText:"dialog_listButtonText__1Lfd2",formLink:"dialog_formLink__fpO0S",headerForList:"dialog_headerForList__Q1d8j"}},81628:function(e){e.exports={lightText:"entranceFlow_lightText__1I66W",skipLink:"entranceFlow_skipLink__ndtd6",clickAllowContainer:"entranceFlow_clickAllowContainer__ktF8a",container:"entranceFlow_container__vnIV1",videoContainer:"entranceFlow_videoContainer__Fq8pU",videoElement:"entranceFlow_videoElement__tDPSv",video:"entranceFlow_video__gWd1y",logo:"entranceFlow_logo__xLZEZ",profileImage:"entranceFlow_profileImage__DHCKc",borderTop:"entranceFlow_borderTop__72pk6",selectContainer:"entranceFlow_selectContainer__4WSHc",eventDescriptionContainer:"entranceFlow_eventDescriptionContainer__RBDtj",type:"entranceFlow_type__eRgQk",date:"entranceFlow_date__y4hSw",eventTitle:"entranceFlow_eventTitle__qBSNl",eventDescription:"entranceFlow_eventDescription__bnaOZ"}},29616:function(e){e.exports={welcomeScreenContainers:"welcomeScreen_welcomeScreenContainers__fvjhp",welcomeMessageContainer:"welcomeScreen_welcomeMessageContainer__L_xrM",welcomeScreenContent:"welcomeScreen_welcomeScreenContent__BF3SH"}},76749:function(e){e.exports={root:"betaaccess_root__uwqsg",logo:"betaaccess_logo__pKCWT",bgOverlay:"betaaccess_bgOverlay__DfdTk",bgVideo:"betaaccess_bgVideo__oYb2G",typewriter:"betaaccess_typewriter__XK02M",titles:"betaaccess_titles__LwPQJ",footer:"betaaccess_footer__Ffe10",modal:"betaaccess_modal__08RJ6",modalPaper:"betaaccess_modalPaper__QmrNS",closeButton:"betaaccess_closeButton__7J8mU",submitButton:"betaaccess_submitButton__2Iw_t",modalContent:"betaaccess_modalContent__HARAJ",textField:"betaaccess_textField__xRjaN",inputLabel:"betaaccess_inputLabel__mGPvk",primaryCta:"betaaccess_primaryCta__wK9kU"}},78295:function(e){e.exports={ctaButton:"cta_ctaButton__8wAzy",container:"cta_container__TJbv5",secondary:"cta_secondary__JxFiO",primary:"cta_primary__8O_dQ",disabled:"cta_disabled__0wglm",secondaryContainer:"cta_secondaryContainer__mKf6K",bottomFixedOnSmall:"cta_bottomFixedOnSmall__X6ddm",profileImageButtons:"cta_profileImageButtons__42YPG"}},23002:function(e){e.exports={legalLinks:"legalLinks_legalLinks__oVcQB"}},87532:function(e){e.exports={intro:"ui_intro__n3T32",actions:"ui_actions__kMzVF",onboarding:"ui_onboarding__Gbhc0",legalLinksContainer:"ui_legalLinksContainer__u1kqF",loadingWrapper:"ui_loadingWrapper__vaUkI",alertModal:"ui_alertModal__rQZZX"}},98432:function(e){e.exports={firebaseAuth:"auth_firebaseAuth__6mNCs","firebaseui-container":"auth_firebaseui-container__jocmz","firebaseui-card-content":"auth_firebaseui-card-content__LSl3v"}},98977:function(e){e.exports={card:"flow_card__SKM86",modal:"flow_modal__VvQop",modalBody:"flow_modalBody__qqQWK",previewContainer:"flow_previewContainer__iPYm4",cardFooter:"flow_cardFooter__Bvhjn",cardFooterButton:"flow_cardFooterButton__3wHYk",spaceCard:"flow_spaceCard__I_7Oa",selectedCard:"flow_selectedCard__M3x_p",overlayText:"flow_overlayText__J1lSY",overlayContents:"flow_overlayContents__6kmCn",overlayBg:"flow_overlayBg__Uvn5U",jumbotronPadding:"flow_jumbotronPadding__UPhdI"}},54164:function(e){e.exports={root:"header_root__wz6PD",buttonGridItem:"header_buttonGridItem__ODBxe",videoContainer:"header_videoContainer__5BfWT",clickable:"header_clickable__sYOXD",clickIcons:"header_clickIcons__xFMDb",icon:"header_icon__Xgpga",withPadding:"header_withPadding__ihLtr",drawerOpenButton:"header_drawerOpenButton__ZAk1l",buttonContainer:"header_buttonContainer__BUUUu",clickableMenu:"header_clickableMenu__qi6D_",clipImage:"header_clipImage__d0bKt",clipCircle:"header_clipCircle__0qRDs",flipVideo:"header_flipVideo__BzTbX",hidden:"header_hidden__Vowsj",sidebarContainer:"header_sidebarContainer__2AZjc",sidebarColumn:"header_sidebarColumn__nJlr0",sidebarColumnHidden:"header_sidebarColumnHidden__YLEOJ",sidebarLogo:"header_sidebarLogo__1b0KH",sidebarExitButton:"header_sidebarExitButton__x5LjM","sidebar-clipped-image-container":"header_sidebar-clipped-image-container__0Yjo3",betaSignUp:"header_betaSignUp__izvbP",bottomBorder:"header_bottomBorder__Xa8NJ",signUpCta:"header_signUpCta__rR3LS","sidebar-clipped-image":"header_sidebar-clipped-image__7qwU0","sidebar-beta-signup-button":"header_sidebar-beta-signup-button__nL2u8",sidebarDisplaynameInput:"header_sidebarDisplaynameInput__qOO1D",sidebarButtonContainer:"header_sidebarButtonContainer__I4_Gh",sidebarContainerButtonElement:"header_sidebarContainerButtonElement__NIlsb",sidebarButtonIcon:"header_sidebarButtonIcon__OZNTT","pause-resume-button-avatar":"header_pause-resume-button-avatar__ogCWw",fullWidth:"header_fullWidth___74wv","sign-up-form":"header_sign-up-form__br5Sk",mainControlsVideoContainer:"header_mainControlsVideoContainer__Z7n9C",mainControlsVideoElement:"header_mainControlsVideoElement__wFNbb",mainControlsVideo:"header_mainControlsVideo__S8c8T",footerControlsCol:"header_footerControlsCol__AxShK",joystickWrapper:"header_joystickWrapper__85xyk",joystickContainer:"header_joystickContainer__tXICK",topLeftIcon:"header_topLeftIcon__DP5w5",bottomBar:"header_bottomBar__4nw_w",controls:"header_controls__mqhki",bottomBarOffset:"header_bottomBarOffset__FH902",instructions:"header_instructions__aKQJt",instructionsText:"header_instructionsText__kdoa4",footerControlButton:"header_footerControlButton__96atg",shareButton:"header_shareButton__pK_nL",settingsButton:"header_settingsButton__2llo5",pauseButton:"header_pauseButton__w0W8_",resumeButton:"header_resumeButton__I3khT",alertButtonOn:"header_alertButtonOn__4U9Qo",fullScreenButton:"header_fullScreenButton__KPJYm",alertOn:"header_alertOn__Du1Xp",fullScreenButtonWrapper:"header_fullScreenButtonWrapper__ap0Ph",fullscreenButtonContainer:"header_fullscreenButtonContainer__yIixD",betaSignUpLogo:"header_betaSignUpLogo__NKIV7",betaSignUpText:"header_betaSignUpText__nqlgb",cursorCrosshair:"header_cursorCrosshair___DEgB",cursorPointer:"header_cursorPointer__57EWu",cursorGrab:"header_cursorGrab__mL71u",cursorGrabbing:"header_cursorGrabbing__m73xk",navbar:"header_navbar___mUVn",topSpaceNavbar:"header_topSpaceNavbar__DFGqg",topNavbar:"header_topNavbar__V4aJN",text:"header_text__2jwbl",photo:"header_photo__Jon3Z",tooltipShortcuts:"header_tooltipShortcuts__ERc_a",dropDownArrowHolder:"header_dropDownArrowHolder__5B1FY",dropDownArrow:"header_dropDownArrow__6_njq",dropDownMenu:"header_dropDownMenu__4yeNj","MuiMenu-paper":"header_MuiMenu-paper__nzkvT"}},76486:function(e){e.exports={mt_NavHeight:"styles_mt_NavHeight__qzWcj",layout2MainContainer:"styles_layout2MainContainer__MC8ZB",appBar:"styles_appBar__2EjQO",toolBar:"styles_toolBar__k5myo",navBtn:"styles_navBtn__MX27R",logoutBtn:"styles_logoutBtn__9hyTy",footerContainer:"styles_footerContainer__xNtov",debugBorder:"styles_debugBorder__cL6e3",hostYourOwn:"styles_hostYourOwn__wWuyI",getAReminder:"styles_getAReminder__XgCPg",smoothSimpleSharing:"styles_smoothSimpleSharing__S3QWA",asItWasMeantToBeSeen:"styles_asItWasMeantToBeSeen__dMTIU",artInContext:"styles_artInContext__KuyYP",actNatural:"styles_actNatural__LLtG7",sectionContainer:"styles_sectionContainer__bZ_Yk",logo:"styles_logo__zCZAe",mobileDivider:"styles_mobileDivider__ihreX",desktopDivider:"styles_desktopDivider__eWsGN",pagination:"styles_pagination__UQHGs",positionRelative:"styles_positionRelative__lW47i",grow:"styles_grow__6p2JF",fullSize:"styles_fullSize__nNmSW",heroContainer:"styles_heroContainer__pQX_u",swipeable:"styles_swipeable__p2atF",media:"styles_media__fRvK_",section2:"styles_section2__ihxGq",gridContainer:"styles_gridContainer__N7MJR",atLeastFullSize:"styles_atLeastFullSize__a8oRi",mw1440:"styles_mw1440__cAol7",addPaddingMdDown:"styles_addPaddingMdDown__2fPlD",videoBackground:"styles_videoBackground__bkTJ9",mobileNavContainer:"styles_mobileNavContainer__YonUs",mobileNavPaper:"styles_mobileNavPaper__844xZ",closeButton:"styles_closeButton__8ALbe",mobileNavBtn:"styles_mobileNavBtn__H0VF3",mainContainer:"styles_mainContainer__9W9VJ",section1:"styles_section1__XBUp_",orangeBg:"styles_orangeBg__CF1o4",grid:"styles_grid__HHZRw",bg:"styles_bg__w4_p4",circle:"styles_circle__FxxCX",emailSignUp:"styles_emailSignUp__AmIJ6",footer:"styles_footer__bt6kk",subtitle:"styles_subtitle__mydoh",theArrow:"styles_theArrow__eXemk",ctaModal:"styles_ctaModal__vpPTX",backdrop:"styles_backdrop__4OLqO",modalContainer:"styles_modalContainer__1II60",heroMobileDivider:"styles_heroMobileDivider__lHwre",heroAssetContainer:"styles_heroAssetContainer__87xKb",heroH1:"styles_heroH1__3uVrC",experienceCardRoot:"styles_experienceCardRoot__c9tKu",experienceCardMedia:"styles_experienceCardMedia__whlJU",experienceName:"styles_experienceName__fQzIQ",experienceHostName:"styles_experienceHostName__rsiNJ",experienceCardContent:"styles_experienceCardContent__zba_a",currentExhibitionContainer:"styles_currentExhibitionContainer__HGMZw",title:"styles_title___BULt",exhibitionCardGridItem:"styles_exhibitionCardGridItem__euC_T",exhibitionCardInner:"styles_exhibitionCardInner__FvdIf",exhibitionCardInfoContainer:"styles_exhibitionCardInfoContainer__xeeqm",welcomeText:"styles_welcomeText__HAsuH",longTextButton:"styles_longTextButton__X_Nz5",metaImageContainer:"styles_metaImageContainer__X4_DO"}},41485:function(e,n,t){"use strict";var r=t(87462),a=t(63366),i=t(45697),s=t.n(i),o=t(67294),c=t(94184),u=t.n(c),l={label:s().string.isRequired,onClick:s().func},d=o.forwardRef((function(e,n){var t=e.label,i=e.onClick,s=e.className,c=(0,a.Z)(e,["label","onClick","className"]);return o.createElement("button",(0,r.Z)({ref:n,type:"button",className:u()("close",s),onClick:i},c),o.createElement("span",{"aria-hidden":"true"},"\xd7"),o.createElement("span",{className:"sr-only"},t))}));d.displayName="CloseButton",d.propTypes=l,d.defaultProps={label:"Close"},n.Z=d},39602:function(e,n,t){"use strict";var r=t(87462),a=t(67294),i=t(94184),s=t.n(i);n.Z=function(e){return a.forwardRef((function(n,t){return a.createElement("div",(0,r.Z)({},n,{ref:t,className:s()(n.className,e)}))}))}}}]);
